<!DOCTYPE html>
<html>
<head>
    <title>Test plan (PZ-13756) by Roy Avrahami (Jira)</title>
    <meta http-equiv="Content-Type" Content="application/vnd.ms-word; charset=UTF-8">
        <style type="text/css">

.tableBorder, .grid
{
    background-color: #fff;
    width: 100%;
    border-collapse: collapse;
}

.tableBorder td, .grid td
{
    vertical-align: top;
    padding: 2px;
    border: 1px solid #ccc;
}

.noPadding
{
    padding: 0 !important;
}

h3 .subText
{
    font-size: 60%;
    font-weight: normal;
}

.tabLabel
{
    font-weight: bold;
    border: 1px solid #ccc;
    border-bottom:none;
    padding: 2px;
    display: inline;
}

td.blank
{
    padding: 0;
    margin: 0;
}

.blank td
{
    border: none;
}

#descriptionArea
{
    margin: 0;
    padding: 2px;
    border: 1px solid #ccc;
}

hr
{
    border-top:1px solid #aaa;
}

hr.fullcontent
{
  height: 15px;
  padding: 10px 0;
  background: #fff url('https://prismaphotonics.atlassian.net/images/icons/hr.gif') no-repeat scroll center;
}

</style>

</head>
<body>

<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13909]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13909">Integration - Historic Configuration Missing end_time Field</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43472-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43472-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <ol>
	<li>
	<ol>
		<li>Summary<br/>
Integration - Historic Configuration Missing end_time Field</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Objective<br/>
Validates that Focus Server properly *<b>rejects</b>* historic playback configurations that are missing the *<b>required</b>* `end_time` field. This is the pair test to NEW-010, ensuring both time boundaries are validated.</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Priority<br/>
*<b>High</b>*</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Components/Labels</li>
	</ol>
	</li>
</ol>
<ul>
	<li>*<b>Component</b>*: Focus Server Backend API</li>
	<li>*<b>Labels</b>*: `config-validation`, `historic-playback`, `required-fields`, `negative-test`</li>
	<li>*<b>Test Type</b>*: Integration Test (Negative)</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Requirements</li>
	</ol>
	</li>
</ol>
<ul>
	<li>*<b>Requirement ID</b>*: FOCUS-API-HISTORIC-VALIDATION-002</li>
	<li>*<b>Description</b>*: Historic configurations must include both start_time and end_time fields</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Pre-Conditions<br/>
1. Focus Server is running<br/>
2. Historic playback validation implemented<br/>
3. Required field validation logic exists</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Test Data</li>
	</ol>
	</li>
</ol>


<p>*<b>Invalid Configuration</b>* (missing end_time):<br/>
```json<br/>
{<br/>
  "displayTimeAxisDuration": 10,<br/>
  "nfftSelection": 1024,<br/>
  "displayInfo": </p>
{"height": 1000}
<p>,<br/>
  "channels": </p>
{"min": 0, "max": 50}
<p>,<br/>
  "frequencyRange": </p>
{"min": 0, "max": 500}
<p>,<br/>
  "start_time": "251021120000",<br/>
  "view_type": 0<br/>
}<br/>
```<br/>
*<b>Note</b><b>: Has `start_time` but **missing `end_time`</b>* - should be rejected</p>

<ol>
	<li>
	<ol>
		<li>Steps</li>
	</ol>
	</li>
</ol>


<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'><ol>
	<li></li>
</ol>
</td>
<td class='confluenceTd'> Step Description </td>
<td class='confluenceTd'> Expected Result </td>
</tr>
<tr>
<td class='confluenceTd'>&#8212;</td>
<td class='confluenceTd'>------------------</td>
<td class='confluenceTd'>-----------------</td>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Generate unique task_id </td>
<td class='confluenceTd'> Valid task_id </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Create historic configuration *<b>without</b>* `end_time` (Test Data) </td>
<td class='confluenceTd'> Payload created </td>
</tr>
<tr>
<td class='confluenceTd'> 3 </td>
<td class='confluenceTd'> Verify `start_time` is present but `end_time` is null/missing </td>
<td class='confluenceTd'> end_time missing ✅ </td>
</tr>
<tr>
<td class='confluenceTd'> 4 </td>
<td class='confluenceTd'> Attempt to send `POST <a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a>` </td>
<td class='confluenceTd'> Request sent or validation fails </td>
</tr>
<tr>
<td class='confluenceTd'> 5 </td>
<td class='confluenceTd'> *<b>Expected</b>*: Receive HTTP 400 Bad Request </td>
<td class='confluenceTd'> Status 400 </td>
</tr>
<tr>
<td class='confluenceTd'> 6 </td>
<td class='confluenceTd'> Verify error message contains "end_time" </td>
<td class='confluenceTd'> Error mentions missing field </td>
</tr>
<tr>
<td class='confluenceTd'> 7 </td>
<td class='confluenceTd'> Verify error message is descriptive: `"Historic playback requires end_time field"` </td>
<td class='confluenceTd'> Clear error message </td>
</tr>
<tr>
<td class='confluenceTd'> 8 </td>
<td class='confluenceTd'> Verify no task created in MongoDB: `db.tasks.find(
{task_id: task_id}
<p>)` </p></td>
<td class='confluenceTd'> No task found </td>
</tr>
<tr>
<td class='confluenceTd'> 9 </td>
<td class='confluenceTd'> Verify server logs validation error </td>
<td class='confluenceTd'> Error logged </td>
</tr>
<tr>
<td class='confluenceTd'> 10 </td>
<td class='confluenceTd'> Verify server remains stable </td>
<td class='confluenceTd'> No crashes </td>
</tr>
</tbody></table>
</div>


<ol>
	<li>
	<ol>
		<li>Expected Result</li>
	</ol>
	</li>
</ol>
<ul>
	<li>Configuration *<b>rejected</b>* with *<b>HTTP 400 Bad Request</b>*</li>
	<li>Error message clearly indicates:</li>
</ul>
<ul class="alternate" type="square">
	<li>Missing field: `end_time`</li>
	<li>Required for: historic playback</li>
	<li>Example: `"end_time is required for historic playback mode"`</li>
</ul>
<ul>
	<li>*<b>No task created</b>* in the system</li>
	<li>Server stable and responsive</li>
	<li>Validation happens *<b>before</b>* any processing</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Post-Conditions</li>
	</ol>
	</li>
</ol>
<ul>
	<li>No task created</li>
	<li>MongoDB state unchanged</li>
	<li>Server stable</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Environment<br/>
*<b>Same as TEST 1</b>* (new_production environment)</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Automation Status</li>
	</ol>
	</li>
</ol>


<p>⚠️ *<b>To Be Automated</b>*</p>

<p>*<b>Framework</b>*: pytest 7.0+  <br/>
*<b>Test Function</b>*: `test_config_with_missing_end_time` (TO CREATE)  <br/>
*<b>Test File</b>*: `tests/integration/api/test_historic_playback_flow.py` (add to existing file)  <br/>
*<b>Test Class</b>*: `TestHistoricPlaybackValidation` (new class)  </p>

<p>*<b>Proposed Run Command</b>*:<br/>
```bash<br/>
pytest tests/integration/api/test_historic_playback_flow.py::TestHistoricPlaybackValidation::test_config_with_missing_end_time -v<br/>
```</p>

<p>*<b>Status</b>*: ❌ Not yet implemented - needs to be created</p>

<p>*<b>Expected Test Duration</b>*: ~1 second</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13907]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13907">Integration - Historic Configuration Missing start_time Field</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43470-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43470-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <ol>
	<li>
	<ol>
		<li>Summary<br/>
Integration - Historic Configuration Missing start_time Field</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Objective<br/>
Validates that Focus Server properly *<b>rejects</b>* historic playback configurations that are missing the *<b>required</b>* `start_time` field. Historic mode requires both `start_time` and `end_time` to define the playback time range. Missing `start_time` should result in clear validation error.</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Priority<br/>
*<b>High</b>*</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Components/Labels</li>
	</ol>
	</li>
</ol>
<ul>
	<li>*<b>Component</b>*: Focus Server Backend API</li>
	<li>*<b>Labels</b>*: `config-validation`, `historic-playback`, `required-fields`, `negative-test`</li>
	<li>*<b>Test Type</b>*: Integration Test (Negative)</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Requirements</li>
	</ol>
	</li>
</ol>
<ul>
	<li>*<b>Requirement ID</b>*: FOCUS-API-HISTORIC-VALIDATION-001</li>
	<li>*<b>Description</b>*: Historic configurations must include both start_time and end_time fields</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Pre-Conditions<br/>
1. Focus Server is running<br/>
2. Historic playback validation implemented<br/>
3. Required field validation logic exists</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Test Data</li>
	</ol>
	</li>
</ol>


<p>*<b>Invalid Configuration</b>* (missing start_time):<br/>
```json<br/>
{<br/>
  "displayTimeAxisDuration": 10,<br/>
  "nfftSelection": 1024,<br/>
  "displayInfo": </p>
{"height": 1000}
<p>,<br/>
  "channels": </p>
{"min": 0, "max": 50}
<p>,<br/>
  "frequencyRange": </p>
{"min": 0, "max": 500}
<p>,<br/>
  "end_time": "251021120000",<br/>
  "view_type": 0<br/>
}<br/>
```<br/>
*<b>Note</b><b>: Has `end_time` but **missing `start_time`</b>* - should be rejected</p>

<ol>
	<li>
	<ol>
		<li>Steps</li>
	</ol>
	</li>
</ol>


<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'><ol>
	<li></li>
</ol>
</td>
<td class='confluenceTd'> Step Description </td>
<td class='confluenceTd'> Expected Result </td>
</tr>
<tr>
<td class='confluenceTd'>&#8212;</td>
<td class='confluenceTd'>------------------</td>
<td class='confluenceTd'>-----------------</td>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Generate unique task_id </td>
<td class='confluenceTd'> Valid task_id </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Create historic configuration *<b>without</b>* `start_time` (Test Data) </td>
<td class='confluenceTd'> Payload created </td>
</tr>
<tr>
<td class='confluenceTd'> 3 </td>
<td class='confluenceTd'> Verify `end_time` is present but `start_time` is null/missing </td>
<td class='confluenceTd'> start_time missing ✅ </td>
</tr>
<tr>
<td class='confluenceTd'> 4 </td>
<td class='confluenceTd'> Attempt to send `POST <a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a>` </td>
<td class='confluenceTd'> Request sent or validation fails </td>
</tr>
<tr>
<td class='confluenceTd'> 5 </td>
<td class='confluenceTd'> *<b>Expected</b>*: Receive HTTP 400 Bad Request </td>
<td class='confluenceTd'> Status 400 </td>
</tr>
<tr>
<td class='confluenceTd'> 6 </td>
<td class='confluenceTd'> Verify error message contains "start_time" </td>
<td class='confluenceTd'> Error mentions missing field </td>
</tr>
<tr>
<td class='confluenceTd'> 7 </td>
<td class='confluenceTd'> Verify error message is descriptive: `"Historic playback requires start_time field"` </td>
<td class='confluenceTd'> Clear error message </td>
</tr>
<tr>
<td class='confluenceTd'> 8 </td>
<td class='confluenceTd'> Verify no task created in MongoDB: `db.tasks.find(
{task_id: task_id}
<p>)` </p></td>
<td class='confluenceTd'> No task found </td>
</tr>
<tr>
<td class='confluenceTd'> 9 </td>
<td class='confluenceTd'> Verify server logs validation error </td>
<td class='confluenceTd'> Error logged </td>
</tr>
<tr>
<td class='confluenceTd'> 10 </td>
<td class='confluenceTd'> Verify server remains stable </td>
<td class='confluenceTd'> No crashes </td>
</tr>
</tbody></table>
</div>


<ol>
	<li>
	<ol>
		<li>Expected Result</li>
	</ol>
	</li>
</ol>
<ul>
	<li>Configuration *<b>rejected</b>* with *<b>HTTP 400 Bad Request</b>*</li>
	<li>Error message clearly indicates:</li>
</ul>
<ul class="alternate" type="square">
	<li>Missing field: `start_time`</li>
	<li>Required for: historic playback</li>
	<li>Example: `"start_time is required for historic playback mode"`</li>
</ul>
<ul>
	<li>*<b>No task created</b>* in the system</li>
	<li>Server stable and responsive</li>
	<li>Validation happens *<b>before</b>* any processing</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Post-Conditions</li>
	</ol>
	</li>
</ol>
<ul>
	<li>No task created</li>
	<li>MongoDB state unchanged</li>
	<li>Server stable</li>
</ul>


<ol>
	<li>
	<ol>
		<li>Environment<br/>
*<b>Same as TEST 1</b>* (new_production environment)</li>
	</ol>
	</li>
</ol>


<ol>
	<li>
	<ol>
		<li>Automation Status</li>
	</ol>
	</li>
</ol>


<p>⚠️ *<b>To Be Automated</b>*</p>

<p>*<b>Framework</b>*: pytest 7.0+  <br/>
*<b>Test Function</b>*: `test_config_with_missing_start_time` (TO CREATE)  <br/>
*<b>Test File</b>*: `tests/integration/api/test_historic_playback_flow.py` (add to existing file)  <br/>
*<b>Test Class</b>*: `TestHistoricPlaybackValidation` (new class)  </p>

<p>*<b>Proposed Run Command</b>*:<br/>
```bash<br/>
pytest tests/integration/api/test_historic_playback_flow.py::TestHistoricPlaybackValidation::test_config_with_missing_start_time -v<br/>
```</p>

<p>*<b>Status</b>*: ❌ Not yet implemented - needs to be created</p>

<p>*<b>Expected Test Duration</b>*: ~1 second</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13906]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13906">Integration - Low Throughput Configuration Edge Case</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43469-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43469-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration - Low Throughput Configuration Edge Case</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Tests configuration with <b>very low data throughput</b> (&lt; 1 Mbps) to verify system behavior at the lower performance boundary. Low throughput occurs with: few sensors, large NFFT (fewer rows/sec), narrow frequency range. Validates that low-throughput configs are handled correctly.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>Medium-High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>performance</tt>, <tt>edge-case</tt>, <tt>low-throughput</tt>, <tt>minimal-config</tt></li>
	<li><b>Test Type</b>: Integration Test (Edge Case)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-LOW-THROUGHPUT-001</li>
	<li><b>Description</b>: System should accept low-throughput configurations (unless below minimum viable)</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>System supports low-throughput scenarios</li>
	<li>Minimum viable configuration defined (or to be determined)</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Low Throughput Configuration</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 4096,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 500},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 5,
    <span class="code-quote">"max"</span>: 10
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 100,
    <span class="code-quote">"max"</span>: 200
  },
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Why Low Throughput?</b></p>

<ul>
	<li>Large NFFT (4096) → few rows/sec</li>
	<li>Few sensors (5)</li>
	<li>Narrow frequency range (100 Hz)</li>
</ul>


<p><b>Expected Calculation</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>PRR = 1000 samples/sec
Rows/sec = 1000 / 4096 ≈ 0.24 rows/sec (very slow!)
Bytes/row = 5 sensors × 2048 bins × 4 bytes = 40,960 bytes
Data rate = 0.24 × 40,960 × 8 / 1,000,000 ≈ 0.08 Mbps (very low)</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Get PRR from live_metadata</td>
<td class='confluenceTd'>PRR retrieved</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create low-throughput config (Test Data)</td>
<td class='confluenceTd'>Config created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Calculate expected throughput</td>
<td class='confluenceTd'>Expected: &lt; 1 Mbps</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify rows/sec &lt; 1</td>
<td class='confluenceTd'>Very slow update rate</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Generate task_id</td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>Response received</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify response: <b>likely accepted</b></td>
<td class='confluenceTd'>HTTP 200 OK (low throughput is OK)</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Check for warnings: "Low spectrogram rate: 0.24 rows/sec"</td>
<td class='confluenceTd'>Warning issued (optional)</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify task can be created</td>
<td class='confluenceTd'>Task created successfully</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Document if minimum viable throughput exists</td>
<td class='confluenceTd'>Behavior logged for specs</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<p><b>Expected Behavior</b>:</p>

<ul>
	<li>HTTP 200 OK - <b>configuration accepted</b></li>
	<li>Optional warning: "Low update rate: 0.24 rows/sec"</li>
	<li>Task created successfully</li>
	<li>System operates (albeit slowly)</li>
</ul>


<p><b>Questions for Specs Meeting</b>:</p>

<ul>
	<li>Is there a <b>minimum</b> rows/sec? (e.g., must be &gt; 0.1)</li>
	<li>Is there a <b>minimum</b> data rate? (e.g., must be &gt; 0.01 Mbps)</li>
	<li>Should system <b>warn</b> or <b>reject</b> very low configs?</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Task created (if accepted)</li>
	<li>System stable</li>
	<li>Low resource usage</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as TEST 1</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_low_throughput_configuration</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_spectrogram_pipeline.py</tt>  <br/>
<b>Test Class</b>: <tt>TestSpectrogramPipeline</tt>  <br/>
<b>Lines</b>: 304-343</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_spectrogram_pipeline.py::test_low_throughput_configuration -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-3 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13905]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13905">Performance - High Throughput Configuration Stress Test</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43468-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            performance_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43468-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Performance - High Throughput Configuration Stress Test</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Tests configuration with <b>very high data throughput</b> (&gt; 50 Mbps) to verify system behavior under heavy load. High throughput occurs with: many sensors, small NFFT (more rows/sec), wide frequency range. This test identifies system limits and validates warnings/rejections for excessive configurations.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>performance</tt>, <tt>stress-test</tt>, <tt>high-throughput</tt>, <tt>capacity</tt>, <tt>limits</tt></li>
	<li><b>Test Type</b>: Performance Test (Stress)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HIGH-THROUGHPUT-001</li>
	<li><b>Description</b>: System must handle or reject high-throughput configurations gracefully</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running with adequate resources</li>
	<li>System under normal load (not already stressed)</li>
	<li>Network can handle high bandwidth</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>High Throughput Configuration</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 512,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 2000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 200
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 2000
  },
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Why High Throughput?</b></p>

<ul>
	<li>Small NFFT (512) → many rows/sec</li>
	<li>Many sensors (200)</li>
	<li>Wide frequency range (2000 Hz)</li>
</ul>


<p><b>Expected Calculation</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>PRR = 1000 samples/sec
Rows/sec = 1000 / 512 ≈ 1.95 rows/sec
Bytes/row = 200 sensors × 256 bins × 4 bytes = 204,800 bytes
Data rate = 1.95 × 204,800 × 8 / 1,000,000 ≈ 3.2 Mbps (actually not that high)

To get &gt; 50 Mbps, need:
NFFT = 256, sensors = 500, freq_range = 4000</pre>
</div></div>

<p><b>Adjusted High Throughput Config</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 256,
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 4000}
}</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Get PRR from live_metadata</td>
<td class='confluenceTd'>PRR retrieved (e.g., 1000)</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Design config to produce &gt; 50 Mbps throughput</td>
<td class='confluenceTd'>Config created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Calculate expected throughput using estimation formula</td>
<td class='confluenceTd'>Expected: &gt; 50 Mbps</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Generate task_id</td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>Response received</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Check response: <b>Option A</b>: Accepted with warning</td>
<td class='confluenceTd'>Status 200 + warning in response or logs</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Check response: <b>Option B</b>: Rejected as too expensive</td>
<td class='confluenceTd'>Status 400 + error: "Configuration exceeds throughput limit"</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>If accepted, monitor actual throughput (optional)</td>
<td class='confluenceTd'>Actual throughput measured</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify system stability</td>
<td class='confluenceTd'>No crashes or resource exhaustion</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Document behavior for specs meeting</td>
<td class='confluenceTd'>Behavior logged</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<p><b>Behavior Options</b> (to be defined in specs meeting):</p>

<p><b>Option A: Accept with Warning</b></p>

<ul>
	<li>HTTP 200 OK</li>
	<li>Warning logged: "High throughput configuration: 75 Mbps"</li>
	<li>Task created</li>
	<li>System monitors resources</li>
</ul>


<p><b>Option B: Reject</b></p>

<ul>
	<li>HTTP 400 Bad Request</li>
	<li>Error: "Configuration throughput (75 Mbps) exceeds system limit (50 Mbps)"</li>
	<li>No task created</li>
	<li>Suggestion provided: "Reduce sensor range or increase NFFT"</li>
</ul>


<p><b>Either way</b>:</p>

<ul>
	<li>System remains stable</li>
	<li>No crashes or hangs</li>
	<li>Clear feedback to client</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>If accepted: task may consume high resources</li>
	<li>If rejected: no task created</li>
	<li>System stable</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as TEST 1</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_high_throughput_configuration</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_spectrogram_pipeline.py</tt>  <br/>
<b>Test Class</b>: <tt>TestSpectrogramPipeline</tt>  <br/>
<b>Lines</b>: 270-302</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_spectrogram_pipeline.py::test_high_throughput_configuration -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-5 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13904]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13904">Integration - Configuration Resource Usage Estimation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43467-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43467-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration - Configuration Resource Usage Estimation</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Calculates and validates estimated resource usage (CPU, Memory, Network Bandwidth) for a given configuration before task creation. This allows capacity planning and prevents configurations that would exhaust system resources. The test verifies that the system can predict resource requirements accurately.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>performance</tt>, <tt>resource-planning</tt>, <tt>capacity</tt>, <tt>estimation</tt>, <tt>validation</tt></li>
	<li><b>Test Type</b>: Integration Test (Performance)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-RESOURCE-ESTIMATION-001</li>
	<li><b>Description</b>: System should estimate resource usage and warn about expensive configurations</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server has resource estimation logic</li>
	<li>System knows performance characteristics (CPU per NFFT, etc.)</li>
	<li>Validation utilities available</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Test Configuration</b> (Medium Load):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000}
}</pre>
</div></div>

<p><b>Expected Calculations</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>PRR = 1000 samples/sec (from metadata)
NFFT = 1024
Sensor Range = 50
Frequency Bins = NFFT/2 = 512

Spectrogram rows/sec = PRR / NFFT = 1000 / 1024 ≈ 0.98 rows/sec
Bytes per row = sensors × freq_bins × 4 bytes = 50 × 512 × 4 = 102,400 bytes
Output data rate = rows/sec × bytes/row × 8 = 0.98 × 102,400 × 8 ≈ 0.8 Mbps</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Get live metadata to extract PRR</td>
<td class='confluenceTd'>PRR value retrieved</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Define test configuration (Test Data)</td>
<td class='confluenceTd'>Config defined</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Calculate NFFT value from config</td>
<td class='confluenceTd'>NFFT = 1024</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Calculate sensor range: <tt>max - min</tt></td>
<td class='confluenceTd'>Range = 50</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Calculate spectrogram rows/sec: <tt>PRR / NFFT</tt></td>
<td class='confluenceTd'>~0.98 rows/sec</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Calculate frequency bins: <tt>NFFT / 2</tt></td>
<td class='confluenceTd'>512 bins</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Calculate bytes per row: <tt>sensors × bins × 4</tt></td>
<td class='confluenceTd'>102,400 bytes/row</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Calculate output data rate (Mbps): <tt>rows/sec × bytes/row × 8 / 1,000,000</tt></td>
<td class='confluenceTd'>~0.8 Mbps</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify estimates are reasonable: <tt>0.1 &lt; rate &lt; 100 Mbps</tt></td>
<td class='confluenceTd'>Within reasonable bounds</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Check for warnings: rate &gt; 50 Mbps?</td>
<td class='confluenceTd'>No warning (rate is low)</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify compatibility: <tt>validate_configuration_compatibility()</tt></td>
<td class='confluenceTd'>Returns <tt>is_compatible: True</tt></td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Log estimates for documentation</td>
<td class='confluenceTd'>Estimates logged</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>Estimates calculated</b> successfully:
	<ul>
		<li>Spectrogram rows/sec</li>
		<li>Bytes per row</li>
		<li>Output data rate (Mbps)</li>
	</ul>
	</li>
	<li><b>Estimates are reasonable</b>:
	<ul>
		<li>Rows/sec: 0.1 - 1000</li>
		<li>Data rate: 0.1 - 100 Mbps</li>
	</ul>
	</li>
	<li><b>Warnings issued</b> for extreme configs:
	<ul>
		<li>Warning if rate &gt; 50 Mbps</li>
		<li>Warning if rows/sec &gt; 1000</li>
		<li>Warning if rows/sec &lt; 1</li>
	</ul>
	</li>
	<li><b>Compatibility validated</b></li>
	<li>No calculation errors or exceptions</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No tasks created (estimation only)</li>
	<li>Calculations documented for capacity planning</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as TEST 1</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_configuration_resource_estimation</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_spectrogram_pipeline.py</tt>  <br/>
<b>Test Class</b>: <tt>TestSpectrogramPipeline</tt>  <br/>
<b>Lines</b>: 246-268</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_spectrogram_pipeline.py::test_configuration_resource_estimation -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~1-2 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13903]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13903">Integration - Frequency Range Nyquist Limit Enforcement</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43466-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43466-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration - Frequency Range Nyquist Limit Enforcement</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server <b>enforces the Nyquist-Shannon sampling theorem</b> and rejects frequency ranges that exceed the Nyquist frequency (PRR/2). This is the <b>most critical data quality test</b> because violating Nyquist causes <b>aliasing</b> - false frequencies appear in the data, leading to completely incorrect measurements and potentially dangerous decisions.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>CRITICAL</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>data-quality</tt>, <tt>nyquist</tt>, <tt>aliasing-prevention</tt>, <tt>physics</tt>, <tt>critical</tt>, <tt>validation</tt></li>
	<li><b>Test Type</b>: Integration Test (Data Quality - Critical)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-NYQUIST-ENFORCEMENT-001</li>
	<li><b>Description</b>: Server MUST enforce Nyquist limit: max_frequency ≤ PRR/2 to prevent aliasing</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>Live metadata available with accurate PRR value</li>
	<li>System understands Nyquist limit calculation</li>
	<li>Validation logic implemented</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Step 1: Get PRR from live_metadata</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>GET https://10.10.100.100/focus-server/live_metadata
→ Extract PRR value (e.g., PRR = 1000 samples/sec)
→ Calculate Nyquist = PRR / 2 (e.g., 500 Hz)</pre>
</div></div>

<p><b>Test Data 1: Valid (Below Nyquist)</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 400
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: If PRR=1000, Nyquist=500, max=400 &lt; 500  <b>VALID</b></p>

<p><b>Test Data 2: Invalid (Above Nyquist)</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 600
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: If PRR=1000, Nyquist=500, max=600 &gt; 500 ❌ <b>INVALID</b> (aliasing!)</p>

<p><b>Test Data 3: Exactly at Nyquist (Edge Case)</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 500
  }
}</pre>
</div></div>

<p><b>Note</b>: max=500 == Nyquist - edge case (may be valid or invalid)</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send <tt>GET &lt;<a href="https://10.10.100.100/focus-server/live_metadata" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/live_metadata</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 200 with metadata</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Extract PRR value from metadata</td>
<td class='confluenceTd'>PRR value (e.g., 1000 samples/sec)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Calculate Nyquist frequency: <tt>Nyquist = PRR / 2</tt></td>
<td class='confluenceTd'>Nyquist value (e.g., 500 Hz)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Log Nyquist limit</td>
<td class='confluenceTd'><tt>"Nyquist limit: 500 Hz for PRR=1000"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Generate task_id for Test 1</td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Create config with <tt>freq_max = Nyquist * 0.8</tt> (80% of Nyquist)</td>
<td class='confluenceTd'>Config created with safe frequency</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B+with+Test+Data+1%7C%3Cb%3EHTTP+200+OK%3C%2Fb%3E+-+accepted%7C%3Cbr%2F%3E%0A%7C8%7CVerify+no+validation+warnings%7CConfig+accepted+without+issues%7C%3Cbr%2F%3E%0A%7C9%7CGenerate+task_id+for+Test+2%7CValid+task_id%7C%3Cbr%2F%3E%0A%7C10%7CCreate+config+with+%3Ctt%3Efreq_max+%3D+Nyquist+*+1.2%3C%2Ftt%3E+%28120%25+of+Nyquist%29%7CConfig+created+with+excessive+frequency%7C%3Cbr%2F%3E%0A%7C11%7CSend+%7B%7BPOST+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt; with Test Data 1|<b>HTTP 200 OK</b> - accepted|<br/>
|8|Verify no validation warnings|Config accepted without issues|<br/>
|9|Generate task_id for Test 2|Valid task_id|<br/>
|10|Create config with <tt>freq_max = Nyquist * 1.2</tt> (120% of Nyquist)|Config created with excessive frequency|<br/>
|11|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}</a></tt>&gt; with Test Data 2</td>
<td class='confluenceTd'><b>HTTP 400 Bad Request</b> - rejected ❌</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Verify error message: <tt>"max_freq (600 Hz) exceeds Nyquist frequency (500 Hz)"</tt></td>
<td class='confluenceTd'>Clear error explaining Nyquist violation</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Test edge case: <tt>freq_max = Nyquist</tt> exactly</td>
<td class='confluenceTd'>Document behavior (accept or reject)</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Verify system remains stable after rejection</td>
<td class='confluenceTd'>No crashes or side effects</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>PRR extracted</b> successfully from live_metadata</li>
	<li><b>Nyquist calculated</b> correctly: <tt>Nyquist = PRR / 2</tt></li>
	<li><b>Frequency below Nyquist</b> (80%) is <b>ACCEPTED</b></li>
	<li><b>Frequency above Nyquist</b> (120%) is <b>REJECTED</b></li>
	<li>Error message clearly states:
	<ul>
		<li>Requested frequency</li>
		<li>Nyquist limit</li>
		<li>Current PRR</li>
	</ul>
	</li>
	<li>Edge case (freq == Nyquist) behavior <b>documented</b></li>
	<li><b>No aliasing possible</b> - data integrity protected</li>
</ul>


<p><b>Critical</b>: This is a <b>physics-based validation</b> - not just software correctness!</p>

<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No tasks created for invalid configs</li>
	<li>Valid task may exist for below-Nyquist config</li>
	<li>System stable</li>
	<li><b>Data quality protected</b> from aliasing</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as TEST 1</b> (new_production environment)</p>

<p><b>Critical Note</b>:</p>

<ul>
	<li>PRR value is <b>system-dependent</b> (varies by fiber config)</li>
	<li>Test must <b>dynamically calculate</b> Nyquist from live_metadata</li>
	<li>Cannot use hardcoded values</li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_frequency_range_within_nyquist</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_spectrogram_pipeline.py</tt>  <br/>
<b>Test Class</b>: <tt>TestFrequencyConfiguration</tt>  <br/>
<b>Lines</b>: 127-157</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run Nyquist validation test
</span>pytest tests/integration/api/test_spectrogram_pipeline.py::TestFrequencyConfiguration::test_frequency_range_within_nyquist -v</pre>
</div></div>

<p><b>Dependencies</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Requires live_metadata fixture</span></pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-3 seconds</p>



<p>This is the <b>MOST CRITICAL</b> test for data quality. Failure to enforce Nyquist limit results in <b>CORRUPTED DATA</b>.</p>

<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13901]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13901">Integration - NFFT Values Validation - All Supported Values</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43464-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43464-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration - NFFT Values Validation - All Supported Values</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server accepts and processes all valid NFFT values (128, 256, 512, 1024, 2048, 4096). NFFT (FFT size) determines frequency resolution in spectral analysis. Different NFFT values provide different trade-offs between frequency resolution and time resolution. This test ensures complete NFFT support.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>nfft</tt>, <tt>spectrogram</tt>, <tt>fft</tt>, <tt>functional-coverage</tt></li>
	<li><b>Test Type</b>: Integration Test (Functional)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-NFFT-SUPPORT-001</li>
	<li><b>Description</b>: Server must support all standard NFFT values (powers of 2 from 128 to 4096)</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>System has adequate resources for all NFFT values</li>
	<li>Baby Analyzer supports configurable NFFT</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>NFFT Values to Test</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>[128, 256, 512, 1024, 2048, 4096]</pre>
</div></div>

<p><b>Configuration Template</b> (for each NFFT):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: &lt;NFFT_VALUE&gt;,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Trade-offs by NFFT</b>:</p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>NFFT</th>
<th class='confluenceTh'>Frequency Resolution</th>
<th class='confluenceTh'>Update Rate</th>
<th class='confluenceTh'>CPU Load</th>
</tr>
<tr>
<td class='confluenceTd'>128</td>
<td class='confluenceTd'>Low</td>
<td class='confluenceTd'>Very High</td>
<td class='confluenceTd'>Low</td>
</tr>
<tr>
<td class='confluenceTd'>256</td>
<td class='confluenceTd'>Low</td>
<td class='confluenceTd'>High</td>
<td class='confluenceTd'>Low-Medium</td>
</tr>
<tr>
<td class='confluenceTd'>512</td>
<td class='confluenceTd'>Medium</td>
<td class='confluenceTd'>Medium</td>
<td class='confluenceTd'>Medium</td>
</tr>
<tr>
<td class='confluenceTd'>1024</td>
<td class='confluenceTd'>Good</td>
<td class='confluenceTd'>Medium</td>
<td class='confluenceTd'>Medium-High</td>
</tr>
<tr>
<td class='confluenceTd'>2048</td>
<td class='confluenceTd'>High</td>
<td class='confluenceTd'>Low</td>
<td class='confluenceTd'>High</td>
</tr>
<tr>
<td class='confluenceTd'>4096</td>
<td class='confluenceTd'>Very High</td>
<td class='confluenceTd'>Very Low</td>
<td class='confluenceTd'>Very High</td>
</tr>
</tbody></table>
</div>


<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>For NFFT in <span class="error">&#91;128, 256, 512, 1024, 2048, 4096&#93;</span>:</td>
<td class='confluenceTd'>Loop through all values</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Generate unique <tt>task_id</tt> for this NFFT value</td>
<td class='confluenceTd'>task_id created (e.g., <tt>nfft_test_1024_&lt;timestamp&gt;</tt>)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create configuration with <tt>nfftSelection = NFFT</tt></td>
<td class='confluenceTd'>Config payload created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Validate NFFT is power of 2: <tt>NFFT &amp; (NFFT-1) == 0</tt></td>
<td class='confluenceTd'>Validation passes</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 200 OK</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify response: <tt>"Config received successfully"</tt></td>
<td class='confluenceTd'>Success status</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Optional: Query metadata to verify NFFT was applied</td>
<td class='confluenceTd'>metadata.nfft == NFFT</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Optional: Measure configuration time</td>
<td class='confluenceTd'>Time &lt; 5 seconds</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Log success for this NFFT value</td>
<td class='confluenceTd'>Success logged</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Repeat for next NFFT value</td>
<td class='confluenceTd'>Continue loop</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify all 6 NFFT values accepted</td>
<td class='confluenceTd'>100% success rate</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>All NFFT values accepted</b>: 128, 256, 512, 1024, 2048, 4096</li>
	<li>Each configuration returns <b>HTTP 200 OK</b></li>
	<li>No errors or rejections</li>
	<li>Server handles all values without crashes</li>
	<li>Configuration time &lt; 5 seconds for each</li>
	<li>System remains stable throughout test</li>
</ul>


<p><b>NFFT Coverage</b>:</p>

<ul>
	<li>✅ NFFT=128 (lowest, fastest)</li>
	<li>✅ NFFT=256</li>
	<li>✅ NFFT=512</li>
	<li>✅ NFFT=1024 (most common)</li>
	<li>✅ NFFT=2048</li>
	<li>✅ NFFT=4096 (highest, best resolution)</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>All test tasks can be cleaned up</li>
	<li>System resources released</li>
	<li>No performance degradation</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as TEST 1</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_nfft_variations</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_spectrogram_pipeline.py</tt>  <br/>
<b>Test Class</b>: <tt>TestNFFTConfiguration</tt>  <br/>
<b>Lines</b>: 80-97</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run NFFT variations test
</span>pytest tests/integration/api/test_spectrogram_pipeline.py::TestNFFTConfiguration::test_nfft_variations -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~5-10 seconds (6 configs)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13900]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13900">Infrastructure - SSH Access to Production Servers</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43463-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43463-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Infrastructure - SSH Access to Production Servers</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates SSH connectivity to production servers through jump host for troubleshooting and maintenance operations. SSH access is critical for accessing logs, executing commands, running k9s, and performing manual interventions when needed.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: SSH Infrastructure</li>
	<li><b>Labels</b>: <tt>infrastructure</tt>, <tt>ssh</tt>, <tt>connectivity</tt>, <tt>access</tt>, <tt>troubleshooting</tt></li>
	<li><b>Test Type</b>: Infrastructure Test</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: INFRA-SSH-ACCESS-001</li>
	<li><b>Description</b>: SSH access must be available for operational support and troubleshooting</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Jump host is running at <tt>10.10.100.3</tt></li>
	<li>Target host is running at <tt>10.10.100.113</tt></li>
	<li>SSH keys or credentials available</li>
	<li>Network routing allows SSH connections</li>
	<li>Firewall rules permit SSH traffic</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>SSH Connections</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Jump Host: root@10.10.100.3 (port 22)
Target Host: prisma@10.10.100.113 (port 22)</pre>
</div></div>

<p><b>Test Commands</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># On jump host
</span>hostname
whoami
uptime

<span class="code-comment"># On target host  
</span>hostname
whoami
kubectl version --client
k9s version</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Import paramiko library: <tt>import paramiko</tt></td>
<td class='confluenceTd'>Library imported</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create SSH client: <tt>ssh = paramiko.SSHClient()</tt></td>
<td class='confluenceTd'>Client created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Set missing host key policy: <tt>ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</tt></td>
<td class='confluenceTd'>Policy set</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Connect to jump host: <tt>ssh.connect('10.10.100.3', username='root', password='***')</tt></td>
<td class='confluenceTd'>Connection established</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Execute test command: <tt>stdin, stdout, stderr = ssh.exec_command('hostname')</tt></td>
<td class='confluenceTd'>Command executed</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Read output: <tt>hostname = stdout.read().decode().strip()</tt></td>
<td class='confluenceTd'>Hostname returned</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify no errors in stderr</td>
<td class='confluenceTd'>stderr is empty or minimal</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Execute <tt>whoami</tt> command</td>
<td class='confluenceTd'>Returns <tt>root</tt></td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Execute <tt>uptime</tt> command</td>
<td class='confluenceTd'>Returns system uptime</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Close jump host connection</td>
<td class='confluenceTd'>Connection closed</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Connect to target host: <tt>ssh.connect('10.10.100.113', username='prisma', password='***')</tt></td>
<td class='confluenceTd'>Connection established</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Execute <tt>kubectl version --client</tt></td>
<td class='confluenceTd'>kubectl is installed and working</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Execute <tt>k9s version</tt></td>
<td class='confluenceTd'>k9s is installed</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Optional: Execute <tt>kubectl get pods -n panda</tt></td>
<td class='confluenceTd'>Pods listed</td>
</tr>
<tr>
<td class='confluenceTd'>15</td>
<td class='confluenceTd'>Close target host connection</td>
<td class='confluenceTd'>Connection closed</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>Jump host</b> (<tt>10.10.100.3</tt>) <b>accessible</b> via SSH</li>
	<li><b>Target host</b> (<tt>10.10.100.113</tt>) <b>accessible</b> via SSH</li>
	<li>Commands execute successfully on both hosts</li>
	<li><tt>kubectl</tt> available on target host</li>
	<li><tt>k9s</tt> available on target host</li>
	<li>No authentication failures</li>
	<li>No network timeouts</li>
	<li>Connection latency &lt; 2 seconds</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>All SSH connections closed</li>
	<li>No hanging connections</li>
	<li>Hosts remain accessible</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>SSH Hosts</b>:</p>

<ul>
	<li>Jump Host: <tt>10.10.100.3</tt> (user: <tt>root</tt>)</li>
	<li>Target Host: <tt>10.10.100.113</tt> (user: <tt>prisma</tt>)</li>
</ul>


<p><b>Available Tools on Target Host</b>:</p>

<ul>
	<li><tt>kubectl</tt> - Kubernetes CLI</li>
	<li><tt>k9s</tt> - Kubernetes TUI</li>
	<li><tt>docker</tt> - Container management</li>
</ul>


<p><b>Connection Path</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Test Client → Jump Host (10.10.100.3) → Target Host (10.10.100.113)</pre>
</div></div>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_ssh_connection</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/infrastructure/test_external_connectivity.py</tt>  <br/>
<b>Test Class</b>: <tt>TestExternalServicesConnectivity</tt>  <br/>
<b>Lines</b>: 304-364</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run SSH connectivity test
</span>pytest tests/integration/infrastructure/test_external_connectivity.py::TestExternalServicesConnectivity::test_ssh_connection -v

<span class="code-comment"># Run with markers
</span>pytest -m <span class="code-quote-red">"ssh and infrastructure"</span> -v</pre>
</div></div>

<p><b>Dependencies</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">paramiko&gt;=3.0.0</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~3-5 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13899]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13899">Infrastructure - Kubernetes Cluster Connection and Pod Health Check</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43462-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43462-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Infrastructure - Kubernetes Cluster Connection and Pod Health Check</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates connection to Kubernetes cluster API server and verifies that Focus Server pods are running and healthy. This infrastructure test ensures orchestration layer is functional and allows monitoring pod status, resource usage, and logs. Critical for operational visibility.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Kubernetes Infrastructure</li>
	<li><b>Labels</b>: <tt>infrastructure</tt>, <tt>kubernetes</tt>, <tt>orchestration</tt>, <tt>pod-health</tt>, <tt>diagnostic</tt></li>
	<li><b>Test Type</b>: Infrastructure Test</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: INFRA-KUBERNETES-CONNECTIVITY-001</li>
	<li><b>Description</b>: Kubernetes cluster must be accessible and Focus Server pods must be discoverable</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Kubernetes cluster is running</li>
	<li>API Server accessible at <tt>&lt;<a href="https://10.10.100.102:6443" class="external-link" rel="nofollow noreferrer">https://10.10.100.102:6443</a></tt>&gt;</li>
	<li>Valid kubeconfig or service account credentials available</li>
	<li>Namespace <tt>panda</tt> exists</li>
	<li>Focus Server deployed in namespace</li>
	<li>Network allows connection to K8s API server</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Cluster Details</b>:</p>

<ul>
	<li>API Server: <tt>&lt;<a href="https://10.10.100.102:6443" class="external-link" rel="nofollow noreferrer">https://10.10.100.102:6443</a></tt>&gt;</li>
	<li>Namespace: <tt>panda</tt></li>
	<li>Expected Deployment: <tt>panda-panda-focus-server</tt></li>
	<li>Expected Service: <tt>panda-panda-focus-server.panda:5000</tt></li>
</ul>


<p><b>Expected Pods</b>:</p>

<ul>
	<li>At least 1 Focus Server pod running</li>
	<li>Pod name pattern: <tt>panda-panda-focus-server-*</tt></li>
</ul>


<p><b>Expected Services</b>:</p>

<ul>
	<li>Service name: <tt>panda-panda-focus-server</tt></li>
	<li>Type: ClusterIP</li>
	<li>ClusterIP: <tt>10.43.103.101</tt></li>
	<li>Port: <tt>5000</tt></li>
</ul>


<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Import kubernetes library: <tt>from kubernetes import client, config</tt></td>
<td class='confluenceTd'>Library imported</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Load kubeconfig or service account credentials</td>
<td class='confluenceTd'>Config loaded successfully</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create API client: <tt>v1 = client.CoreV1Api()</tt></td>
<td class='confluenceTd'>Client created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Test connection: Get cluster version</td>
<td class='confluenceTd'>Version info returned (e.g., v1.25.x)</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>List all namespaces: <tt>v1.list_namespace()</tt></td>
<td class='confluenceTd'>Namespace list returned</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify namespace <tt>panda</tt> exists</td>
<td class='confluenceTd'><tt>'panda' in namespaces</tt> = True</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>List pods in <tt>panda</tt> namespace: <tt>v1.list_namespaced_pod(namespace='panda')</tt></td>
<td class='confluenceTd'>Pod list returned</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Search for Focus Server pods: filter by name pattern <tt>panda-panda-focus-server-*</tt></td>
<td class='confluenceTd'>At least 1 pod found</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>For each Focus Server pod, check status</td>
<td class='confluenceTd'>Status = <tt>Running</tt></td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify pod readiness: check <tt>ready</tt> condition</td>
<td class='confluenceTd'>Pod is Ready = True</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Check pod restart count</td>
<td class='confluenceTd'>Restart count &lt; 5 (acceptable threshold)</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>List services in <tt>panda</tt> namespace</td>
<td class='confluenceTd'>Service list returned</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Verify service <tt>panda-panda-focus-server</tt> exists</td>
<td class='confluenceTd'>Service found</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Verify service ClusterIP</td>
<td class='confluenceTd'>ClusterIP = <tt>10.43.103.101</tt></td>
</tr>
<tr>
<td class='confluenceTd'>15</td>
<td class='confluenceTd'>Verify service port</td>
<td class='confluenceTd'>Port = <tt>5000</tt></td>
</tr>
<tr>
<td class='confluenceTd'>16</td>
<td class='confluenceTd'>Optional: Get pod logs (last 10 lines)</td>
<td class='confluenceTd'>Logs accessible</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>Kubernetes <b>API accessible</b></li>
	<li>Cluster version retrieved successfully</li>
	<li>Namespace <tt>panda</tt> exists</li>
	<li>At least <b>1 Focus Server pod</b> found</li>
	<li>All Focus Server pods in <tt>Running</tt> state</li>
	<li>All pods are <b>Ready</b></li>
	<li>Restart count &lt; 5 (acceptable)</li>
	<li>Service <tt>panda-panda-focus-server</tt> exists</li>
	<li>Service has correct ClusterIP and port</li>
	<li>Pod logs accessible</li>
	<li>No API errors or authentication failures</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No cluster state changes</li>
	<li>No pods restarted</li>
	<li>API connection closed gracefully</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Kubernetes Cluster</b>:</p>

<ul>
	<li>API Server: <tt>&lt;<a href="https://10.10.100.102:6443" class="external-link" rel="nofollow noreferrer">https://10.10.100.102:6443</a></tt>&gt;</li>
	<li>Dashboard: <tt>&lt;<a href="https://10.10.100.102/" class="external-link" rel="nofollow noreferrer">https://10.10.100.102/</a></tt>&gt;</li>
	<li>Namespace: <tt>panda</tt></li>
</ul>


<p><b>Focus Server Deployment</b>:</p>

<ul>
	<li>Deployment Name: <tt>panda-panda-focus-server</tt></li>
	<li>Service: <tt>panda-panda-focus-server.panda:5000</tt></li>
	<li>ClusterIP: <tt>10.43.103.101</tt></li>
	<li>External (LoadBalancer): <tt>10.10.100.100:443</tt></li>
</ul>


<p><b>SSH Access</b> (for kubectl):</p>

<ul>
	<li>Jump Host: <tt>ssh root@10.10.100.3</tt></li>
	<li>Target Host: <tt>ssh prisma@10.10.100.113</tt></li>
	<li>Then run: <tt>kubectl get pods -n panda</tt> or <tt>k9s</tt></li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_kubernetes_connection</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/infrastructure/test_external_connectivity.py</tt>  <br/>
<b>Test Class</b>: <tt>TestExternalServicesConnectivity</tt>  <br/>
<b>Lines</b>: 172-219</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run Kubernetes connectivity test
</span>pytest tests/integration/infrastructure/test_external_connectivity.py::TestExternalServicesConnectivity::test_kubernetes_connection -v

<span class="code-comment"># Run with markers
</span>pytest -m <span class="code-quote-red">"kubernetes and infrastructure"</span> -v</pre>
</div></div>

<p><b>Dependencies</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">kubernetes&gt;=28.0.0</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~3-5 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13898]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13898">Infrastructure - MongoDB Direct Connection and Health Check</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43461-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43461-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Infrastructure - MongoDB Direct Connection and Health Check</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates direct TCP connection to MongoDB database server and verifies basic operations (authentication, ping, database listing). This is a critical infrastructure test that isolates MongoDB health from Focus Server functionality. Used for diagnostics when system issues occur.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: MongoDB Infrastructure</li>
	<li><b>Labels</b>: <tt>infrastructure</tt>, <tt>mongodb</tt>, <tt>connectivity</tt>, <tt>health-check</tt>, <tt>diagnostic</tt></li>
	<li><b>Test Type</b>: Infrastructure Test</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: INFRA-MONGODB-CONNECTIVITY-001</li>
	<li><b>Description</b>: MongoDB database must be accessible, authenticated, and operational</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>MongoDB is deployed and running (pod or external)</li>
	<li>MongoDB LoadBalancer service exposed at <tt>10.10.100.108:27017</tt></li>
	<li>Credentials available: <tt>username=prisma, password=prisma</tt></li>
	<li>Database <tt>prisma</tt> exists</li>
	<li>Network routing allows connection from test client to MongoDB</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Connection String</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mongodb://prisma:prisma@10.10.100.108:27017/?authSource=prisma</pre>
</div></div>

<p><b>Expected Database</b>: <tt>prisma</tt></p>

<p><b>Expected Collections</b>:</p>

<ul>
	<li><tt>recordings</tt></li>
	<li><tt>tasks</tt></li>
	<li><tt>metadata</tt></li>
	<li><tt>node4</tt></li>
</ul>


<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Import pymongo library: <tt>from pymongo import MongoClient</tt></td>
<td class='confluenceTd'>Library imported successfully</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create connection string: <tt>mongodb://prisma:prisma@10.10.100.108:27017/?authSource=prisma</tt></td>
<td class='confluenceTd'>Connection string created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Attempt TCP connection to <tt>10.10.100.108:27017</tt></td>
<td class='confluenceTd'>TCP connection established (socket open)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Create MongoClient with connection string</td>
<td class='confluenceTd'>Client object created</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Execute authentication against <tt>authSource=prisma</tt></td>
<td class='confluenceTd'>Authentication successful</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Execute ping command: <tt>client.admin.command('ping')</tt></td>
<td class='confluenceTd'>Ping returns {{
{'ok': 1}
<p>}}</p></td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>List all databases: <tt>client.list_database_names()</tt></td>
<td class='confluenceTd'>Database list returned</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify database <tt>prisma</tt> exists in list</td>
<td class='confluenceTd'><tt>'prisma' in databases</tt> = True</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Connect to database: <tt>db = client<span class="error">&#91;&#39;prisma&#39;&#93;</span></tt></td>
<td class='confluenceTd'>Database object created</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>List all collections: <tt>db.list_collection_names()</tt></td>
<td class='confluenceTd'>Collection list returned</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify required collections exist: <tt>recordings</tt>, <tt>tasks</tt>, <tt>metadata</tt>, <tt>node4</tt></td>
<td class='confluenceTd'>All collections found</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Execute simple query: <tt>db.recordings.find_one()</tt></td>
<td class='confluenceTd'>Query executes (with or without results)</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Measure ping latency</td>
<td class='confluenceTd'>Latency &lt; 100ms</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Close connection gracefully</td>
<td class='confluenceTd'>Connection closed without errors</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>TCP connection</b> to <tt>10.10.100.108:27017</tt> <b>successful</b></li>
	<li><b>Authentication</b> with <tt>prisma/prisma</tt> <b>successful</b></li>
	<li><b>Ping</b> command returns {{
{'ok': 1}
<p>}}</p></li>
	<li><b>Database</b> <tt>prisma</tt> <b>exists</b></li>
	<li><b>Collections</b> <tt>recordings</tt>, <tt>tasks</tt>, <tt>metadata</tt>, <tt>node4</tt> <b>exist</b></li>
	<li>Simple queries execute successfully</li>
	<li>Ping latency &lt; 100ms</li>
	<li>No connection errors or timeouts</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>MongoDB connection closed</li>
	<li>No open connections left</li>
	<li>MongoDB state unchanged (read-only operations)</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>MongoDB LoadBalancer</b>:</p>

<ul>
	<li>Host: <tt>10.10.100.108</tt></li>
	<li>Port: <tt>27017</tt></li>
	<li>Service: <tt>mongodb.panda</tt> (LoadBalancer)</li>
	<li>Internal Service: <tt>mongodb.panda:27017</tt> (ClusterIP: 10.43.74.248)</li>
</ul>


<p><b>Kubernetes</b>:</p>

<ul>
	<li>Namespace: <tt>panda</tt></li>
	<li>MongoDB Pod: Check with <tt>kubectl get pods -n panda | grep mongodb</tt></li>
</ul>


<p><b>SSH Access</b> (for troubleshooting):</p>

<ul>
	<li>Jump: <tt>ssh root@10.10.100.3</tt></li>
	<li>Target: <tt>ssh prisma@10.10.100.113</tt></li>
	<li>Then: <tt>k9s</tt> to view pods</li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_mongodb_connection</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/infrastructure/test_external_connectivity.py</tt>  <br/>
<b>Test Class</b>: <tt>TestExternalServicesConnectivity</tt>  <br/>
<b>Lines</b>: 68-125</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run MongoDB connectivity test
</span>pytest tests/integration/infrastructure/test_external_connectivity.py::TestExternalServicesConnectivity::test_mongodb_connection -v

<span class="code-comment"># Run with markers
</span>pytest -m <span class="code-quote-red">"mongodb and infrastructure"</span> -v</pre>
</div></div>

<p><b>Dependencies</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">pymongo&gt;=4.0.0</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-3 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13897]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13897">Integration - GET /sensors - Retrieve Available Sensors List</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43460-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43460-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration - GET /sensors - Retrieve Available Sensors List</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that the <tt>GET /sensors</tt> endpoint returns a complete list of all available sensors/channels in the system. This endpoint is a prerequisite for any configuration operation, as clients need to know which sensors are available before selecting a sensor range (ROI). The test verifies that the list is complete, accurate, and properly formatted.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>api-endpoint</tt>, <tt>sensors</tt>, <tt>smoke-test</tt>, <tt>get-request</tt>, <tt>discovery</tt>, <tt>prerequisite</tt></li>
	<li><b>Test Type</b>: Integration Test (Smoke)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SENSORS-LIST-001</li>
	<li><b>Description</b>: Server must provide endpoint to query all available sensors for configuration purposes</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running at <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>System has fiber optic sensors configured</li>
	<li>At least one sensor is available in the system</li>
	<li>Baby Analyzer has initialized and knows sensor count</li>
	<li>Endpoint is accessible (authentication if required)</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>No request body required</b> (GET request)</p>

<p><b>Expected Response Structure</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"sensors"</span>: [0, 1, 2, 3, 4, ..., N]
}</pre>
</div></div>

<p>OR</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"sensor_count"</span>: N,
  <span class="code-quote">"sensor_list"</span>: [0, 1, 2, ...]
}</pre>
</div></div>

<p><b>Query Parameters</b>: None</p>

<p><b>Headers</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Accept: application/json
Content-Type: application/json</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send <tt>GET &lt;<a href="https://10.10.100.100/focus-server/sensors" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/sensors</a></tt>&gt; request</td>
<td class='confluenceTd'>HTTP 200 OK</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Verify response Content-Type is <tt>application/json</tt></td>
<td class='confluenceTd'>Header: <tt>Content-Type: application/json</tt></td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Parse response body as JSON</td>
<td class='confluenceTd'>Valid JSON structure</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Extract sensors list from response (field: <tt>sensors</tt> or <tt>sensor_list</tt>)</td>
<td class='confluenceTd'>Array of integers</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify list is <b>non-empty</b></td>
<td class='confluenceTd'><tt>sensors.length &gt; 0</tt> (at least 1 sensor)</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify sensors are <b>integers</b></td>
<td class='confluenceTd'>All elements are type <tt>int</tt></td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify sensors are <b>non-negative</b></td>
<td class='confluenceTd'>All sensors &gt;= 0</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify sensors start at 0</td>
<td class='confluenceTd'>First sensor = 0</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify sensors are <b>sequential</b> (no gaps)</td>
<td class='confluenceTd'>sensors = <span class="error">&#91;0, 1, 2, ..., N&#93;</span></td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify sensor count is reasonable</td>
<td class='confluenceTd'>Count &lt; 10000 (system limit)</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Measure response time</td>
<td class='confluenceTd'>Response time &lt; 500ms</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Send request <b>again</b> to verify consistency</td>
<td class='confluenceTd'>Same list returned</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Compare with MongoDB sensor configuration (if available)</td>
<td class='confluenceTd'>Matches system configuration</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>Endpoint returns <b>HTTP 200 OK</b></li>
	<li>Response contains <b>array of sensors</b></li>
	<li>Sensors list is <b>non-empty</b> (at least 1 sensor)</li>
	<li>Sensors are <b>sequential integers</b> starting from 0: <tt><span class="error">&#91;0, 1, 2, 3, ..., N&#93;</span></tt></li>
	<li>No gaps in sequence</li>
	<li>Sensor count is reasonable (e.g., 0-1000)</li>
	<li>Response is <b>consistent</b> across multiple calls</li>
	<li>Response time &lt; 500ms</li>
	<li>No errors or exceptions</li>
</ul>


<p><b>Example Valid Response</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{<span class="code-quote">"sensors"</span>: [0, 1, 2, 3, 4, 5, ..., 200]}</pre>
</div></div>

<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No state changes (read-only operation)</li>
	<li>Server remains responsive</li>
	<li>Endpoint remains available for subsequent calls</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Environment Name</b>: new_production (panda namespace)</p>

<p><b>Backend (Focus Server)</b>:</p>

<ul>
	<li>URL: <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>Endpoint: <tt>GET &lt;<a href="https://10.10.100.100/focus-server/sensors" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/sensors</a></tt>&gt;</li>
	<li>Alternative: <tt>GET &lt;<a href="https://10.10.100.100/api/sensors" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/api/sensors</a></tt>&gt;</li>
	<li>SSL Verification: <tt>False</tt> (self-signed certificate)</li>
</ul>


<p><b>MongoDB</b> (for validation):</p>

<ul>
	<li>Host: <tt>10.10.100.108:27017</tt></li>
	<li>Database: <tt>prisma</tt></li>
	<li>Connection: <tt>mongodb://prisma:prisma@10.10.100.108:27017/?authSource=prisma</tt></li>
</ul>


<p><b>Kubernetes</b>:</p>

<ul>
	<li>Namespace: <tt>panda</tt></li>
	<li>Focus Server Service: <tt>panda-panda-focus-server.panda:5000</tt></li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Framework</b>: pytest 7.0+  <br/>
<b>Test Function</b>: <tt>test_get_sensors_list</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_live_monitoring_flow.py</tt>  <br/>
<b>Test Class</b>: <tt>TestLiveMonitoringHappyPath</tt>  <br/>
<b>Lines</b>: 129-156</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run this test
</span>pytest tests/integration/api/test_live_monitoring_flow.py::TestLiveMonitoringHappyPath::test_get_sensors_list -v

<span class="code-comment"># Run with output
</span>pytest tests/integration/api/test_live_monitoring_flow.py::TestLiveMonitoringHappyPath::test_get_sensors_list -v -s</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~1-2 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13896]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13896">Performance – Concurrent Task Limit</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43459-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            performance_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43459-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Objective"></a>Objective</h2>

<p>Determines the <b>maximum number of concurrent tasks</b> the system can handle reliably. This test validates system capacity under parallel load and identifies breaking points. Understanding concurrent task limits is critical for capacity planning and preventing system overload in production.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>performance</tt>, <tt>concurrency</tt>, <tt>load-test</tt>, <tt>capacity</tt>, <tt>stress-test</tt></li>
	<li><b>Test Type</b>: Performance Test (Load/Stress)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONCURRENCY-001</li>
	<li><b>Description</b>: System must support minimum number of concurrent tasks without degradation</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running with adequate resources</li>
	<li>System is under normal load (baseline)</li>
	<li>MongoDB can handle concurrent connections</li>
	<li>RabbitMQ can handle concurrent messages</li>
	<li>No resource limits (file descriptors, connections) hit</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Standard Configuration</b> (used for all concurrent tasks):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Test Scenarios</b>:</p>

<ul>
	<li>Scenario 1: 10 concurrent tasks</li>
	<li>Scenario 2: 20 concurrent tasks</li>
	<li>Scenario 3: 30 concurrent tasks</li>
	<li>Scenario 4: 40 concurrent tasks</li>
	<li>Scenario 5: 50 concurrent tasks (if previous succeed)</li>
</ul>


<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Start with 10 concurrent tasks</td>
<td class='confluenceTd'>Test count = 10</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create ThreadPoolExecutor with 10 workers</td>
<td class='confluenceTd'>Executor ready</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Generate 10 unique task_ids</td>
<td class='confluenceTd'>10 task_ids created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Submit 10 config requests in parallel (non-blocking)</td>
<td class='confluenceTd'>All submitted</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Wait for all requests to complete</td>
<td class='confluenceTd'>All futures resolved</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Count successes (status 200) and failures</td>
<td class='confluenceTd'>Success count recorded</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Calculate success rate: <tt>successes / total * 100%</tt></td>
<td class='confluenceTd'>Success rate %</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Calculate average latency for successful requests</td>
<td class='confluenceTd'>Avg latency recorded</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>If success rate &gt;= 90%, proceed to 20 concurrent tasks</td>
<td class='confluenceTd'>Move to next level</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Repeat steps 2-8 for 20, 30, 40, 50 tasks</td>
<td class='confluenceTd'>Test increasing loads</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Stop when success rate drops below 80%</td>
<td class='confluenceTd'>Breaking point identified</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Poll all successful tasks to verify they're operational</td>
<td class='confluenceTd'>All tasks can be queried</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Monitor system resources (CPU, Memory) during test</td>
<td class='confluenceTd'>Resources within limits</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Document maximum reliable concurrent task count</td>
<td class='confluenceTd'>Max capacity recorded</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>System <b>successfully handles</b> at least <b><span class="error">&#91;MIN_CONCURRENT&#93;</span></b> tasks (e.g., 10 - <b>needs specs meeting</b>)</li>
	<li><b>Success rate &gt;= 90%</b> for all tests up to capacity limit</li>
	<li><b>Graceful degradation</b> when limit exceeded:
	<ul>
		<li>No crashes or hangs</li>
		<li>Clear error messages (e.g., "System at capacity")</li>
		<li>No resource exhaustion</li>
	</ul>
	</li>
	<li><b>All successful tasks</b> remain operational and queryable</li>
	<li>System <b>recovers</b> after load removed</li>
</ul>


<p><b>Findings to Document</b>:</p>

<ul>
	<li>Maximum concurrent tasks with 90%+ success</li>
	<li>Maximum concurrent tasks with 80%+ success</li>
	<li>Breaking point (where failures exceed 20%)</li>
	<li>Resource bottleneck (CPU/Memory/Connections)</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>All test tasks cleaned up</li>
	<li>System resources released</li>
	<li>System returns to stable state</li>
	<li>Performance metrics logged for capacity planning</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_concurrent_task_creation</tt>, <tt>test_concurrent_task_polling</tt>, <tt>test_concurrent_task_max_limit</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/performance/test_performance_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestConcurrentTaskLimit</tt>  <br/>
<b>Lines</b>: 198-421</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run concurrency tests (can be slow and resource-intensive)
</span>pytest tests/integration/performance/test_performance_high_priority.py::TestConcurrentTaskLimit -v -s

<span class="code-comment"># Run with resource monitoring
</span>pytest tests/integration/performance/test_performance_high_priority.py::TestConcurrentTaskLimit::test_concurrent_task_max_limit -v -s</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-5 minutes (depending on capacity)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13895]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13895">Integration – GET /channels - Enabled Channels List</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43458-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43458-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>GET /channels - Enabled Channels List</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that the <tt>GET /channels</tt> endpoint returns a list of all enabled/available channels in the system. This is a critical smoke test that verifies basic API functionality and channel discovery mechanism. The endpoint is used by clients to determine which channels are available for configuration.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>api-endpoint</tt>, <tt>channels</tt>, <tt>smoke-test</tt>, <tt>get-request</tt>, <tt>discovery</tt></li>
	<li><b>Test Type</b>: Integration Test (Smoke)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CHANNELS-001</li>
	<li><b>Description</b>: Server must provide endpoint to query available/enabled channels</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running at <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>System has channels configured (fiber optic sensors)</li>
	<li>At least one channel is enabled</li>
	<li>Endpoint is accessible without authentication (or with valid credentials)</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>No request body required</b> (GET request)</p>

<p><b>Query Parameters</b>: None required</p>

<p><b>Headers</b>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Accept: application/json
Content-Type: application/json</pre>
</div></div>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send <tt>GET &lt;<a href="https://10.10.100.100/focus-server/channels" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/channels</a></tt>&gt; request</td>
<td class='confluenceTd'>HTTP 200 OK</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Verify response Content-Type is <tt>application/json</tt></td>
<td class='confluenceTd'>Header: <tt>Content-Type: application/json</tt></td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Parse response body as JSON</td>
<td class='confluenceTd'>Valid JSON structure</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify response contains list/array of channels</td>
<td class='confluenceTd'>Response is array or object with <tt>channels</tt> field</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify list is non-empty</td>
<td class='confluenceTd'><tt>channels.length &gt; 0</tt></td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>For each channel in list, verify structure has <tt>id</tt> or <tt>channel_id</tt> field</td>
<td class='confluenceTd'>All channels have identifier</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify channel IDs are non-negative integers</td>
<td class='confluenceTd'>All IDs &gt;= 0</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify channel IDs are in reasonable range (0-10000)</td>
<td class='confluenceTd'>All IDs &lt; 10000</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Optional: Verify <tt>enabled</tt> or <tt>status</tt> field if present</td>
<td class='confluenceTd'>If present, all should be <tt>enabled: true</tt></td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Measure response time</td>
<td class='confluenceTd'>Response time &lt; 1000ms</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Send request again and verify consistency</td>
<td class='confluenceTd'>Same channels returned</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Optional: Verify channel count matches system configuration</td>
<td class='confluenceTd'>Count matches expected number</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>Endpoint returns <b>HTTP 200 OK</b></li>
	<li>Response contains <b>list of channels</b></li>
	<li>List is <b>non-empty</b> (at least 1 channel)</li>
	<li>Each channel has:
	<ul>
		<li><b>Valid ID</b> (non-negative integer)</li>
		<li><b>Reasonable range</b> (0-10000 or system max)</li>
		<li>Optional: <tt>enabled: true</tt> or <tt>status: "active"</tt></li>
	</ul>
	</li>
	<li>Response is <b>consistent</b> across multiple calls</li>
	<li>Response time &lt; 1000ms</li>
	<li>No errors or exceptions</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No state changes (read-only operation)</li>
	<li>Server remains responsive</li>
	<li>Endpoint remains available</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<p><b>Specific Endpoint</b>:</p>

<ul>
	<li>URL: <tt>GET &lt;<a href="https://10.10.100.100/focus-server/channels" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/channels</a></tt>&gt;</li>
	<li>Alternative: <tt>GET &lt;<a href="https://10.10.100.100/api/channels" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/api/channels</a></tt>&gt;</li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_get_channels_endpoint_success</tt>, <tt>test_get_channels_endpoint_response_time</tt>, <tt>test_get_channels_endpoint_multiple_calls_consistency</tt>, <tt>test_get_channels_endpoint_channel_ids_sequential</tt>, <tt>test_get_channels_endpoint_enabled_status</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_api_endpoints_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestChannelsEndpoint</tt>  <br/>
<b>Lines</b>: 30-267</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run all channels endpoint tests
</span>pytest tests/integration/api/test_api_endpoints_high_priority.py::TestChannelsEndpoint -v

<span class="code-comment"># Run specific test
</span>pytest tests/integration/api/test_api_endpoints_high_priority.py::TestChannelsEndpoint::test_get_channels_endpoint_success -v

<span class="code-comment"># Run with markers
</span>pytest -m <span class="code-quote-red">"smoke"</span> -k <span class="code-quote-red">"channels"</span> -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~2-3 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13880]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13880">Stress - Configuration with Extreme Values </a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43430-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            stress_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43430-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server can handle configuration requests with extreme (but technically valid) parameter values, such as very large channel ranges, very high NFFT, or very large canvas heights.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that the server can accept and process configurations with boundary/extreme values without crashes or errors, demonstrating robustness under stress conditions.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>stress-test</tt>, <tt>extreme-values</tt>, <tt>robustness</tt></li>
	<li><b>Test Type</b>: Integration Test (Stress)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-EXTREME-VALUES</li>
	<li><b>Description</b>: Server must handle extreme (but valid) configuration values</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>System has sufficient resources to handle large configurations</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"config_extreme_values_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 8192,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 5000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 200
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 2000
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Extreme values</b>: <tt>nfft=8192</tt>, <tt>height=5000</tt>, <tt>channels=0-200</tt>, <tt>freq=0-2000</tt></p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with extreme values</td>
<td class='confluenceTd'>Pydantic validation passes</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured OR status 400 if values exceed system limits</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>If accepted, poll GET /waterfall</td>
<td class='confluenceTd'>Status 200/201, server handles request without crash</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Monitor server response time</td>
<td class='confluenceTd'>Response time may be longer but within acceptable limits</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify no server errors or crashes</td>
<td class='confluenceTd'>Server remains stable</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Option A</b>: Configuration accepted, server processes successfully (may be slow)</li>
	<li><b>Option B</b>: Configuration rejected with "exceeds system limits" error (acceptable)</li>
	<li><b>No crashes</b>: Server remains stable and responsive</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Server stable, no resource exhaustion</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_configuration_with_extreme_values
</span>
task_id = generate_task_id(<span class="code-quote">"extreme_values"</span>)
logger.info(f<span class="code-quote">"Test: Configuration <span class="code-keyword">with</span> extreme values <span class="code-keyword">for</span> {task_id}"</span>)

config_payload = {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 8192,  <span class="code-comment"># Very high NFFT
</span>    <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 5000},  <span class="code-comment"># Very tall canvas
</span>    <span class="code-quote">"channels"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 200},  <span class="code-comment"># Many channels
</span>    <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 2000},  <span class="code-comment"># Wide frequency <span class="code-object">range</span>
</span>    <span class="code-quote">"start_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"view_type"</span>: 0
}

<span class="code-keyword">try</span>:
    config_request = ConfigTaskRequest(**config_payload)
    response = focus_server_api.config_task(task_id, config_request)
    
    <span class="code-comment"># If accepted, verify server stability
</span>    <span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
    logger.info(<span class="code-quote">"Extreme values configuration accepted"</span>)
    
    <span class="code-comment"># Try to poll data
</span>    time.sleep(2.0)
    waterfall_response = focus_server_api.get_waterfall(task_id, 5)
    <span class="code-keyword">assert</span> waterfall_response.status_code <span class="code-keyword">in</span> [200, 201], \
        f<span class="code-quote">"Unexpected status: {waterfall_response.status_code}"</span>
    
    logger.info(<span class="code-quote">"Server stable <span class="code-keyword">with</span> extreme values"</span>)

<span class="code-keyword">except</span> <span class="code-object">Exception</span> <span class="code-keyword">as</span> e:
    <span class="code-comment"># If rejected, that's also acceptable (system limits)
</span>    error_msg = <span class="code-object">str</span>(e).lower()
    <span class="code-keyword">if</span> <span class="code-quote">"limit"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"exceed"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"too large"</span> <span class="code-keyword">in</span> error_msg:
        logger.info(f<span class="code-quote">"Extreme values rejected (system limits): {e}"</span>)
    <span class="code-keyword">else</span>:
        <span class="code-comment"># Unexpected error
</span>        <span class="code-keyword">raise</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_configuration_with_extreme_values</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_config_validation.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13879]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13879">Integration – Missing Required Fields</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43429-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43429-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration – Missing Required Fields</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server properly rejects configuration requests that are missing required fields (e.g., missing <tt>channels</tt>, <tt>frequencyRange</tt>, or <tt>nfftSelection</tt>). This ensures proper input validation and prevents incomplete configurations from being processed.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>negative-test</tt>, <tt>required-fields</tt>, <tt>input-validation</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-VALIDATION-001</li>
	<li><b>Description</b>: Server must validate all required fields in configuration requests and reject incomplete requests with appropriate error messages</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running and accessible</li>
	<li>API endpoint {{POST /config/
{task_id}}} is available<br/>
# Test client has network access to Focus Server<br/>
# MongoDB is accessible (for potential error logging)<br/>
<br/>
h2. Test Data<br/>
<br/>
h3. Test Data 1: Missing 'channels' Field<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 500
  },
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: Missing <tt>channels</tt> field - should be rejected<br/>
<br/>
h3. Test Data 2: Missing 'frequencyRange' Field<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 50
  },
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: Missing <tt>frequencyRange</tt> field - should be rejected<br/>
<br/>
h3. Test Data 3: Missing 'nfftSelection' Field<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 50
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 500
  },
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: Missing <tt>nfftSelection</tt> field - should be rejected<br/>
<br/>
h2. Steps<br/>
<br/>
||#||Step Description||Expected Result||<br/>
|1|Generate unique <tt>task_id</tt> (e.g., <tt>missing_fields_test_&lt;timestamp&gt;</tt>)|Valid task_id format|<br/>
|2|Create configuration payload <b>without</b> <tt>channels</tt> field (Test Data 1)|Payload created|<br/>
|3|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}
<p>}}&gt; with Test Data 1|HTTP 400 Bad Request|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify error message contains "channels" or "required field"</td>
<td class='confluenceTd'>Error message indicates missing field</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Create configuration payload <b>without</b> <tt>frequencyRange</tt> field (Test Data 2)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B+with+Test+Data+2%7CHTTP+400+Bad+Request%7C%3Cbr%2F%3E%0A%7C7%7CVerify+error+message+contains+%22frequencyRange%22+or+%22frequency%22%7CError+message+indicates+missing+field%7C%3Cbr%2F%3E%0A%7C8%7CCreate+configuration+payload+%3Cb%3Ewithout%3C%2Fb%3E+%3Ctt%3EnfftSelection%3C%2Ftt%3E+field+%28Test+Data+3%29%7CPayload+created%7C%3Cbr%2F%3E%0A%7C9%7CSend+%7B%7BPOST+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt; with Test Data 2|HTTP 400 Bad Request|<br/>
|7|Verify error message contains "frequencyRange" or "frequency"|Error message indicates missing field|<br/>
|8|Create configuration payload <b>without</b> <tt>nfftSelection</tt> field (Test Data 3)|Payload created|<br/>
|9|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}</a></tt>&gt; with Test Data 3</td>
<td class='confluenceTd'>HTTP 400 Bad Request</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify error message contains "nfft" or "required field"</td>
<td class='confluenceTd'>Error message indicates missing field</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify no task was created in the system</td>
<td class='confluenceTd'>No orphaned tasks</td>
</tr>
</tbody></table>
</div>
</li>
</ol>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>All configuration requests missing required fields are <b>rejected</b> with HTTP 400 Bad Request</li>
	<li>Error messages clearly indicate which field is missing</li>
	<li>No tasks are created for invalid configurations</li>
	<li>Server remains stable and responsive</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No tasks created</li>
	<li>Server logs contain validation errors (for debugging)</li>
	<li>System state unchanged</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Environment Name</b>: new_production (panda namespace)</p>

<p><b>Backend (Focus Server)</b>:</p>

<ul>
	<li>URL: <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>API Endpoint: {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>
{task_id}
<p>}}&gt;</p></li>
	<li>Swagger: <tt>&lt;<a href="https://10.10.100.100/api/swagger/#/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/api/swagger/#/</a></tt>&gt;</li>
	<li>SSL Verification: <tt>False</tt> (self-signed certificate)</li>
</ul>


<p><b>Frontend (LiveView)</b>:</p>

<ul>
	<li>URL: <tt>&lt;<a href="https://10.10.10.100/liveView?siteId=prisma-210-1000" class="external-link" rel="nofollow noreferrer">https://10.10.10.100/liveView?siteId=prisma-210-1000</a></tt>&gt;</li>
</ul>


<p><b>MongoDB</b>:</p>

<ul>
	<li>Host: <tt>10.10.100.108:27017</tt></li>
	<li>Connection: <tt>mongodb://prisma:prisma@10.10.100.108:27017/?authSource=prisma</tt></li>
	<li>Database: <tt>prisma</tt></li>
</ul>


<p><b>RabbitMQ</b>:</p>

<ul>
	<li>AMQP: <tt>10.10.100.107:5672</tt></li>
	<li>Management UI: <tt>&lt;<a href="http://10.10.100.107:15672" class="external-link" rel="nofollow noreferrer">http://10.10.100.107:15672</a></tt>&gt;</li>
</ul>


<p><b>Kubernetes</b>:</p>

<ul>
	<li>API Server: <tt>&lt;<a href="https://10.10.100.102:6443" class="external-link" rel="nofollow noreferrer">https://10.10.100.102:6443</a></tt>&gt;</li>
	<li>Namespace: <tt>panda</tt></li>
	<li>Focus Server Pod: <tt>panda-panda-focus-server.panda:5000</tt></li>
</ul>


<p><b>SSH Access</b> (for infrastructure tests):</p>

<ul>
	<li>Jump Host: <tt>ssh root@10.10.100.3</tt></li>
	<li>Target Host: <tt>ssh prisma@10.10.100.113</tt></li>
</ul>


<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_pz_13879_missing_required_fields</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_config_validation_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestMissingRequiredFields</tt>  </p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13878]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13878">Integration – Invalid View Type - Out of Range</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43428-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43428-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>Integration – Invalid View Type - Out of Range</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server properly rejects configuration requests with invalid <tt>view_type</tt> values (outside the defined enum range). Valid values are 0 (MULTICHANNEL) or 1 (SINGLECHANNEL). Any other value should be rejected.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>enum-validation</tt>, <tt>negative-test</tt>, <tt>view-type</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-VALIDATION-002</li>
	<li><b>Description</b>: Server must validate view_type enum and reject values outside <span class="error">&#91;0, 1&#93;</span> range</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running and accessible</li>
	<li>API endpoint {{POST /config/
{task_id}}} is available<br/>
# Valid enum values are documented: 0=MULTICHANNEL, 1=SINGLECHANNEL<br/>
<br/>
h2. Test Data<br/>
<br/>
h3. Test Data 1: Negative view_type<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: -1
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: <tt>view_type=-1</tt> is invalid (must be 0 or 1)<br/>
<br/>
h3. Test Data 2: Out-of-range view_type<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 99
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: <tt>view_type=99</tt> is invalid (must be 0 or 1)<br/>
<br/>
h3. Test Data 3: String view_type<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: <span class="code-quote">"invalid"</span>
}</pre>
</div></div><br/>
<br/>
<b>Note</b>: <tt>view_type="invalid"</tt> is wrong type (must be integer 0 or 1)<br/>
<br/>
h2. Steps<br/>
<br/>
||#||Step Description||Expected Result||<br/>
|1|Generate unique <tt>task_id</tt>|Valid task_id format|<br/>
|2|Create config with <tt>view_type=-1</tt> (Test Data 1)|Payload created|<br/>
|3|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}
<p>}}&gt;|HTTP 400 Bad Request|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify error indicates invalid view_type</td>
<td class='confluenceTd'>Error message: "invalid view_type" or "must be 0 or 1"</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Create config with <tt>view_type=99</tt> (Test Data 2)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 400 Bad Request</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify error indicates out-of-range value</td>
<td class='confluenceTd'>Error message indicates valid range</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Create config with <tt>view_type="invalid"</tt> (Test Data 3)</td>
<td class='confluenceTd'>Payload validation may fail</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Attempt to send request (if validation passes)</td>
<td class='confluenceTd'>HTTP 400 or TypeError</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify type validation works</td>
<td class='confluenceTd'>Type error caught</td>
</tr>
</tbody></table>
</div>
</li>
</ol>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>All invalid <tt>view_type</tt> values are <b>rejected</b></li>
	<li>Error messages clearly indicate valid values (0 or 1)</li>
	<li>Type validation prevents non-integer values</li>
	<li>Server remains stable</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No tasks created</li>
	<li>Server logs validation errors</li>
	<li>System state unchanged</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_pz_13878_invalid_view_type</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_config_validation_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestInvalidViewType</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13877]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13877">Integration – Invalid Frequency Range - Min &gt; Max</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43427-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43427-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects configuration requests where <tt>frequencyRange.min &gt; frequencyRange.max</tt>.</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server properly rejects configuration requests where <tt>frequencyRange.min &gt; frequencyRange.max</tt>, which represents an invalid/impossible frequency range. This ensures data integrity and prevents undefined behavior in frequency analysis.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>range-validation</tt>, <tt>frequency</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-VALIDATION-003</li>
	<li><b>Description</b>: Server must validate that frequencyRange.min ≤ frequencyRange.max and reject invalid ranges</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running at <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>Frequency range validation is implemented</li>
	<li>Server understands frequency range semantics</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<h3><a name="TestData1%3AMin%3EMax%28Invalid%29"></a>Test Data 1: Min &gt; Max (Invalid)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 500,
    <span class="code-quote">"max"</span>: 100
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>min=500 &gt; max=100</tt> - INVALID</p>

<h3><a name="TestData2%3AMin%3D%3DMax%28EdgeCase%29"></a>Test Data 2: Min == Max (Edge Case)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 250,
    <span class="code-quote">"max"</span>: 250
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>min == max</tt> - Edge case (zero range) - behavior to be determined</p>

<h3><a name="TestData3%3ANegativeFrequencies"></a>Test Data 3: Negative Frequencies</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: -100,
    <span class="code-quote">"max"</span>: 500
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>min=-100</tt> - Negative frequency (physically meaningless)</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate <tt>task_id</tt></td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create config with <tt>frequencyRange.min=500, max=100</tt> (Test Data 1)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B%7CHTTP+400+Bad+Request%7C%3Cbr%2F%3E%0A%7C4%7CVerify+error%3A+%3Ctt%3E%22frequencyRange.min+%28500%29+must+be+%26lt%3B%3D+frequencyRange.max+%28100%29%22%3C%2Ftt%3E%7CClear+error+message+with+actual+values%7C%3Cbr%2F%3E%0A%7C5%7CCreate+config+with+%3Ctt%3EfrequencyRange.min%3D250%2C+max%3D250%3C%2Ftt%3E+%28Test+Data+2%29%7CPayload+created%7C%3Cbr%2F%3E%0A%7C6%7CSend+%7B%7BPOST+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt;|HTTP 400 Bad Request|<br/>
|4|Verify error: <tt>"frequencyRange.min (500) must be &lt;= frequencyRange.max (100)"</tt>|Clear error message with actual values|<br/>
|5|Create config with <tt>frequencyRange.min=250, max=250</tt> (Test Data 2)|Payload created|<br/>
|6|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 400 Bad Request OR 200 (if zero range allowed)</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Document behavior for specs meeting</td>
<td class='confluenceTd'>Behavior logged for future specification</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Create config with negative frequency (Test Data 3)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 400 Bad Request</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify error mentions non-negative requirement</td>
<td class='confluenceTd'>Error: "Frequency values must be non-negative"</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><tt>frequencyRange.min &gt; frequencyRange.max</tt> is <b>rejected</b> with HTTP 400</li>
	<li>Error message shows both values and explains constraint</li>
	<li>Negative frequencies are <b>rejected</b></li>
	<li>Edge case (min == max) behavior is <b>documented</b></li>
	<li>No undefined behavior in system</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No tasks created</li>
	<li>Validation errors logged</li>
	<li>System stable</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_invalid_frequency_range_min_greater_than_max</tt>, <tt>test_frequency_range_equal_min_max</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_config_validation_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestInvalidRanges</tt>  <br/>
<b>Lines</b>: 296-392</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_config_validation_high_priority.py::TestInvalidRanges::test_invalid_frequency_range_min_greater_than_max -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~1 second</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13876]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13876">Integration – Invalid Channel Range - Min &gt; Max</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43426-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43426-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects configuration requests where <tt>channels.min &gt; channels.max</tt>, which is an invalid range.</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server properly rejects configuration requests where <tt>channels.min &gt; channels.max</tt>, which represents an invalid sensor/channel range. This is critical for ROI (Region of Interest) validation.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>channel-validation</tt>, <tt>roi</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-VALIDATION-004</li>
	<li><b>Description</b>: Server must validate that channels.min ≤ channels.max for valid ROI definition</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>Channel/sensor range validation implemented</li>
	<li>System knows total available channels</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<h3><a name="TestData1%3AMin%3EMax%28Invalid%29"></a>Test Data 1: Min &gt; Max (Invalid)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 50,
    <span class="code-quote">"max"</span>: 10
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>channels: min=50 &gt; max=10</tt> - INVALID</p>

<h3><a name="TestData2%3AMin%3D%3DMax%28SingleChannelEquivalent%29"></a>Test Data 2: Min == Max (SingleChannel Equivalent)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 7,
    <span class="code-quote">"max"</span>: 7
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>min == max</tt> - May be valid as SingleChannel equivalent</p>

<h3><a name="TestData3%3ANegativeChannelIDs"></a>Test Data 3: Negative Channel IDs</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: -5,
    <span class="code-quote">"max"</span>: 50
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>min=-5</tt> - Negative channel ID (invalid)</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate <tt>task_id</tt></td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create config with <tt>channels.min=50, max=10</tt> (Test Data 1)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B%7CHTTP+400+Bad+Request%7C%3Cbr%2F%3E%0A%7C4%7CVerify+error%3A+%3Ctt%3E%22channels.min+%2850%29+must+be+%26lt%3B%3D+channels.max+%2810%29%22%3C%2Ftt%3E%7CDescriptive+error%7C%3Cbr%2F%3E%0A%7C5%7CCreate+config+with+%3Ctt%3Echannels.min%3D7%2C+max%3D7%3C%2Ftt%3E+%28Test+Data+2%29%7CPayload+created%7C%3Cbr%2F%3E%0A%7C6%7CSend+%7B%7BPOST+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt;|HTTP 400 Bad Request|<br/>
|4|Verify error: <tt>"channels.min (50) must be &lt;= channels.max (10)"</tt>|Descriptive error|<br/>
|5|Create config with <tt>channels.min=7, max=7</tt> (Test Data 2)|Payload created|<br/>
|6|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 200 OR 400 (document behavior)</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>If accepted, verify view_type handling</td>
<td class='confluenceTd'>Check if treated as SINGLECHANNEL</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Create config with negative channel (Test Data 3)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 400 Bad Request</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify error: <tt>"Channel IDs must be non-negative"</tt></td>
<td class='confluenceTd'>Clear error</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><tt>channels.min &gt; channels.max</tt> is <b>rejected</b></li>
	<li>Negative channel IDs are <b>rejected</b></li>
	<li>Edge case (min == max) behavior <b>documented</b></li>
	<li>Clear error messages</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No invalid tasks created</li>
	<li>System stable</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_invalid_channel_range_min_greater_than_max</tt>, <tt>test_channel_range_equal_min_max</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_config_validation_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestInvalidRanges</tt>  <br/>
<b>Lines</b>: 395-478</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_config_validation_high_priority.py::TestInvalidRanges::test_invalid_channel_range_min_greater_than_max -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~1 second</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13875]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13875">Integration – Invalid NFFT - Negative Value</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43425-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43425-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects configuration requests with negative <tt>nfftSelection</tt> values.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper validation and error handling when attempting to configure a task with a negative NFFT value.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>error-handling</tt>, <tt>nfft</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-NFFT-VALIDATION</li>
	<li><b>Description</b>: NFFT must be a positive value</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"config_invalid_nfft_negative_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: -512,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Invalid parameter</b>: <tt>nfftSelection = -512</tt></p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>nfftSelection = -512</tt></td>
<td class='confluenceTd'>Validation error expected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Attempt POST /configure</td>
<td class='confluenceTd'>Status 400/422 or Pydantic exception</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error message</td>
<td class='confluenceTd'>Error indicates "negative" or "must be positive"</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify task not created</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400/422 or <tt>ValidationError</tt></li>
	<li><b>Error message</b>: "nfftSelection cannot be negative" or similar</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_invalid_nfft_negative_value
</span>
config_payload = {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: -512,  <span class="code-comment"># Invalid: negative
</span>    <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
    <span class="code-quote">"channels"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 50},
    <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    <span class="code-quote">"start_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"view_type"</span>: 0
}

<span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    config_request = ConfigTaskRequest(**config_payload)
    focus_server_api.config_task(task_id, config_request)

error_msg = <span class="code-object">str</span>(exc_info.value).lower()
<span class="code-keyword">assert</span> <span class="code-quote">"nfft"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"negative"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"positive"</span> <span class="code-keyword">in</span> error_msg

waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_invalid_nfft_negative_value</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_config_validation.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13874]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13874">Integration – Invalid NFFT - Zero Value</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43424-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43424-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects configuration requests with <tt>nfftSelection = 0</tt>, which is invalid for FFT processing.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper validation and error handling when attempting to configure a task with zero NFFT value.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>error-handling</tt>, <tt>nfft</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-NFFT-VALIDATION</li>
	<li><b>Description</b>: NFFT must be a positive, non-zero value (typically power of 2)</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"config_invalid_nfft_zero_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 0,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Invalid parameter</b>: <tt>nfftSelection = 0</tt></p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>nfftSelection = 0</tt></td>
<td class='confluenceTd'>Pydantic validation may fail OR server validation fails</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Attempt to send POST /configure</td>
<td class='confluenceTd'>Status 400 or 422 (Validation Error) OR Pydantic exception</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error message</td>
<td class='confluenceTd'>Error indicates "nfft must be positive" or similar</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify task not created</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400 or 422 for /configure (or Pydantic <tt>ValidationError</tt>)</li>
	<li><b>Error message</b>: "nfftSelection must be greater than 0" or similar</li>
	<li><b>Behavior</b>: Request rejected</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_invalid_nfft_zero_value
</span>
task_id = generate_task_id(<span class="code-quote">"invalid_nfft_zero"</span>)
logger.info(f<span class="code-quote">"Test: Invalid NFFT (zero) <span class="code-keyword">for</span> {task_id}"</span>)

config_payload = {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 0,  <span class="code-comment"># Invalid: zero
</span>    <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
    <span class="code-quote">"channels"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 50},
    <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    <span class="code-quote">"start_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword"><span class="code-object">None</span></span>,
    <span class="code-quote">"view_type"</span>: 0
}

<span class="code-comment"># Expect validation error (Pydantic <span class="code-keyword">or</span> server)
</span><span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    config_request = ConfigTaskRequest(**config_payload)
    focus_server_api.config_task(task_id, config_request)

error_msg = <span class="code-object">str</span>(exc_info.value).lower()
<span class="code-keyword">assert</span> <span class="code-quote">"nfft"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"zero"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"positive"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"greater"</span> <span class="code-keyword">in</span> error_msg

logger.info(f<span class="code-quote">"Validation error <span class="code-keyword">as</span> expected: {exc_info.value}"</span>)

<span class="code-comment"># Verify task <span class="code-keyword">not</span> created
</span>waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404, <span class="code-quote">"Task should <span class="code-keyword">not</span> have been created"</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_invalid_nfft_zero_value</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_config_validation.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13873]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13873">integration - Valid Configuration - All Parameters</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43423-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43423-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server correctly accepts and processes a fully valid configuration request with all parameters properly set.</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that Focus Server correctly <b>accepts</b> and processes a fully valid configuration request with all parameters properly set. This is the happy path test that confirms basic configuration functionality works correctly.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>config-validation</tt>, <tt>happy-path</tt>, <tt>smoke-test</tt>, <tt>positive-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Positive)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CONFIG-BASIC-001</li>
	<li><b>Description</b>: Server must accept and process valid configuration requests successfully</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running at <tt>&lt;<a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></tt>&gt;</li>
	<li>All required services (MongoDB, RabbitMQ) are healthy</li>
	<li>System has available resources for task creation</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<h3><a name="TestData1%3ACompleteValidConfiguration%28MULTICHANNEL%29"></a>Test Data 1: Complete Valid Configuration (MULTICHANNEL)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 50
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 500
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: All required fields present, valid values, MULTICHANNEL mode</p>

<h3><a name="TestData2%3AValidSINGLECHANNELConfiguration"></a>Test Data 2: Valid SINGLECHANNEL Configuration</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 7,
    <span class="code-quote">"max"</span>: 7
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 500
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Note</b>: SINGLECHANNEL mode with view_type=1</p>

<h3><a name="TestData3%3AValidwithVariousNFFTValues"></a>Test Data 3: Valid with Various NFFT Values</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 2048,
  <span class="code-quote">"displayInfo"</span>: {
    <span class="code-quote">"height"</span>: 1000
  },
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 100
  },
  <span class="code-quote">"frequencyRange"</span>: {
    <span class="code-quote">"min"</span>: 0,
    <span class="code-quote">"max"</span>: 1000
  },
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: Higher NFFT (2048), wider ranges</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate unique <tt>task_id</tt> (e.g., <tt>valid_config_test_&lt;timestamp&gt;</tt>)</td>
<td class='confluenceTd'>Valid task_id created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create complete valid configuration (Test Data 1)</td>
<td class='confluenceTd'>JSON payload with all required fields</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B+with+Test+Data+1%7CHTTP+200+OK%7C%3Cbr%2F%3E%0A%7C4%7CVerify+response%3A+%3Ctt%3E%7B%22status%22%3A+%22Config+received+successfully%22%7D%3C%2Ftt%3E+or+similar%7CSuccess+status+in+response+body%7C%3Cbr%2F%3E%0A%7C5%7CQuery+metadata+endpoint%3A+%7B%7BGET+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fmetadata%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fmetadata%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt; with Test Data 1|HTTP 200 OK|<br/>
|4|Verify response: <tt>{"status": "Config received successfully"}</tt> or similar|Success status in response body|<br/>
|5|Query metadata endpoint: {{GET &lt;<a href="https://10.10.100.100/focus-server/metadata/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/metadata/</a>{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 200 with task metadata</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify metadata matches configuration</td>
<td class='confluenceTd'>All config parameters reflected in metadata</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Query database: {{db.tasks.findOne(
{task_id: "&lt;task_id&gt;"})}}|Task document exists with correct config|<br/>
|8|Create SINGLECHANNEL config (Test Data 2) with new task_id|Payload created|<br/>
|9|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}
<p>}}&gt;</p></td>
<td class='confluenceTd'>HTTP 200 OK</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify SINGLECHANNEL mode activated</td>
<td class='confluenceTd'>Metadata shows view_type=1</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Test various NFFT values (256, 512, 1024, 2048)</td>
<td class='confluenceTd'>All accepted (power of 2 values)</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Verify response times &lt; 500ms for all requests</td>
<td class='confluenceTd'>Performance within acceptable range</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>All <b>valid</b> configurations are <b>accepted</b> with HTTP 200 OK</li>
	<li>Response includes success status message</li>
	<li>Tasks are created in MongoDB with correct configuration</li>
	<li>Metadata endpoint returns configuration details</li>
	<li>Task can be queried via <tt>/waterfall</tt> endpoint</li>
	<li>System processes configuration without errors</li>
	<li>All NFFT power-of-2 values accepted (256, 512, 1024, 2048)</li>
	<li>Both view_type 0 and 1 work correctly</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Tasks created successfully in MongoDB</li>
	<li>Baby Analyzer initialized with configuration</li>
	<li>Task ready for data streaming</li>
	<li>Server logs show successful configuration</li>
	<li>System resources allocated appropriately</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_valid_configuration_all_parameters</tt>, <tt>test_valid_configuration_multichannel_explicit</tt>, <tt>test_valid_configuration_singlechannel_explicit</tt>, <tt>test_valid_configuration_various_nfft_values</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_config_validation_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestValidConfigurationAllParameters</tt>  <br/>
<b>Lines</b>: 481-635</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run all valid configuration tests
</span>pytest tests/integration/api/test_config_validation_high_priority.py::TestValidConfigurationAllParameters -v

<span class="code-comment"># Run specific test
</span>pytest tests/integration/api/test_config_validation_high_priority.py::TestValidConfigurationAllParameters::test_valid_configuration_all_parameters -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~3-5 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13872]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13872">Integration – Historic Playback Complete End-to-End Flow</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43422-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43422-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Comprehensive end-to-end test for historic playback, covering configuration, polling, data collection, metadata retrieval, and completion verification.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that a complete historic playback session works correctly from start (configuration) to finish (status 208), demonstrating a full lifecycle workflow.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>end-to-end</tt>, <tt>full-flow</tt>, <tt>lifecycle</tt></li>
	<li><b>Test Type</b>: Integration Test (End-to-End)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-E2E</li>
	<li><b>Description</b>: Complete historic playback lifecycle must function correctly</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains recorded data</li>
	<li>Baby Analyzer functional</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_e2e_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_start&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_end&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'><b>Phase 1: Configuration</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate 5-minute time range</td>
<td class='confluenceTd'>Time range calculated</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'><b>Phase 2: Data Polling</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Poll GET /waterfall continuously</td>
<td class='confluenceTd'>Status transitions 200 → 201 → 208</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Collect all data blocks during status 201</td>
<td class='confluenceTd'>Multiple data blocks collected</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Track total rows received</td>
<td class='confluenceTd'>Row count tracked</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'><b>Phase 3: Data Validation</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify all timestamps within specified range</td>
<td class='confluenceTd'>All timestamps valid</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify timestamp ordering</td>
<td class='confluenceTd'>Sequential, no overlap</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify sensor data completeness</td>
<td class='confluenceTd'>All sensors have intensity data</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'><b>Phase 4: Completion</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Wait for status 208</td>
<td class='confluenceTd'>Status 208 received</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Verify playback duration reasonable</td>
<td class='confluenceTd'>Completed within expected time</td>
</tr>
<tr>
<td class='confluenceTd'>15</td>
<td class='confluenceTd'><b>Phase 5: Post-Completion</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>16</td>
<td class='confluenceTd'>Verify total rows &gt; 0</td>
<td class='confluenceTd'>Data was delivered</td>
</tr>
<tr>
<td class='confluenceTd'>17</td>
<td class='confluenceTd'>Log summary statistics</td>
<td class='confluenceTd'>Statistics logged</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Configuration</b>: Successful (status 200)</li>
	<li><b>Data delivery</b>: Multiple blocks, &gt; 50 rows total</li>
	<li><b>Data quality</b>: All timestamps valid, ordered, sensors complete</li>
	<li><b>Completion</b>: Status 208 within 200 seconds</li>
	<li><b>Summary</b>: Full lifecycle successful</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Historic playback completed successfully</li>
	<li>All data quality checks passed</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_playback_complete_e2e_flow
</span>
task_id = generate_task_id(<span class="code-quote">"historic_e2e"</span>)

<span class="code-comment"># Phase 1: Configuration
</span>logger.info(<span class="code-quote">"Phase 1: Configuring historic playback"</span>)
end_time_dt = datetime.now()
start_time_dt = end_time_dt - timedelta(minutes=5)
start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(sensors_min=0, sensors_max=50, live=<span class="code-keyword"><span class="code-object">False</span></span>, duration_minutes=5)
payload[<span class="code-quote">"start_time"</span>] = start_time
payload[<span class="code-quote">"end_time"</span>] = end_time

response = focus_server_api.config_task(task_id, ConfigTaskRequest(**payload))
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Phase 2: Data Polling
</span>logger.info(<span class="code-quote">"Phase 2: Polling historic data"</span>)
all_rows = []
status_transitions = []
start_poll_time = time.time()

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(100):
    waterfall_response = focus_server_api.get_waterfall(task_id, 10)
    
    <span class="code-keyword">if</span> <span class="code-keyword">not</span> status_transitions <span class="code-keyword">or</span> status_transitions[-1] != waterfall_response.status_code:
        status_transitions.append(waterfall_response.status_code)
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201 <span class="code-keyword">and</span> waterfall_response.data:
        <span class="code-keyword">for</span> block <span class="code-keyword">in</span> waterfall_response.data:
            <span class="code-keyword">for</span> row <span class="code-keyword">in</span> block.rows:
                all_rows.append(row)
    
    <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
        poll_duration = time.time() - start_poll_time
        logger.info(f<span class="code-quote">"Playback completed after {poll_duration:.1f} seconds"</span>)
        <span class="code-keyword">break</span>
    
    time.sleep(2.0)

<span class="code-comment"># Phase 3: Data Validation
</span>logger.info(<span class="code-quote">"Phase 3: Validating data quality"</span>)
<span class="code-keyword">assert</span> <span class="code-object">len</span>(all_rows) &gt; 0, <span class="code-quote">"No rows received"</span>

<span class="code-comment"># Verify timestamp ordering
</span><span class="code-keyword">for</span> i <span class="code-keyword">in</span> <span class="code-object">range</span>(<span class="code-object">len</span>(all_rows) - 1):
    <span class="code-keyword">assert</span> all_rows[i].endTimestamp &lt;= all_rows[i+1].startTimestamp

<span class="code-comment"># Verify sensor data
</span><span class="code-keyword">for</span> row <span class="code-keyword">in</span> all_rows:
    <span class="code-keyword">assert</span> <span class="code-object">len</span>(row.sensors) &gt; 0
    <span class="code-keyword">for</span> sensor <span class="code-keyword">in</span> row.sensors:
        <span class="code-keyword">assert</span> <span class="code-object">len</span>(sensor.intensity) &gt; 0

<span class="code-comment"># Phase 4: Summary
</span>logger.info(f<span class="code-quote">"E2E Historic Playback Summary:"</span>)
logger.info(f<span class="code-quote">"  - Total rows: {<span class="code-object">len</span>(all_rows)}"</span>)
logger.info(f<span class="code-quote">"  - Status transitions: {status_transitions}"</span>)
logger.info(f<span class="code-quote">"  - Duration: {poll_duration:.1f}s"</span>)
logger.info(<span class="code-quote">"  - All validations passed"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_playback_complete_e2e_flow</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13871]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13871">Integration – Historic Playback - Timestamp Ordering Validation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43421-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43421-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that all timestamps in historic playback data are strictly ordered, with no out-of-sequence or overlapping time ranges.</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that timestamps in historic playback data are <b>monotonically increasing</b> (each timestamp &gt;= previous timestamp). This is critical for data integrity, ensuring that time-series data is delivered in correct chronological order. Out-of-order timestamps can cause serious issues in client applications and data analysis.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>data-integrity</tt>, <tt>timestamps</tt>, <tt>ordering</tt></li>
	<li><b>Test Type</b>: Integration Test (Data Quality)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-ORDERING-001</li>
	<li><b>Description</b>: Historic data timestamps must be monotonically increasing</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains historical data with timestamps</li>
	<li>Historic playback returns data with timestamp fields</li>
	<li>Data is retrieved from actual recordings (not synthetic)</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Configuration for 2-minute historic range</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-quote">"251021120000"</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-quote">"251021120200"</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: 2-minute range for sufficient data points</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate 2-minute time range, 2 hours ago</td>
<td class='confluenceTd'>Valid time range</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Generate <tt>task_id</tt> and configure historic task</td>
<td class='confluenceTd'>Task configured successfully</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Poll waterfall endpoint to collect data</td>
<td class='confluenceTd'>Multiple data blocks received</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Extract all timestamps from all data blocks: <tt>block.rows[].startTimestamp</tt> and <tt>endTimestamp</tt></td>
<td class='confluenceTd'>List of timestamps collected</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify list contains at least 10 timestamps</td>
<td class='confluenceTd'>Sufficient data for validation</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Sort timestamps into chronological order</td>
<td class='confluenceTd'>Timestamps ordered</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Iterate through timestamps: for i in 0..N-1, verify <tt>timestamp<span class="error">&#91;i&#93;</span> &lt; timestamp<span class="error">&#91;i+1&#93;</span></tt></td>
<td class='confluenceTd'>All pairs satisfy: <tt>T<span class="error">&#91;i&#93;</span> &lt; T<span class="error">&#91;i+1&#93;</span></tt></td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Check within each data block: verify <tt>row.endTimestamp &gt; row.startTimestamp</tt></td>
<td class='confluenceTd'>End &gt; Start for every row</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Check between consecutive rows: verify <tt>row<span class="error">&#91;i&#93;</span>.endTimestamp &lt;= row<span class="error">&#91;i+1&#93;</span>.startTimestamp</tt></td>
<td class='confluenceTd'>No overlaps or gaps violations</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Calculate timestamp gaps: <tt>gap<span class="error">&#91;i&#93;</span> = timestamp<span class="error">&#91;i+1&#93;</span> - timestamp<span class="error">&#91;i&#93;</span></tt></td>
<td class='confluenceTd'>All gaps &gt; 0</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify no unreasonably large gaps (&gt; 10 seconds)</td>
<td class='confluenceTd'>All gaps &lt; 10s</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Verify no unreasonably small gaps (&lt; 0.1ms)</td>
<td class='confluenceTd'>All gaps &gt; 0.0001s</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>All timestamps are monotonically increasing</b></li>
	<li>No timestamp violations: <tt>T<span class="error">&#91;i&#93;</span> &gt;= T<span class="error">&#91;i+1&#93;</span></tt></li>
	<li>Within each row: <tt>endTimestamp &gt; startTimestamp</tt></li>
	<li>Between rows: no time overlaps (or overlaps are intentional/documented)</li>
	<li>Timestamp gaps are reasonable (0.0001s &lt; gap &lt; 10s)</li>
	<li>No duplicates (unless explicitly allowed)</li>
	<li>Data integrity maintained throughout playback</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Data validated successfully</li>
	<li>No data corruption detected</li>
	<li>Client can safely process data chronologically</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_timestamp_ordering_monotonic_increasing</tt>, <tt>test_timestamp_ordering_within_blocks</tt>, <tt>test_timestamp_gap_validation</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_historic_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestHistoricTimestampOrdering</tt>  <br/>
<b>Lines</b>: 202-427</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_historic_high_priority.py::TestHistoricTimestampOrdering -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~20-40 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13870]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13870">Integration – Historic Playback - Future Timestamps</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43420-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43420-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly handles historic playback requests with future timestamps, either rejecting them or gracefully completing with no data.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify error handling or graceful behavior when requesting historic data for a time range in the future (which cannot exist).</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>error-handling</tt>, <tt>future-timestamps</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-FUTURE</li>
	<li><b>Description</b>: Historic playback must handle future timestamps gracefully</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_future_timestamps_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_tomorrow&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_tomorrow_plus_5min&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Time Range</b>: Tomorrow (future)</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Set <tt>start_time = now() + 1 day</tt>, <tt>end_time = now() + 1 day + 5 minutes</tt></td>
<td class='confluenceTd'>Future time range</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200 (accepted) or 400 (rejected)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>If accepted, poll GET /waterfall</td>
<td class='confluenceTd'>Status 200 (no data) or 208 (no data, completed)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify no data returned</td>
<td class='confluenceTd'><tt>data_blocks_received == 0</tt></td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Option A</b>: Configuration rejected (status 400)</li>
	<li><b>Option B</b>: Configuration accepted, but no data (status 208 quickly)</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No data returned for future timestamps</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_future_timestamps
</span>
<span class="code-comment"># Create future time <span class="code-object">range</span>
</span>start_time_dt = datetime.now() + timedelta(days=1)
end_time_dt = start_time_dt + timedelta(minutes=5)

start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(sensors_min=0, sensors_max=50, live=<span class="code-keyword"><span class="code-object">False</span></span>, duration_minutes=5)
payload[<span class="code-quote">"start_time"</span>] = start_time
payload[<span class="code-quote">"end_time"</span>] = end_time

<span class="code-keyword">try</span>:
    response = focus_server_api.config_task(task_id, ConfigTaskRequest(**payload))
    
    <span class="code-comment"># If accepted, verify no data
</span>    data_found = <span class="code-keyword"><span class="code-object">False</span></span>
    <span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(30):
        waterfall_response = focus_server_api.get_waterfall(task_id, 10)
        
        <span class="code-keyword">if</span> waterfall_response.status_code == 201:
            data_found = <span class="code-keyword"><span class="code-object">True</span></span>
            <span class="code-keyword">break</span>
        <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
            logger.info(<span class="code-quote">"Future timestamps: no data (expected)"</span>)
            <span class="code-keyword">break</span>
        
        time.sleep(1.0)
    
    <span class="code-keyword">assert</span> <span class="code-keyword">not</span> data_found, <span class="code-quote">"Data should <span class="code-keyword">not</span> exist <span class="code-keyword">for</span> future timestamps"</span>
    
<span class="code-keyword">except</span> <span class="code-object">Exception</span> <span class="code-keyword">as</span> e:
    <span class="code-comment"># Configuration rejected (also acceptable)
</span>    logger.info(f<span class="code-quote">"Future timestamps rejected: {e}"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_future_timestamps</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13869]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13869">Integration – Historic Playback - Invalid Time Range (End Before Start)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43419-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43419-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects historic playback requests where <tt>end_time</tt> is before <tt>start_time</tt>, returning an appropriate error.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper validation and error handling when attempting to configure a historic playback with an invalid time range (end before start).</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>error-handling</tt>, <tt>validation</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-VALIDATION</li>
	<li><b>Description</b>: Historic playback must validate that start_time &lt; end_time</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_invalid_range_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_later&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_earlier&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Note</b>: <tt>start_time &gt; end_time</tt> (intentionally invalid)</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Set <tt>start_time = now()</tt>, <tt>end_time = now() - 10 minutes</tt> (inverted)</td>
<td class='confluenceTd'>Invalid time range created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 400 or 422 (Validation Error)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error message</td>
<td class='confluenceTd'>Error indicates "start_time must be before end_time" or similar</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify task not created</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400 or 422 for /configure</li>
	<li><b>Error message</b>: "Invalid time range: start_time must be before end_time"</li>
	<li><b>Behavior</b>: Request rejected</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_invalid_time_range_end_before_start
</span>
<span class="code-comment"># Create invalid time <span class="code-object">range</span> (end before start)
</span>start_time_dt = datetime.now()
end_time_dt = datetime.now() - timedelta(minutes=10)  <span class="code-comment"># Earlier than start
</span>
start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(sensors_min=0, sensors_max=50, live=<span class="code-keyword"><span class="code-object">False</span></span>, duration_minutes=5)
payload[<span class="code-quote">"start_time"</span>] = start_time
payload[<span class="code-quote">"end_time"</span>] = end_time

<span class="code-comment"># Expect validation error
</span><span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    focus_server_api.config_task(task_id, ConfigTaskRequest(**payload))

error_msg = <span class="code-object">str</span>(exc_info.value).lower()
<span class="code-keyword">assert</span> <span class="code-quote">"time"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"<span class="code-object">range</span>"</span> <span class="code-keyword">in</span> error_msg <span class="code-keyword">or</span> <span class="code-quote">"invalid"</span> <span class="code-keyword">in</span> error_msg

<span class="code-comment"># Verify task <span class="code-keyword">not</span> created
</span>waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_invalid_time_range_end_before_start</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13868]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13868">Integration – Historic Playback - Status 208 Completion</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43418-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43418-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that historic playback tasks correctly reach status 208 (baby analyzer exited) upon completion, signaling end-of-data.</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates that historic playback properly completes with HTTP status code 208 ("Already Reported") when all historical data has been delivered. This status indicates that the playback has finished and no more data is available for the requested time range. This is critical for clients to know when to stop polling.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>status-208</tt>, <tt>completion</tt>, <tt>polling</tt></li>
	<li><b>Test Type</b>: Integration Test (Flow)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-COMPLETE-001</li>
	<li><b>Description</b>: Server must signal playback completion with status 208</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains historical recording data (at least 2+ hours old)</li>
	<li>Historic playback functionality is implemented</li>
	<li>Waterfall endpoint supports status 208</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Configuration for 1-minute historic range</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-quote">"251021120000"</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-quote">"251021120100"</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: <tt>start_time</tt> and <tt>end_time</tt> in format <tt>yymmddHHMMSS</tt> (1 minute duration, 2 hours ago)</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate time range: 1 minute duration, 2 hours in the past</td>
<td class='confluenceTd'>Valid time range (ensure data exists)</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Convert times to <tt>yymmddHHMMSS</tt> format</td>
<td class='confluenceTd'>Valid timestamp strings (12 digits)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Generate unique <tt>task_id</tt></td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Create config with <tt>start_time</tt> and <tt>end_time</tt></td>
<td class='confluenceTd'>Historic config payload</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B%7CHTTP+200+OK+-+config+accepted%7C%3Cbr%2F%3E%0A%7C6%7CPoll+%7B%7BGET+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fwaterfall%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fwaterfall%2F%3C%2Fa%3E%7Btask_id%7D/100" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt;|HTTP 200 OK - config accepted|<br/>
|6|Poll {{GET &lt;<a href="https://10.10.100.100/focus-server/waterfall/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/waterfall/</a>{task_id}/100</a></tt>&gt; every 500ms</td>
<td class='confluenceTd'>Initially: HTTP 200 (no data yet) or 201 (data available)</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Track status codes seen: 200 → 201 → 208</td>
<td class='confluenceTd'>Status progression documented</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Continue polling until status 208 received</td>
<td class='confluenceTd'>Eventually: HTTP 208</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify status 208 has <b>no data</b> in response body</td>
<td class='confluenceTd'><tt>data: null</tt> or empty</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Poll 5 more times after receiving 208</td>
<td class='confluenceTd'>All subsequent polls: 208, 404, or 400</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify <b>no status 201</b> (new data) after 208</td>
<td class='confluenceTd'>No new data after completion</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Measure total time to completion</td>
<td class='confluenceTd'>Time &lt; 60 seconds for 1-minute range</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li>Historic playback <b>completes</b> with <b>HTTP 208</b></li>
	<li>Status progression: <tt>200 → 201 → 208</tt></li>
	<li>Status 208 contains <b>no data</b> (or empty data)</li>
	<li>After 208:
	<ul>
		<li>No new data (status 201) appears</li>
		<li>Subsequent polls return 208, 404, or 400</li>
	</ul>
	</li>
	<li>Completion happens within reasonable time (&lt; 60s for 1-min range)</li>
	<li>Clear indication that playback is complete</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Task marked as complete in system</li>
	<li>No more data available for this task</li>
	<li>Resources released (if applicable)</li>
	<li>Task may be cleaned up after timeout</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_historic_status_208_completion</tt>, <tt>test_historic_status_208_no_subsequent_data</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_historic_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestHistoricStatus208Completion</tt>  <br/>
<b>Lines</b>: 48-199</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_historic_high_priority.py::TestHistoricStatus208Completion -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~30-60 seconds (includes polling)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13867]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13867">Data Quality – Historic Playback - Data Integrity Validation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43417-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43417-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates data integrity during historic playback by checking timestamp ordering, sensor data completeness, and absence of corrupted data.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that all data returned during historic playback has sequential timestamps, complete sensor arrays, non-empty intensity data, and no missing or corrupted values.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>data-integrity</tt>, <tt>quality</tt>, <tt>validation</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-DATA-INTEGRITY</li>
	<li><b>Description</b>: All historic data must be complete, ordered, and free of corruption</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains clean, recorded data</li>
	<li>Historic playback configured for 5-minute range</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_integrity_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_start&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_end&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure historic task (5-minute range)</td>
<td class='confluenceTd'>Task configured</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Poll GET /waterfall, collect ALL data blocks</td>
<td class='confluenceTd'>Data collected</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>For each row in all blocks:</td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>→ Verify <tt>row.startTimestamp &lt;= row.endTimestamp</tt></td>
<td class='confluenceTd'>Timestamps valid</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>→ Verify timestamps are sequential (increasing)</td>
<td class='confluenceTd'><tt>row<span class="error">&#91;i&#93;</span>.endTimestamp &lt;= row<span class="error">&#91;i+1&#93;</span>.startTimestamp</tt></td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>→ Verify <tt>len(row.sensors) &gt; 0</tt></td>
<td class='confluenceTd'>Row has sensor data</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>→ For each sensor: <tt>assert sensor.id &gt;= 0</tt></td>
<td class='confluenceTd'>Valid sensor IDs</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>→ For each sensor: <tt>assert len(sensor.intensity) &gt; 0</tt></td>
<td class='confluenceTd'>Non-empty intensity arrays</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>→ Track last_timestamp, ensure no duplicates</td>
<td class='confluenceTd'>No duplicate timestamps</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Wait for status 208</td>
<td class='confluenceTd'>Playback completes</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify total rows collected &gt; 0</td>
<td class='confluenceTd'>Data received</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Verify all integrity checks passed</td>
<td class='confluenceTd'>No corrupted data found</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All rows valid</b>: Every row passes timestamp, sensor, and intensity checks</li>
	<li><b>Sequential timestamps</b>: No out-of-order or duplicate timestamps</li>
	<li><b>Complete data</b>: No missing sensors or empty intensity arrays</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Data integrity verified for historic playback</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_playback_data_integrity
</span>
<span class="code-comment"># Configure task
</span>response = focus_server_api.config_task(task_id, ConfigTaskRequest(**historic_config_payload))
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

all_rows = []
last_timestamp = 0

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(100):
    waterfall_response = focus_server_api.get_waterfall(task_id, 20)
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201 <span class="code-keyword">and</span> waterfall_response.data:
        <span class="code-comment"># Collect rows
</span>        <span class="code-keyword">for</span> block <span class="code-keyword">in</span> waterfall_response.data:
            <span class="code-keyword">for</span> row <span class="code-keyword">in</span> block.rows:
                all_rows.append(row)
                
                <span class="code-comment"># Check timestamp ordering
</span>                <span class="code-keyword">assert</span> row.startTimestamp &lt;= row.endTimestamp, \
                    <span class="code-quote">"Start timestamp &gt; end timestamp"</span>
                <span class="code-keyword">assert</span> row.startTimestamp &gt;= last_timestamp, \
                    <span class="code-quote">"Timestamps <span class="code-keyword">not</span> sequential"</span>
                last_timestamp = row.endTimestamp
                
                <span class="code-comment"># Check sensor data
</span>                <span class="code-keyword">assert</span> <span class="code-object">len</span>(row.sensors) &gt; 0, <span class="code-quote">"Row has no sensor data"</span>
                
                <span class="code-keyword">for</span> sensor <span class="code-keyword">in</span> row.sensors:
                    <span class="code-keyword">assert</span> sensor.<span class="code-object">id</span> &gt;= 0, <span class="code-quote">"Invalid sensor ID"</span>
                    <span class="code-keyword">assert</span> <span class="code-object">len</span>(sensor.intensity) &gt; 0, <span class="code-quote">"Sensor has no intensity data"</span>
    
    <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
        <span class="code-comment"># Playback complete
</span>        logger.info(f<span class="code-quote">"Data integrity verified: {<span class="code-object">len</span>(all_rows)} rows collected"</span>)
        <span class="code-keyword">break</span>
    
    time.sleep(2.0)

<span class="code-comment"># Final assertions
</span><span class="code-keyword">assert</span> <span class="code-object">len</span>(all_rows) &gt; 0, <span class="code-quote">"No rows collected during playback"</span>
logger.info(f<span class="code-quote">"All {<span class="code-object">len</span>(all_rows)} rows passed integrity checks"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_playback_data_integrity</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13866]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13866">Integration – Historic Playback - Very Old Timestamps (No Data)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43416-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43416-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server correctly handles historic playback requests for time ranges where no data exists (e.g., 1 year ago), returning appropriate status and messages.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify error handling or graceful completion when requesting historic data from a time period with no recorded data in MongoDB.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>error-handling</tt>, <tt>no-data</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-NODATA</li>
	<li><b>Description</b>: Historic playback must handle "no data available" scenarios gracefully</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB does NOT contain data from 1 year ago</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_old_nodata_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_1_year_ago&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_1_year_ago_plus_5min&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Time Range</b>: 1 year ago, 5-minute window</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate time range from 1 year ago</td>
<td class='confluenceTd'>Time range calculated</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured (server accepts config)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Poll GET /waterfall (max 30 attempts)</td>
<td class='confluenceTd'>Status 200 (no data yet) or 208 (no data found, exited)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify either: (a) Status 208 quickly (no data), or (b) Status 200 persists (no data available)</td>
<td class='confluenceTd'>Expected behavior for "no data" scenario</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify no data blocks received</td>
<td class='confluenceTd'><tt>data_blocks_received == 0</tt></td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Configuration accepted</b>: Status 200 for /configure</li>
	<li><b>No data</b>: Either status 208 (completed with no data) or persistent status 200</li>
	<li><b>No errors</b>: No crashes or unexpected errors</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task completes or remains in "no data" state</li>
	<li>No errors logged</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_with_very_old_timestamps
</span>
<span class="code-comment"># Calculate time <span class="code-object">range</span> <span class="code-keyword">from</span> 1 year ago
</span>end_time_dt = datetime.now() - timedelta(days=365)
start_time_dt = end_time_dt - timedelta(minutes=5)

start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(
    sensors_min=0,
    sensors_max=50,
    live=<span class="code-keyword"><span class="code-object">False</span></span>,
    duration_minutes=5
)
payload[<span class="code-quote">"start_time"</span>] = start_time
payload[<span class="code-quote">"end_time"</span>] = end_time

<span class="code-comment"># Configure task
</span>response = focus_server_api.config_task(task_id, ConfigTaskRequest(**payload))
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Poll <span class="code-keyword">and</span> expect no data
</span>data_found = <span class="code-keyword"><span class="code-object">False</span></span>
max_attempts = 30

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(max_attempts):
    waterfall_response = focus_server_api.get_waterfall(task_id, 10)
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        data_found = <span class="code-keyword"><span class="code-object">True</span></span>
        logger.warning(<span class="code-quote">"Unexpected data found <span class="code-keyword">for</span> 1-year-old timestamps"</span>)
        <span class="code-keyword">break</span>
    
    <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
        logger.info(<span class="code-quote">"Playback completed <span class="code-keyword">with</span> no data (expected)"</span>)
        <span class="code-keyword">break</span>
    
    time.sleep(1.0)

<span class="code-comment"># No data expected
</span><span class="code-keyword">assert</span> <span class="code-keyword">not</span> data_found, <span class="code-quote">"Data should <span class="code-keyword">not</span> exist <span class="code-keyword">for</span> 1-year-old timestamps"</span>
logger.info(<span class="code-quote">"No data scenario handled correctly"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_with_very_old_timestamps</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13865]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13865">Integration – Historic Playback - Short Duration (1 Minute)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43415-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43415-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server can handle a very short historic playback request (1 minute), completing quickly and efficiently.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that historic playback works correctly for minimal time ranges (1 minute), demonstrating that the system can handle short-duration queries without issues.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>short-duration</tt>, <tt>edge-case</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-SHORT</li>
	<li><b>Description</b>: Historic playback must support short time ranges (minimum 1 minute)</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains data from the last hour</li>
	<li>Baby Analyzer can process 1-minute playback</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_1min_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 20
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_start&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_end&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Time Range</b>: 1 minute (end_time - 1 minute to end_time)</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate 1-minute time range</td>
<td class='confluenceTd'><tt>start_time = now() - 1 minute</tt>, <tt>end_time = now()</tt></td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with 1-minute range</td>
<td class='confluenceTd'>Payload validated</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Poll GET /waterfall every 1 second (max 30 attempts)</td>
<td class='confluenceTd'>Status transitions to 201, then 208</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify status 208 received within 30 seconds</td>
<td class='confluenceTd'>Playback completes quickly</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify some data received</td>
<td class='confluenceTd'>Data blocks &gt; 0</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Quick completion</b>: Status 208 received within 30 polls (30 seconds)</li>
	<li><b>Data received</b>: At least some data blocks returned</li>
	<li><b>No errors</b>: Clean completion</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Short playback completed successfully</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_playback_with_short_duration
</span>
<span class="code-comment"># Create 1-minute historic <span class="code-object">range</span>
</span>end_time_dt = datetime.now()
start_time_dt = end_time_dt - timedelta(minutes=1)

start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(
    sensors_min=0,
    sensors_max=20,
    live=<span class="code-keyword"><span class="code-object">False</span></span>,
    duration_minutes=1
)

<span class="code-comment"># Configure task
</span>config_request = ConfigTaskRequest(**payload)
response = focus_server_api.config_task(task_id, config_request)
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Poll until completion (<span class="code-keyword">with</span> shorter timeout)
</span>max_attempts = 30
completed = <span class="code-keyword"><span class="code-object">False</span></span>

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(max_attempts):
    response = focus_server_api.get_waterfall(task_id, 10)
    
    <span class="code-keyword">if</span> response.status_code == 208:
        completed = <span class="code-keyword"><span class="code-object">True</span></span>
        logger.info(f<span class="code-quote">"Short playback completed after {attempt + 1} polls"</span>)
        <span class="code-keyword">break</span>
    
    time.sleep(1.0)

<span class="code-keyword">assert</span> completed, <span class="code-quote">"Short historic playback did <span class="code-keyword">not</span> complete <span class="code-keyword">in</span> time"</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_playback_with_short_duration</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>


<hr />

<h2><a name="Test%3APZHISTORICEXT003"></a>Test: PZ-HISTORIC-EXT-003</h2>

<p><b>Test Name</b>: Historic Playback - Long Duration (30 Minutes)</p>

<h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server can handle longer historic playback requests (30 minutes), ensuring stability and data integrity over extended processing.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that historic playback works correctly for longer time ranges (30 minutes), demonstrating that the system can sustain extended playback sessions without memory leaks or performance degradation.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>long-duration</tt>, <tt>stability</tt></li>
	<li><b>Test Type</b>: Integration Test (Long-Running)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-LONG</li>
	<li><b>Description</b>: Historic playback must support extended time ranges (up to 60 minutes)</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>MongoDB contains at least 30 minutes of recorded data from recent period</li>
	<li>Sufficient server resources for long playback</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_30min_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_start&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_end&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Time Range</b>: 30 minutes</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate 30-minute time range</td>
<td class='confluenceTd'>Time range calculated</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Poll GET /waterfall every 2 seconds (max 600 attempts = 20 minutes timeout)</td>
<td class='confluenceTd'>Status 201 data received continuously</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Track total data blocks received</td>
<td class='confluenceTd'>Large number of data blocks</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Wait for status 208</td>
<td class='confluenceTd'>Playback completes eventually</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify large amount of data received</td>
<td class='confluenceTd'>Data blocks &gt; 100</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify no memory issues or timeouts</td>
<td class='confluenceTd'>No server errors</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Long playback</b>: Completes within 20 minutes (600 polls)</li>
	<li><b>Large data volume</b>: &gt; 100 data blocks received</li>
	<li><b>Stability</b>: No errors, timeouts, or resource exhaustion</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Server stable after long playback</li>
	<li>Memory usage returns to normal</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_historic_playback_long_duration
</span>
<span class="code-comment"># Create 30-minute historic <span class="code-object">range</span>
</span>end_time_dt = datetime.now()
start_time_dt = end_time_dt - timedelta(minutes=30)

start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

payload = generate_config_payload(
    sensors_min=0,
    sensors_max=50,
    live=<span class="code-keyword"><span class="code-object">False</span></span>,
    duration_minutes=30
)

<span class="code-comment"># Configure task
</span>response = focus_server_api.config_task(task_id, ConfigTaskRequest(**payload))
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Poll <span class="code-keyword">with</span> longer timeout
</span>max_attempts = 600  <span class="code-comment"># 20 minutes
</span>data_blocks_received = 0

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(max_attempts):
    waterfall_response = focus_server_api.get_waterfall(task_id, 10)
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201 <span class="code-keyword">and</span> waterfall_response.data:
        data_blocks_received += <span class="code-object">len</span>(waterfall_response.data)
        
        <span class="code-keyword">if</span> attempt % 50 == 0:
            logger.info(f<span class="code-quote">"Poll {attempt}, data blocks: {data_blocks_received}"</span>)
    
    <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
        logger.info(f<span class="code-quote">"Long playback completed after {attempt + 1} polls"</span>)
        logger.info(f<span class="code-quote">"Total data blocks: {data_blocks_received}"</span>)
        <span class="code-keyword">assert</span> data_blocks_received &gt; 100, f<span class="code-quote">"Expected &gt;100 blocks, got {data_blocks_received}"</span>
        <span class="code-keyword">return</span>  <span class="code-comment"># Test passed
</span>    
    time.sleep(2.0)

pytest.fail(<span class="code-quote">"Long playback did <span class="code-keyword">not</span> complete <span class="code-keyword">in</span> time"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_historic_playback_long_duration</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13864]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13864">Integration – Historic Playback - Short Duration (1 Minute)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 21/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43414-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            None
                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43414-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>


<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13863]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13863">Integration – Historic Playback - Standard 5-Minute Range</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43413-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43413-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server correctly handles a standard historic playback request for a 5-minute time range, returning data from the specified historical period and completing with status 208.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server can process a historic playback configuration with <tt>start_time</tt> and <tt>end_time</tt> set to a 5-minute range, poll waterfall data until completion, and return all available data for the specified period.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>historic-playback</tt>, <tt>time-range</tt>, <tt>integration</tt>, <tt>api</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-HISTORIC-PLAYBACK</li>
	<li><b>Description</b>: Historic playback must support time-bound data retrieval with start/end timestamps</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running and accessible</li>
	<li>MongoDB contains recorded data for the specified time range</li>
	<li>Baby Analyzer can access and process historic recordings</li>
	<li>Recordings collection in MongoDB has data within the last 24 hours</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"historic_5min_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 50
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_start&gt;"</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-quote">"&lt;yymmddHHMMSS_end&gt;"</span>,
    <span class="code-quote">"view_type"</span>: 0
  }
}</pre>
</div></div>

<p><b>Time Range</b>: <tt>end_time = now()</tt>, <tt>start_time = end_time - 5 minutes</tt>  <br/>
<b>Format</b>: <tt>yymmddHHMMSS</tt> (e.g., "251020120000" for 2025-10-20 12:00:00)</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate time range: <tt>end_time = now()</tt>, <tt>start_time = end_time - 5 minutes</tt></td>
<td class='confluenceTd'>Time range calculated in <tt>yymmddHHMMSS</tt> format</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate time format using <tt>validate_time_format_yymmddHHMMSS()</tt></td>
<td class='confluenceTd'>Time strings validated</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>start_time</tt> and <tt>end_time</tt></td>
<td class='confluenceTd'>Payload validated by Pydantic</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, <tt>status: "Config received successfully"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Immediately send GET /waterfall/
{task_id}
<p>/10</p></td>
<td class='confluenceTd'>Status 200 (no data yet) or 201 (data available)</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Poll GET /waterfall every 2 seconds (max 100 attempts)</td>
<td class='confluenceTd'>Status transitions from 200 → 201 → 208</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Collect all data blocks during status 201 phases</td>
<td class='confluenceTd'>Multiple data blocks with waterfall rows</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Wait for status 208 (baby analyzer exited)</td>
<td class='confluenceTd'>Status 208 received, playback complete</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify total data blocks received &gt; 0</td>
<td class='confluenceTd'>At least some historic data retrieved</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify all timestamps fall within specified range</td>
<td class='confluenceTd'><tt>start_time &lt;= row.timestamp &lt;= end_time</tt></td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Verify timestamps are sequential and increasing</td>
<td class='confluenceTd'>Each row's timestamp &gt;= previous row's timestamp</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 200 for /configure, status transitions 200 → 201 → 208 for /waterfall</li>
	<li><b>Data received</b>: Multiple data blocks with valid waterfall rows</li>
	<li><b>Timestamps</b>: All within specified 5-minute range, sequential</li>
	<li><b>Completion</b>: Status 208 received within reasonable time (&lt; 200 seconds)</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Historic playback task completed successfully</li>
	<li>Baby analyzer process for this task exited cleanly</li>
	<li>No error messages in Focus Server logs</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_configure_historic_task_success (<span class="code-keyword">from</span> test_historic_playback_flow.py)
</span>
<span class="code-comment"># Generate time <span class="code-object">range</span>
</span><span class="code-keyword">from</span> src.utils.helpers <span class="code-keyword">import</span> generate_time_range, datetime_to_yymmddHHMMSS
end_time_dt = datetime.now()
start_time_dt = end_time_dt - timedelta(minutes=5)

start_time = datetime_to_yymmddHHMMSS(start_time_dt)
end_time = datetime_to_yymmddHHMMSS(end_time_dt)

historic_config_payload[<span class="code-quote">"start_time"</span>] = start_time
historic_config_payload[<span class="code-quote">"end_time"</span>] = end_time

logger.info(f<span class="code-quote">"Time <span class="code-object">range</span>: {start_time} to {end_time}"</span>)

<span class="code-comment"># Validate time <span class="code-object">format</span>
</span><span class="code-keyword">from</span> src.utils.validators <span class="code-keyword">import</span> validate_time_format_yymmddHHMMSS
<span class="code-keyword">assert</span> validate_time_format_yymmddHHMMSS(start_time)
<span class="code-keyword">assert</span> validate_time_format_yymmddHHMMSS(end_time)

<span class="code-comment"># Configure task
</span>config_request = ConfigTaskRequest(**historic_config_payload)
response = focus_server_api.config_task(task_id, config_request)

<span class="code-comment"># Assertions
</span><span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(response, ConfigTaskResponse)
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Poll until completion
</span>status_transitions = []
data_blocks_received = 0
max_poll_attempts = 100
poll_interval = 2.0

<span class="code-keyword">for</span> attempt <span class="code-keyword">in</span> <span class="code-object">range</span>(max_poll_attempts):
    waterfall_response = focus_server_api.get_waterfall(task_id, 10)
    
    <span class="code-comment"># Track status transitions
</span>    <span class="code-keyword">if</span> <span class="code-keyword">not</span> status_transitions <span class="code-keyword">or</span> status_transitions[-1] != waterfall_response.status_code:
        status_transitions.append(waterfall_response.status_code)
        logger.info(f<span class="code-quote">"Status transition: {waterfall_response.status_code}"</span>)
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        <span class="code-comment"># Data available
</span>        validation_result = validate_waterfall_response(waterfall_response)
        <span class="code-keyword">assert</span> validation_result[<span class="code-quote">"is_valid"</span>]
        
        <span class="code-keyword">if</span> waterfall_response.data:
            data_blocks_received += <span class="code-object">len</span>(waterfall_response.data)
    
    <span class="code-keyword">elif</span> waterfall_response.status_code == 208:
        <span class="code-comment"># Playback complete
</span>        logger.info(f<span class="code-quote">"Playback completed after {attempt + 1} polls"</span>)
        logger.info(f<span class="code-quote">"Total data blocks received: {data_blocks_received}"</span>)
        <span class="code-keyword">assert</span> data_blocks_received &gt; 0, <span class="code-quote">"No data blocks received during playback"</span>
        <span class="code-keyword">return</span>  <span class="code-comment"># Test passed
</span>    
    time.sleep(poll_interval)

pytest.fail(<span class="code-quote">"Playback did <span class="code-keyword">not</span> complete after 100 poll attempts"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
	<li><b>Focus Server</b>: <a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></li>
	<li><b>MongoDB</b>: 10.10.100.108:27017 (contains historic recordings)</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_configure_historic_task_success</tt>, <tt>test_poll_historic_playback_until_completion</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_historic_playback_flow.py</tt></li>
	<li><b>Execution</b>: <tt>pytest -m "integration and api" tests/integration/api/test_historic_playback_flow.py::TestHistoricPlaybackHappyPath::test_configure_historic_task_success</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13862]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13862">Integration - SingleChannel Complete Flow End-to-End</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43412-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13861">
                     PZ-13861                 </a>
            </td>
            <td>
                Integration - SingleChannel Stream Ma...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                                                    </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43412-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Comprehensive end-to-end test for SingleChannel view, covering configuration, data polling, metadata retrieval, reconfiguration, and cleanup, validating the complete lifecycle of a SingleChannel task.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that a SingleChannel task can be configured, polled for data, queried for metadata, reconfigured to a different channel, and cleaned up successfully, demonstrating a full end-to-end workflow.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>end-to-end</tt>, <tt>full-flow</tt>, <tt>lifecycle</tt></li>
	<li><b>Test Type</b>: Integration Test (End-to-End)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-E2E</li>
	<li><b>Description</b>: Complete SingleChannel lifecycle must function correctly</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Baby Analyzer is processing data</li>
	<li>At least 50 sensors available</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_e2e_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"initial_config"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 10,
      <span class="code-quote">"max"</span>: 10
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  },
  <span class="code-quote">"reconfig"</span>: {
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 25,
      <span class="code-quote">"max"</span>: 25
    }
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'><b>Phase 1: Initial Configuration</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Generate unique task_id</td>
<td class='confluenceTd'>Task ID created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure with channel 10</td>
<td class='confluenceTd'>Status 200, <tt>stream_amount=1</tt>, {{channel_to_stream_index=
{"10": 0}
<p>}}</p></td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'><b>Phase 2: Data Polling</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Poll GET /waterfall 10 times (collect data)</td>
<td class='confluenceTd'>Status 201, 10 successful polls, data for channel 10</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify all data contains sensor ID 10</td>
<td class='confluenceTd'>All rows have <tt>sensors<span class="error">&#91;0&#93;</span>.id == 10</tt></td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify timestamps are sequential</td>
<td class='confluenceTd'>Timestamps increase across polls</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'><b>Phase 3: Metadata Retrieval</b></td>
<td class='confluenceTd'>*</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Send GET /metadata/
{task_id}|Status 200, metadata returned|<br/>
|10|Verify metadata consistency|Metadata reflects channel 10 configuration|<br/>
|11|<b>Phase 4: Reconfiguration</b>|*|<br/>
|12|Send POST /configure with channel 25 (same task_id)|Status 200, <tt>channel_to_stream_index={"25": 0}</tt>|<br/>
|13|Poll GET /waterfall 5 times|Status 201, data for channel 25|<br/>
|14|Verify all data now contains sensor ID 25|All rows have <tt>sensors<span class="error">&#91;0&#93;</span>.id == 25</tt>|<br/>
|15|<b>Phase 5: Cleanup (optional)</b>|*|<br/>
|16|If DELETE /task/{task_id}
<p> supported, send DELETE</p></td>
<td class='confluenceTd'>Status 200, task deleted</td>
</tr>
<tr>
<td class='confluenceTd'>17</td>
<td class='confluenceTd'>Verify task no longer exists</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Phase 1</b>: Task configured successfully for channel 10</li>
	<li><b>Phase 2</b>: 10 polls return valid data for channel 10</li>
	<li><b>Phase 3</b>: Metadata retrieved and consistent</li>
	<li><b>Phase 4</b>: Task reconfigured to channel 25, data updates correctly</li>
	<li><b>Phase 5</b>: Task cleaned up (if supported)</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task either active (if cleanup not supported) or deleted</li>
	<li>No errors in server logs</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_complete_flow_e2e
</span>
task_id = generate_task_id(<span class="code-quote">"e2e"</span>)

<span class="code-comment"># Phase 1: Initial Configuration
</span>logger.info(<span class="code-quote">"Phase 1: Configuring channel 10"</span>)
response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
<span class="code-keyword">assert</span> response.stream_amount == 1
<span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-quote">"10"</span>: 0}

<span class="code-comment"># Phase 2: Data Polling
</span>logger.info(<span class="code-quote">"Phase 2: Polling data <span class="code-keyword">for</span> channel 10"</span>)
poll_count = 0
<span class="code-keyword">for</span> poll_num <span class="code-keyword">in</span> <span class="code-object">range</span>(10):
    waterfall_response = focus_server_api.get_waterfall(task_id, 5)
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        poll_count += 1
        <span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
            <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
                <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == 10
    time.sleep(0.5)

<span class="code-keyword">assert</span> poll_count &gt;= 8, f<span class="code-quote">"Only {poll_count}/10 polls succeeded"</span>

<span class="code-comment"># Phase 3: Metadata
</span>logger.info(<span class="code-quote">"Phase 3: Retrieving metadata"</span>)
metadata_response = focus_server_api.get_metadata(task_id)
<span class="code-keyword">assert</span> metadata_response <span class="code-keyword">is</span> <span class="code-keyword">not</span> <span class="code-keyword"><span class="code-object">None</span></span>

<span class="code-comment"># Phase 4: Reconfiguration
</span>logger.info(<span class="code-quote">"Phase 4: Reconfiguring to channel 25"</span>)
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = 25
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = 25
response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
<span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-quote">"25"</span>: 0}

time.sleep(1.0)  <span class="code-comment"># Wait <span class="code-keyword">for</span> reconfiguration
</span>
<span class="code-keyword">for</span> poll_num <span class="code-keyword">in</span> <span class="code-object">range</span>(5):
    waterfall_response = focus_server_api.get_waterfall(task_id, 5)
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        <span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
            <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
                <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == 25
    time.sleep(0.5)

logger.info(<span class="code-quote">"End-to-end SingleChannel flow completed successfully"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_complete_flow_e2e</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13861]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13861">Integration - SingleChannel Stream Mapping Verification</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43411-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13860">
                     PZ-13860                 </a>
            </td>
            <td>
                Integration - SingleChannel Metadata ...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13862">
                     PZ-13862                 </a>
            </td>
            <td>
                Integration - SingleChannel Complete ...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43411-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates the <tt>channel_to_stream_index</tt> mapping returned in the configuration response for various SingleChannel configurations, ensuring correct 1:1 mapping in all cases.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that for any valid SingleChannel configuration (any channel ID), the <tt>channel_to_stream_index</tt> always maps the single channel to stream index 0.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>channel-mapping</tt>, <tt>validation</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-MAPPING</li>
	<li><b>Description</b>: SingleChannel must always map the configured channel to stream index 0</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Multiple sensors available (e.g., 0-99)</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id_template"</span>: <span class="code-quote">"singlechannel_mapping_ch&lt;channel&gt;_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload_template"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: &lt;channel&gt;,
      <span class="code-quote">"max"</span>: &lt;channel&gt;
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Test channels</b>: 0, 1, 7, 15, 25, 50, 99</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>For each channel in <span class="error">&#91;0, 1, 7, 15, 25, 50, 99&#93;</span></td>
<td class='confluenceTd'>Iterate test channels</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create unique task_id for each channel</td>
<td class='confluenceTd'>Task IDs generated</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=channel</tt>, <tt>channels.max=channel</tt></td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify <tt>stream_amount == 1</tt></td>
<td class='confluenceTd'>Single stream</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify {{channel_to_stream_index == 
{str(channel): 0}
<p>}}</p></td>
<td class='confluenceTd'>Channel maps to stream 0</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify <tt>channel_amount == 1</tt></td>
<td class='confluenceTd'>Single channel</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All channels map correctly</b>: Every channel (0, 1, 7, etc.) maps to stream index 0</li>
	<li><b>stream_amount</b>: Always 1</li>
	<li><b>channel_amount</b>: Always 1</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Multiple tasks configured, each with correct mapping</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_stream_mapping_verification
</span>
test_channels = [0, 1, 7, 15, 25, 50, 99]

<span class="code-keyword">for</span> channel <span class="code-keyword">in</span> test_channels:
    task_id = generate_task_id(f<span class="code-quote">"mapping_ch{channel}"</span>)
    
    config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = channel
    config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = channel
    
    response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
    
    <span class="code-comment"># Verify mapping
</span>    <span class="code-keyword">assert</span> response.stream_amount == 1
    <span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-object">str</span>(channel): 0}, \
        f<span class="code-quote">"Channel {channel} did <span class="code-keyword">not</span> <span class="code-object">map</span> to stream 0"</span>
    <span class="code-keyword">assert</span> response.channel_amount == 1
    
    logger.info(f<span class="code-quote">"Channel {channel} → Stream 0 (verified)"</span>)

logger.info(<span class="code-quote">"All channel-to-stream mappings verified"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_stream_mapping_verification</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13860]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13860">Integration - SingleChannel Metadata Consistency</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43410-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13859">
                     PZ-13859                 </a>
            </td>
            <td>
                Integration - SingleChannel Polling S...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13861">
                     PZ-13861                 </a>
            </td>
            <td>
                Integration - SingleChannel Stream Ma...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43410-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that metadata returned for a SingleChannel task (via GET /metadata/</p>
{task_id}) is consistent with the configuration and reflects the single-channel setup.<br/>
<br/>
h3. Objective<br/>
<br/>
Verify that GET /metadata returns consistent and accurate metadata for a SingleChannel task, including channel count, stream count, and other configuration details.<br/>
<br/>
h3. Priority<br/>
<br/>
<b>Low</b><br/>
<br/>
h3. Components/Labels<br/>
<br/>
* <b>Component</b>: Focus Server Backend API<br/>
* <b>Labels</b>: <tt>singlechannel</tt>, <tt>metadata</tt>, <tt>consistency</tt><br/>
* <b>Test Type</b>: Integration Test<br/>
<br/>
h3. Requirements<br/>
<br/>
* <b>Requirement ID</b>: FOCUS-API-METADATA<br/>
* <b>Description</b>: Metadata endpoint must return accurate configuration details<br/>
<br/>
h3. Pre-Conditions<br/>
<br/>
# Focus Server is running<br/>
# SingleChannel task configured<br/>
<br/>
h3. Test Data<br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_metadata_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 7,
      <span class="code-quote">"max"</span>: 7
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div><br/>
<br/>
h3. Steps<br/>
<br/>
||#||Step Description||Expected Result||<br/>
|1|Configure SingleChannel task for channel 7|Status 200, task configured|<br/>
|2|Send GET /metadata/{task_id}
<p>|Status 200, metadata returned|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify metadata contains expected fields</td>
<td class='confluenceTd'>Required fields present</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify metadata reflects SingleChannel configuration</td>
<td class='confluenceTd'>Metadata shows 1 channel, 1 stream</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Compare metadata with configuration</td>
<td class='confluenceTd'>Metadata consistent with config</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Metadata returned</b>: GET /metadata returns status 200</li>
	<li><b>Consistency</b>: Metadata reflects SingleChannel configuration (1 channel, 1 stream)</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Metadata endpoint functional</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_metadata_consistency
</span>
response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
<span class="code-keyword">assert</span> response.stream_amount == 1

<span class="code-comment"># Get metadata
</span>metadata_response = focus_server_api.get_metadata(task_id)

<span class="code-comment"># Verify metadata structure
</span><span class="code-keyword">assert</span> metadata_response <span class="code-keyword">is</span> <span class="code-keyword">not</span> <span class="code-keyword"><span class="code-object">None</span></span>
logger.info(f<span class="code-quote">"Metadata: {metadata_response}"</span>)

<span class="code-comment"># Additional assertions based on actual metadata structure
</span><span class="code-comment"># (may vary depending on API implementation)</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_metadata_consistency</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13859]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13859">Integration - SingleChannel Polling Stability</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43409-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13858">
                     PZ-13858                 </a>
            </td>
            <td>
                Integration - SingleChannel Rapid Rec...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13860">
                     PZ-13860                 </a>
            </td>
            <td>
                Integration - SingleChannel Metadata ...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43409-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that prolonged polling of a SingleChannel task remains stable, with consistent response times and no degradation over time.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that continuous polling of a SingleChannel task for an extended period (e.g., 100 polls) does not result in performance degradation, memory leaks, or errors.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>stability</tt>, <tt>performance</tt>, <tt>long-running</tt></li>
	<li><b>Test Type</b>: Integration Test (Stability)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-STABILITY</li>
	<li><b>Description</b>: Continuous polling must remain stable without performance degradation</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>SingleChannel task configured</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_polling_stability_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 7,
      <span class="code-quote">"max"</span>: 7
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure SingleChannel task</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>For poll_num in range(100):</td>
<td class='confluenceTd'>100 polling iterations</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send GET /waterfall/
{task_id}
<p>/10</p></td>
<td class='confluenceTd'>Status 201, data returned</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Record response time</td>
<td class='confluenceTd'>Response time tracked</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify response structure</td>
<td class='confluenceTd'>Valid data structure</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Sleep 0.5 seconds</td>
<td class='confluenceTd'>Wait before next poll</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>After all polls, analyze response times</td>
<td class='confluenceTd'>Average response time calculated</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify no significant degradation</td>
<td class='confluenceTd'>Response times remain consistent</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All polls succeed</b>: 100/100 polls return status 201</li>
	<li><b>Response times stable</b>: No significant increase over time</li>
	<li><b>No errors</b>: No timeouts or server errors</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task still active and responsive</li>
	<li>Server memory usage stable</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_polling_stability
</span>
response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
<span class="code-keyword">assert</span> response.stream_amount == 1

response_times = []
successful_polls = 0

<span class="code-keyword">for</span> poll_num <span class="code-keyword">in</span> <span class="code-object">range</span>(100):
    start_time = time.time()
    waterfall_response = focus_server_api.get_waterfall(task_id, 10)
    elapsed = time.time() - start_time
    
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        successful_polls += 1
        response_times.append(elapsed)
    
    <span class="code-keyword">if</span> poll_num % 20 == 0:
        logger.info(f<span class="code-quote">"Poll {poll_num}/100, response time: {elapsed:.3f}s"</span>)
    
    time.sleep(0.5)

<span class="code-comment"># Verify <span class="code-object">all</span> polls succeeded
</span><span class="code-keyword">assert</span> successful_polls &gt;= 95, f<span class="code-quote">"Only {successful_polls}/100 polls succeeded"</span>

<span class="code-comment"># Verify response times are stable
</span>avg_response_time = <span class="code-object">sum</span>(response_times) / <span class="code-object">len</span>(response_times)
max_response_time = <span class="code-object">max</span>(response_times)

logger.info(f<span class="code-quote">"Polling stability: {successful_polls}/100 succeeded"</span>)
logger.info(f<span class="code-quote">"Avg response time: {avg_response_time:.3f}s, Max: {max_response_time:.3f}s"</span>)

<span class="code-keyword">assert</span> avg_response_time &lt; 2.0, <span class="code-quote">"Average response time too high"</span>
<span class="code-keyword">assert</span> max_response_time &lt; 5.0, <span class="code-quote">"Max response time too high"</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_polling_stability</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13858]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13858">Integration - SingleChannel Rapid Reconfiguration</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43408-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13857">
                     PZ-13857                 </a>
            </td>
            <td>
                Integration - SingleChannel NFFT Vali...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13859">
                     PZ-13859                 </a>
            </td>
            <td>
                Integration - SingleChannel Polling S...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43408-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that a SingleChannel task can be rapidly reconfigured multiple times without errors, ensuring the server handles configuration updates correctly.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server can handle multiple rapid reconfigurations of the same task_id, updating the channel selection each time without memory leaks or errors.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>reconfiguration</tt>, <tt>stress</tt>, <tt>stability</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-RECONFIGURATION</li>
	<li><b>Description</b>: Tasks must support reconfiguration without resource leaks</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>At least 20 sensors available</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_rapid_reconfig_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload_template"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: &lt;channel_id&gt;,
      <span class="code-quote">"max"</span>: &lt;channel_id&gt;
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate single task_id</td>
<td class='confluenceTd'>Unique task_id created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>For each channel in <span class="error">&#91;0, 5, 10, 15, 20&#93;</span> (5 iterations)</td>
<td class='confluenceTd'>Iterate channels</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Update <tt>config_payload</tt> with new channel (min=max=channel)</td>
<td class='confluenceTd'>Payload updated</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure with same task_id</td>
<td class='confluenceTd'>Status 200, configuration updated</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify response <tt>stream_amount == 1</tt></td>
<td class='confluenceTd'>Single stream</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify {{channel_to_stream_index == 
{str(channel): 0}
<p>}}</p></td>
<td class='confluenceTd'>Correct channel mapped</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Poll GET /waterfall</td>
<td class='confluenceTd'>Status 201, data for new channel returned</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify sensor ID matches new channel</td>
<td class='confluenceTd'>Correct sensor in data</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All reconfigurations succeed</b>: 5 rapid reconfigurations complete successfully</li>
	<li><b>Data consistency</b>: Each poll returns data for the newly configured channel</li>
	<li><b>No errors</b>: No memory leaks or server errors</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task configured with last channel (20)</li>
	<li>Server stable, no resource exhaustion</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_rapid_reconfiguration
</span>
task_id = generate_task_id(<span class="code-quote">"rapid_reconfig"</span>)
test_channels = [0, 5, 10, 15, 20]

<span class="code-keyword">for</span> channel <span class="code-keyword">in</span> test_channels:
    logger.info(f<span class="code-quote">"Reconfiguring task to channel {channel}"</span>)
    
    config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = channel
    config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = channel
    
    response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
    <span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
    <span class="code-keyword">assert</span> response.stream_amount == 1
    <span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-object">str</span>(channel): 0}
    
    <span class="code-comment"># Verify data
</span>    time.sleep(0.5)  <span class="code-comment"># Brief wait <span class="code-keyword">for</span> reconfiguration
</span>    waterfall_response = focus_server_api.get_waterfall(task_id, 5)
    <span class="code-keyword">if</span> waterfall_response.status_code == 201:
        <span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
            <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
                <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == channel

logger.info(<span class="code-quote">"Rapid reconfiguration test passed"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_rapid_reconfiguration</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13857]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13857">Integration - SingleChannel NFFT Validation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43407-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13855">
                     PZ-13855                 </a>
            </td>
            <td>
                Integration - SingleChannel Canvas He...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13858">
                     PZ-13858                 </a>
            </td>
            <td>
                Integration - SingleChannel Rapid Rec...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43407-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that SingleChannel view correctly accepts and applies different NFFT (FFT size) configurations.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server accepts various NFFT values (e.g., 512, 1024, 2048) and configures the task successfully, affecting the frequency resolution of the returned data.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>configuration</tt>, <tt>nfft</tt>, <tt>fft</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-NFFT-CONFIG</li>
	<li><b>Description</b>: NFFT configuration must be accepted and applied to signal processing</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Baby Analyzer supports various NFFT values</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_nfft_&lt;nfft&gt;_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: &lt;test_nfft&gt;,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 7,
      <span class="code-quote">"max"</span>: 7
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Test NFFT values</b>: 512, 1024, 2048</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>For each NFFT in <span class="error">&#91;512, 1024, 2048&#93;</span></td>
<td class='confluenceTd'>Iterate test NFFT values</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>nfftSelection = &lt;test_nfft&gt;</tt></td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify response success</td>
<td class='confluenceTd'><tt>status: "Config received successfully"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Poll GET /waterfall</td>
<td class='confluenceTd'>Status 201, data returned</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify intensity array length varies with NFFT</td>
<td class='confluenceTd'>Different NFFT → different intensity array size</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All NFFT values accepted</b>: 512, 1024, 2048 configure successfully</li>
	<li><b>Data impact</b>: Intensity array length reflects NFFT configuration</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Tasks configured with different NFFT values</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_nfft_validation
</span>
test_nfft_values = [512, 1024, 2048]

<span class="code-keyword">for</span> nfft <span class="code-keyword">in</span> test_nfft_values:
    task_id = generate_task_id(f<span class="code-quote">"nfft_{nfft}"</span>)
    config_payload[<span class="code-quote">"nfftSelection"</span>] = nfft
    
    response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
    <span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
    
    <span class="code-comment"># Poll data <span class="code-keyword">and</span> check intensity length
</span>    waterfall_response = focus_server_api.get_waterfall(task_id, 5)
    <span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
        <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
            intensity_len = <span class="code-object">len</span>(row.sensors[0].intensity)
            logger.info(f<span class="code-quote">"NFFT {nfft} → intensity length: {intensity_len}"</span>)
            <span class="code-keyword">assert</span> intensity_len &gt; 0</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_nfft_validation</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>


<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13855]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13855">Integration - SingleChannel Canvas Height Validation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43405-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13854">
                     PZ-13854                 </a>
            </td>
            <td>
                Integration - SingleChannel Frequency...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13857">
                     PZ-13857                 </a>
            </td>
            <td>
                Integration - SingleChannel NFFT Vali...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43405-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that SingleChannel view correctly accepts and applies different canvas height configurations.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server accepts various canvas height values (e.g., 500, 1000, 1500, 2000) and configures the task successfully.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Low</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>configuration</tt>, <tt>canvas-height</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-CANVAS-CONFIG</li>
	<li><b>Description</b>: Canvas height configuration must be accepted and stored</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_canvas_height_&lt;height&gt;_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: &lt;test_height&gt;
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 7,
      <span class="code-quote">"max"</span>: 7
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Test heights</b>: 500, 1000, 1500, 2000</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>For each height in <span class="error">&#91;500, 1000, 1500, 2000&#93;</span></td>
<td class='confluenceTd'>Iterate test heights</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>displayInfo.height = &lt;test_height&gt;</tt></td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify response success</td>
<td class='confluenceTd'><tt>status: "Config received successfully"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Poll GET /waterfall</td>
<td class='confluenceTd'>Status 201, data returned</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>All heights accepted</b>: 500, 1000, 1500, 2000 all configure successfully</li>
	<li><b>No errors</b>: All requests return status 200</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Tasks configured with different canvas heights</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_canvas_height_validation
</span>
test_heights = [500, 1000, 1500, 2000]

<span class="code-keyword">for</span> height <span class="code-keyword">in</span> test_heights:
    task_id = generate_task_id(f<span class="code-quote">"canvas_height_{height}"</span>)
    config_payload[<span class="code-quote">"displayInfo"</span>][<span class="code-quote">"height"</span>] = height
    
    response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
    <span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
    
    logger.info(f<span class="code-quote">"Canvas height {height} configured successfully"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_canvas_height_validation</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13854]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13854">Integration - SingleChannel Frequency Range Validation</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43404-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13853">
                     PZ-13853                 </a>
            </td>
            <td>
                Integration - SingleChannel Data Cons...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13855">
                     PZ-13855                 </a>
            </td>
            <td>
                Integration - SingleChannel Canvas He...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43404-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that SingleChannel view correctly applies and respects the specified frequency range configuration.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that when a SingleChannel task is configured with a specific frequency range (e.g., 100-300 Hz), the returned data reflects this configuration and the server processes the request correctly.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>configuration</tt>, <tt>frequency-range</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-FREQUENCY-RANGE</li>
	<li><b>Description</b>: Frequency range configuration must be applied correctly to data processing</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Baby Analyzer supports frequency range filtering</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_freq_range_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 7,
      <span class="code-quote">"max"</span>: 7
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 100,
      <span class="code-quote">"max"</span>: 300
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with {{frequencyRange: 
{min: 100, max: 300}
<p>}}</p></td>
<td class='confluenceTd'>Payload validated</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, task configured</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify response indicates frequency range accepted</td>
<td class='confluenceTd'>Response contains frequency range or no error</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Poll GET /waterfall</td>
<td class='confluenceTd'>Status 201, data returned</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify intensity array length reflects frequency range</td>
<td class='confluenceTd'><tt>len(intensity)</tt> matches expected frequency bins</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Configuration</b>: Frequency range 100-300 Hz applied</li>
	<li><b>Data</b>: Intensity arrays have correct length for specified range</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task configured with custom frequency range</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_frequency_range_validation
</span>
config_payload[<span class="code-quote">"frequencyRange"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = 100
config_payload[<span class="code-quote">"frequencyRange"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = 300

response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 201

<span class="code-comment"># Verify data structure (intensity length may vary based on NFFT <span class="code-keyword">and</span> freq <span class="code-object">range</span>)
</span><span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
    <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
        <span class="code-keyword">assert</span> <span class="code-object">len</span>(row.sensors[0].intensity) &gt; 0
        logger.info(f<span class="code-quote">"Intensity length: {<span class="code-object">len</span>(row.sensors[0].intensity)}"</span>)</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_frequency_range_validation</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>


<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13853]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13853">Integration - SingleChannel Data Consistency Check</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43403-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13852">
                     PZ-13852                 </a>
            </td>
            <td>
                Integration - SingleChannel with Min ...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13854">
                     PZ-13854                 </a>
            </td>
            <td>
                Integration - SingleChannel Frequency...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43403-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Objective"></a>Objective</h2>

<p>Validates that SingleChannel view returns <b>consistent data</b> across multiple requests for the same channel. Data consistency is critical for ensuring that the same channel configuration produces reproducible results. This test verifies that sensor mapping, data structure, and metadata remain stable.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>data-consistency</tt>, <tt>reproducibility</tt></li>
	<li><b>Test Type</b>: Integration Test (Quality)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-CONSISTENCY-001</li>
	<li><b>Description</b>: Same channel must return consistent data structure across multiple requests</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>SingleChannel view is implemented (<tt>view_type=1</tt>)</li>
	<li>System has live data available</li>
	<li>At least one valid channel exists (e.g., channel 7)</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>SingleChannel Configuration for Channel 7</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 7,
    <span class="code-quote">"max"</span>: 7
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Note</b>: <tt>channels.min == channels.max</tt> for SingleChannel, <tt>view_type=1</tt></p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate two unique task IDs: <tt>task_1</tt> and <tt>task_2</tt></td>
<td class='confluenceTd'>Two valid task_ids</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Configure <tt>task_1</tt> with channel 7 (Test Data)</td>
<td class='confluenceTd'>HTTP 200 - task configured</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Configure <tt>task_2</tt> with same channel 7</td>
<td class='confluenceTd'>HTTP 200 - task configured</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Poll waterfall for <tt>task_1</tt> until data received (status 201)</td>
<td class='confluenceTd'>Data received from task_1</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Poll waterfall for <tt>task_2</tt> until data received (status 201)</td>
<td class='confluenceTd'>Data received from task_2</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Compare number of data blocks: <tt>len(data_1) == len(data_2)</tt></td>
<td class='confluenceTd'>Same number of blocks</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>For each block, compare number of rows: <tt>len(block1.rows) == len(block2.rows)</tt></td>
<td class='confluenceTd'>Same row count</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>For each row, compare sensor count: <tt>len(row1.sensors) == len(row2.sensors)</tt></td>
<td class='confluenceTd'>Same sensor count (should be 1 for SingleChannel)</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Poll <tt>task_1</tt> multiple times (5 times)</td>
<td class='confluenceTd'>Multiple data batches</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify sensor count is consistent across all polls</td>
<td class='confluenceTd'>All polls return same sensor structure</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Query metadata for both tasks: {{GET /metadata/
{task_id}
<p>}}</p></td>
<td class='confluenceTd'>Metadata retrieved</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Compare metadata fields: channel, view_type, nfft, frequency range</td>
<td class='confluenceTd'>All metadata matches</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>Same channel</b> returns <b>same data structure</b></li>
	<li>Number of sensors is <b>consistent</b> (=1 for SingleChannel)</li>
	<li>Data structure <b>identical</b> across:
	<ul>
		<li>Different tasks with same config</li>
		<li>Multiple polls of same task</li>
	</ul>
	</li>
	<li>Metadata is <b>consistent</b> with configuration</li>
	<li>No random variations in structure</li>
	<li>Deterministic behavior</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Tasks can be cleaned up</li>
	<li>Data consistency validated</li>
	<li>System proven reliable</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_singlechannel_data_consistency_same_channel</tt>, <tt>test_singlechannel_data_consistency_polling</tt>, <tt>test_singlechannel_metadata_consistency</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_singlechannel_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestSingleChannelDataConsistency</tt>  <br/>
<b>Lines</b>: 50-208</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_singlechannel_high_priority.py::TestSingleChannelDataConsistency -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~10-20 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13852]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13852">Integration - SingleChannel with Min &gt; Max (Validation Error)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43402-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13837">
                     PZ-13837                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13853">
                     PZ-13853                 </a>
            </td>
            <td>
                Integration - SingleChannel Data Cons...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43402-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects SingleChannel configuration requests when <tt>channels.min &gt; channels.max</tt>, which violates the valid range definition for SingleChannel (min must equal max).</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Validates proper error handling when configuring SingleChannel with <b>invalid or non-existent channel IDs</b>. This includes negative channel IDs, very large channel IDs beyond system capacity, and wrong data types (strings instead of integers). Proper validation prevents undefined behavior and system crashes.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>validation</tt>, <tt>negative-test</tt>, <tt>error-handling</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-VALIDATION-001</li>
	<li><b>Description</b>: Server must validate channel IDs and reject invalid values</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running</li>
	<li>System has finite number of channels (e.g., 0-200)</li>
	<li>Channel validation is implemented</li>
	<li>System knows valid channel range</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<h3><a name="TestData1%3ANonexistentChannel%28VeryHighID%29"></a>Test Data 1: Non-existent Channel (Very High ID)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: 9999,
    <span class="code-quote">"max"</span>: 9999
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Note</b>: Channel 9999 likely doesn't exist</p>

<h3><a name="TestData2%3ANegativeChannelID"></a>Test Data 2: Negative Channel ID</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: -1,
    <span class="code-quote">"max"</span>: -1
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Note</b>: Negative channel ID is invalid</p>

<h3><a name="TestData3%3AStringChannelID%28TypeError%29"></a>Test Data 3: String Channel ID (Type Error)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {
    <span class="code-quote">"min"</span>: <span class="code-quote">"invalid"</span>,
    <span class="code-quote">"max"</span>: <span class="code-quote">"invalid"</span>
  },
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Note</b>: String instead of integer</p>

<h3><a name="TestData4%3AOutofBoundsChannel"></a>Test Data 4: Out-of-Bounds Channel</h3>

<p>First query system for max channel: <tt>GET /channels</tt> → extract max ID → use <tt>max_id + 100</tt></p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Query <tt>GET /channels</tt> to determine valid channel range</td>
<td class='confluenceTd'>List of valid channels</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Extract maximum channel ID from response</td>
<td class='confluenceTd'><tt>max_channel_id</tt> (e.g., 200)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Generate <tt>task_id</tt> for test 1</td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Create config with channel_id=9999 (Test Data 1)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%7D%7D%7D%26gt%3B%7CHTTP+400+or+404%7C%3Cbr%2F%3E%0A%7C6%7CVerify+error%3A+%3Ctt%3E%22Channel+9999+does+not+exist%22%3C%2Ftt%3E+or+similar%7CDescriptive+error%7C%3Cbr%2F%3E%0A%7C7%7CCreate+config+with+channel_id%3D-1+%28Test+Data+2%29%7CPayload+created%7C%3Cbr%2F%3E%0A%7C8%7CSend+%7B%7BPOST+%26lt%3B%3Ca+href%3D%22https%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%22+class%3D%22external-link%22+rel%3D%22nofollow+noreferrer%22%3Ehttps%3A%2F%2F10.10.100.100%2Ffocus-server%2Fconfig%2F%3C%2Fa%3E%7Btask_id%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id}}}&gt;|HTTP 400 or 404|<br/>
|6|Verify error: <tt>"Channel 9999 does not exist"</tt> or similar|Descriptive error|<br/>
|7|Create config with channel_id=-1 (Test Data 2)|Payload created|<br/>
|8|Send {{POST &lt;<a href="https://10.10.100.100/focus-server/config/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/</a>{task_id}</a></tt>&gt;</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify error: <tt>"Channel ID must be non-negative"</tt></td>
<td class='confluenceTd'>Clear error</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Attempt to create config with channel_id="invalid" (Test Data 3)</td>
<td class='confluenceTd'>Type validation error OR payload creation fails</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>If payload created, send request</td>
<td class='confluenceTd'>HTTP 400 or type error</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Create config with channel_id = <tt>max_channel_id + 100</tt> (Test Data 4)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Send request</td>
<td class='confluenceTd'>HTTP 400 or 404</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Verify error indicates valid range: {{"Valid channels: 0-
{max_channel_id}
<p>"}}</p></td>
<td class='confluenceTd'>Range shown in error</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>Non-existent channel ID (9999)</b> is <b>rejected</b> with 400/404</li>
	<li><b>Negative channel ID (-1)</b> is <b>rejected</b> with 400</li>
	<li><b>String channel ID</b> is caught by type validation</li>
	<li><b>Out-of-bounds channel</b> is <b>rejected</b> with descriptive error</li>
	<li>Error messages indicate:
	<ul>
		<li>Invalid channel ID provided</li>
		<li>Valid channel range</li>
	</ul>
	</li>
	<li>No tasks created for invalid channels</li>
	<li>System remains stable (no crashes)</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>No orphaned tasks</li>
	<li>Server stable</li>
	<li>Clear error logging</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_singlechannel_non_existent_channel_id</tt>, <tt>test_singlechannel_negative_channel_id</tt>, <tt>test_singlechannel_string_channel_id</tt>, <tt>test_singlechannel_out_of_bounds_channel_id</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/api/test_singlechannel_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestSingleChannelInvalidID</tt>  <br/>
<b>Lines</b>: 211-381</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash">pytest tests/integration/api/test_singlechannel_high_priority.py::TestSingleChannelInvalidID -v</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~5-10 seconds</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13837]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13837">Integration - SingleChannel with Invalid Channel (Negative)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43377-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13836">
                     PZ-13836                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13852">
                     PZ-13852                 </a>
            </td>
            <td>
                Integration - SingleChannel with Min ...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43377-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects SingleChannel configuration requests when the specified channel is a negative value.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper error handling when attempting to configure a SingleChannel view with a negative channel ID.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>error-handling</tt>, <tt>validation</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-VALIDATION</li>
	<li><b>Description</b>: SingleChannel view must validate channel bounds and reject negative values</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Sensor IDs are expected to be non-negative integers</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_invalid_negative_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: -5,
      <span class="code-quote">"max"</span>: -5
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=-5</tt>, <tt>channels.max=-5</tt></td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 400 or 422 (Validation Error)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error response message</td>
<td class='confluenceTd'>Error indicates "negative channel" or "invalid channel"</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify task was not created</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400 or 422 for /configure</li>
	<li><b>Error message</b>: "Channel index cannot be negative" or similar</li>
	<li><b>Behavior</b>: Request rejected immediately</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_with_negative_channel
</span>
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = -5
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = -5

<span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))

<span class="code-keyword">assert</span> <span class="code-quote">"negative"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower() <span class="code-keyword">or</span> \
       <span class="code-quote">"invalid"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower()

waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_with_negative_channel</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>


<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13836]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13836">Integration - SingleChannel with Invalid Channel (Negative)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43376-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13835">
                     PZ-13835                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13837">
                     PZ-13837                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43376-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects SingleChannel configuration requests when the specified channel is a negative value.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper error handling when attempting to configure a SingleChannel view with a negative channel ID.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>error-handling</tt>, <tt>validation</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-VALIDATION</li>
	<li><b>Description</b>: SingleChannel view must validate channel bounds and reject negative values</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>Sensor IDs are expected to be non-negative integers</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_invalid_negative_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: -5,
      <span class="code-quote">"max"</span>: -5
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=-5</tt>, <tt>channels.max=-5</tt></td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 400 or 422 (Validation Error)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error response message</td>
<td class='confluenceTd'>Error indicates "negative channel" or "invalid channel"</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify task was not created</td>
<td class='confluenceTd'>GET /waterfall returns 404</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400 or 422 for /configure</li>
	<li><b>Error message</b>: "Channel index cannot be negative" or similar</li>
	<li><b>Behavior</b>: Request rejected immediately</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_with_negative_channel
</span>
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = -5
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = -5

<span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))

<span class="code-keyword">assert</span> <span class="code-quote">"negative"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower() <span class="code-keyword">or</span> \
       <span class="code-quote">"invalid"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower()

waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_with_negative_channel</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>


<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13835]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13835">Integration - SingleChannel with Invalid Channel (Out of Range High)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43375-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13834">
                     PZ-13834                 </a>
            </td>
            <td>
                 Integration - SingleChannel Edge Cas...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13836">
                     PZ-13836                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43375-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates that Focus Server properly rejects SingleChannel configuration requests when the specified channel exceeds the maximum available sensor index.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify proper error handling when attempting to configure a SingleChannel view with a channel ID that is higher than the maximum available sensor.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>error-handling</tt>, <tt>validation</tt>, <tt>negative-test</tt></li>
	<li><b>Test Type</b>: Integration Test (Negative)</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-VALIDATION</li>
	<li><b>Description</b>: SingleChannel view must validate channel bounds and reject out-of-range values</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>GET /sensors returns available sensor list (e.g., 0-99 for 100 sensors)</li>
	<li>Maximum sensor ID is known</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_invalid_high_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 9999,
      <span class="code-quote">"max"</span>: 9999
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Note</b>: Channel 9999 is intentionally out of range.</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send GET /sensors to get max available sensor</td>
<td class='confluenceTd'>Status 200, sensors list returned</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=9999</tt>, <tt>channels.max=9999</tt> (out of range)</td>
<td class='confluenceTd'>Payload created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 400 or 422 (Bad Request / Validation Error)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify error response contains appropriate message</td>
<td class='confluenceTd'>Error message indicates "channel out of range" or similar</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Attempt GET /waterfall/
{task_id}
<p>/10</p></td>
<td class='confluenceTd'>Status 404 (task was never created)</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 400 or 422 for /configure</li>
	<li><b>Error message</b>: "Channel index 9999 out of range" or similar validation error</li>
	<li><b>Behavior</b>: Request rejected, no task created</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>No task created in server memory</li>
	<li>No consumer registered for this task_id</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_with_invalid_channel_high
</span>
sensors_response = focus_server_api.get_sensors()
max_sensor = sensors_response.sensors[-1]

invalid_channel = 9999  <span class="code-comment"># Clearly out of <span class="code-object">range</span>
</span>config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = invalid_channel
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = invalid_channel

<span class="code-comment"># Expect validation error
</span><span class="code-keyword">with</span> pytest.raises(<span class="code-object">Exception</span>) <span class="code-keyword">as</span> exc_info:
    focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))

<span class="code-comment"># Verify error indicates channel out of <span class="code-object">range</span>
</span><span class="code-keyword">assert</span> <span class="code-quote">"out of <span class="code-object">range</span>"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower() <span class="code-keyword">or</span> \
       <span class="code-quote">"invalid channel"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(exc_info.value).lower()

<span class="code-comment"># Verify task was <span class="code-keyword">not</span> created
</span>waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 404, <span class="code-quote">"Task should <span class="code-keyword">not</span> exist"</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_with_invalid_channel_high</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13834]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13834"> Integration - SingleChannel Edge Case - Middle Channel</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43374-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13833">
                     PZ-13833                 </a>
            </td>
            <td>
                Integration - SingleChannel Edge Case...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13835">
                     PZ-13835                 </a>
            </td>
            <td>
                Integration - SingleChannel with Inva...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43374-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates SingleChannel view behavior when configuring a middle-range channel, ensuring correct 1:1 mapping and data delivery for a non-boundary sensor.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server correctly handles SingleChannel view for any arbitrary channel in the middle of the sensor range, demonstrating that the feature works beyond just edge cases.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>Medium</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>functional</tt>, <tt>channel-mapping</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-ARBITRARY</li>
	<li><b>Description</b>: SingleChannel view must work for any valid sensor index</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running</li>
	<li>At least 10 sensors available in the system</li>
	<li>Baby Analyzer is processing data</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_middle_ch&lt;middle&gt;_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: &lt;middle_sensor_id&gt;,
      <span class="code-quote">"max"</span>: &lt;middle_sensor_id&gt;
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Note</b>: <tt>&lt;middle_sensor_id&gt;</tt> is calculated as <tt>len(sensors) // 2</tt>.</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send GET /sensors</td>
<td class='confluenceTd'>Sensors list returned</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate middle sensor ID (<tt>middle = len(sensors) // 2</tt>)</td>
<td class='confluenceTd'>Middle sensor identified</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=middle</tt>, <tt>channels.max=middle</tt>, <tt>view_type=SINGLECHANNEL</tt></td>
<td class='confluenceTd'>Valid payload</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, success message</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify <tt>stream_amount == 1</tt></td>
<td class='confluenceTd'>One stream</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify {{channel_to_stream_index == 
{str(middle): 0}
<p>}}</p></td>
<td class='confluenceTd'>Correct mapping</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Poll GET /waterfall</td>
<td class='confluenceTd'>Status 201, data returned</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify sensor ID in all rows matches middle channel</td>
<td class='confluenceTd'>Correct sensor ID</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Validate intensity data</td>
<td class='confluenceTd'>Non-empty, valid values</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>stream_amount</b>: 1</li>
	<li><b>channel_to_stream_index</b>: {{
{str(middle): 0}
<p>}}</p></li>
	<li><b>Data</b>: All rows contain middle channel sensor with valid intensity</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task active and delivering data for middle channel</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_middle_channel
</span>
sensors_response = focus_server_api.get_sensors()
middle_sensor = <span class="code-object">len</span>(sensors_response.sensors) // 2

config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = middle_sensor
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = middle_sensor
response = focus_server_api.config_task(task_id, ConfigTaskRequest(**config_payload))

<span class="code-keyword">assert</span> response.stream_amount == 1
<span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-object">str</span>(middle_sensor): 0}

waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
    <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
        <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == middle_sensor</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_middle_channel</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13833]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13833">Integration - SingleChannel Edge Case - Maximum Channel (Last Available)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43373-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                clones
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13832">
                     PZ-13832                 </a>
            </td>
            <td>
                Integration - SingleChannel Edge Case...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13834">
                     PZ-13834                 </a>
            </td>
            <td>
                 Integration - SingleChannel Edge Cas...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43373-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates SingleChannel view behavior when configuring the maximum available channel (last sensor), ensuring correct 1:1 mapping and data delivery for the edge case of the last sensor.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server correctly handles SingleChannel view for the maximum available channel, returning exactly one stream with proper mapping, and delivers valid sensor data for the last channel.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>edge-case</tt>, <tt>channel-mapping</tt>, <tt>api-integration</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-EDGE</li>
	<li><b>Description</b>: SingleChannel view must correctly handle boundary channels (min/max available sensors)</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running and accessible</li>
	<li>GET /sensors endpoint returns available sensor list with N sensors</li>
	<li>Maximum sensor index (N-1) is available</li>
	<li>Baby Analyzer is processing live data</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_max_ch&lt;max&gt;_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: &lt;max_sensor_id&gt;,
      <span class="code-quote">"max"</span>: &lt;max_sensor_id&gt;
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<p><b>Note</b>: <tt>&lt;max_sensor_id&gt;</tt> is dynamically determined from GET /sensors response.</p>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send GET /sensors to retrieve available sensors</td>
<td class='confluenceTd'>Status 200, sensors list returned</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Extract maximum sensor ID (<tt>max_sensor = sensors<span class="error">&#91;-1&#93;</span></tt>)</td>
<td class='confluenceTd'>Maximum sensor ID identified</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>channels.min=max_sensor</tt>, <tt>channels.max=max_sensor</tt>, <tt>view_type=SINGLECHANNEL</tt></td>
<td class='confluenceTd'>Request payload validated</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure</td>
<td class='confluenceTd'>Status 200, <tt>status: "Config received successfully"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify response <tt>stream_amount == 1</tt></td>
<td class='confluenceTd'>Exactly one stream configured</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify response {{channel_to_stream_index == 
{str(max_sensor): 0}
<p>}}</p></td>
<td class='confluenceTd'>Correct mapping for max channel</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify response <tt>channel_amount == 1</tt></td>
<td class='confluenceTd'>Only one channel configured</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Poll GET /waterfall/
{task_id}
<p>/10</p></td>
<td class='confluenceTd'>Status 201, data blocks returned</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify each data block contains exactly 1 stream</td>
<td class='confluenceTd'>Only one stream per block</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify rows contain sensor ID == max_sensor</td>
<td class='confluenceTd'>All rows have correct sensor ID</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Validate intensity data is non-empty</td>
<td class='confluenceTd'>Valid intensity values</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Validate timestamps are sequential</td>
<td class='confluenceTd'>Proper time ordering</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 200 for /configure, 201 for /waterfall</li>
	<li><b>stream_amount</b>: 1</li>
	<li><b>channel_to_stream_index</b>: {{
{str(max_sensor): 0}
<p>}}</p></li>
	<li><b>channel_amount</b>: 1</li>
	<li><b>Data integrity</b>: All rows contain max_sensor with valid intensity data</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task active and delivering data for maximum channel</li>
	<li>No errors in server logs</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_maximum_channel
</span>
<span class="code-comment"># Get available sensors
</span>sensors_response = focus_server_api.get_sensors()
max_sensor = sensors_response.sensors[-1]
logger.info(f<span class="code-quote">"Maximum sensor ID: {max_sensor}"</span>)

<span class="code-comment"># Configure SingleChannel <span class="code-keyword">for</span> <span class="code-object">max</span> sensor
</span>config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">min</span>"</span>] = max_sensor
config_payload[<span class="code-quote">"channels"</span>][<span class="code-quote">"<span class="code-object">max</span>"</span>] = max_sensor
config_request = ConfigTaskRequest(**config_payload)
response = focus_server_api.config_task(task_id, config_request)

<span class="code-comment"># Assertions
</span><span class="code-keyword">assert</span> response.stream_amount == 1
<span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-object">str</span>(max_sensor): 0}
<span class="code-keyword">assert</span> response.channel_amount == 1

<span class="code-comment"># Verify data
</span>waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
    <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:
        <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == max_sensor
        <span class="code-keyword">assert</span> <span class="code-object">len</span>(row.sensors[0].intensity) &gt; 0</pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_maximum_channel</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13832]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13832">Integration - SingleChannel Edge Case - Minimum Channel (Channel 0)</a>
            <span class="subText">
               Created: 21/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43372-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Cloners</b><br/>
                            </td>
                        </tr>
                                                                <tr>
            <td>
                is cloned by
            </td>
            <td>
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13833">
                     PZ-13833                 </a>
            </td>
            <td>
                Integration - SingleChannel Edge Case...
            </td>
            <td>
                TO DO
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43372-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h3><a name="Summary"></a>Summary</h3>

<p>Validates SingleChannel view behavior when configuring the minimum available channel (channel 0), ensuring correct 1:1 mapping and data delivery for the edge case of the first sensor.</p>

<h3><a name="Objective"></a>Objective</h3>

<p>Verify that Focus Server correctly handles SingleChannel view for channel 0, returning exactly one stream with proper mapping, and delivers valid sensor data for the first channel.</p>

<h3><a name="Priority"></a>Priority</h3>

<p><b>High</b></p>

<h3><a name="Components%2FLabels"></a>Components/Labels</h3>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>singlechannel</tt>, <tt>edge-case</tt>, <tt>channel-mapping</tt>, <tt>api-integration</tt></li>
	<li><b>Test Type</b>: Integration Test</li>
</ul>


<h3><a name="Requirements"></a>Requirements</h3>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-SINGLECHANNEL-EDGE</li>
	<li><b>Description</b>: SingleChannel view must correctly handle boundary channels (min/max available sensors)</li>
</ul>


<h3><a name="PreConditions"></a>Pre-Conditions</h3>

<ol>
	<li>Focus Server is running and accessible at configured base URL</li>
	<li>Environment configured for <tt>new_production</tt></li>
	<li>GET /sensors endpoint returns available sensor list</li>
	<li>At least sensor 0 exists in the system</li>
	<li>Baby Analyzer process is running and processing live fiber data</li>
	<li>RabbitMQ connection is active for command routing</li>
</ol>


<h3><a name="TestData"></a>Test Data</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"task_id"</span>: <span class="code-quote">"singlechannel_min_ch0_&lt;timestamp&gt;"</span>,
  <span class="code-quote">"config_payload"</span>: {
    <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
    <span class="code-quote">"nfftSelection"</span>: 1024,
    <span class="code-quote">"displayInfo"</span>: {
      <span class="code-quote">"height"</span>: 1000
    },
    <span class="code-quote">"channels"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 0
    },
    <span class="code-quote">"frequencyRange"</span>: {
      <span class="code-quote">"min"</span>: 0,
      <span class="code-quote">"max"</span>: 500
    },
    <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
    <span class="code-quote">"view_type"</span>: 1
  }
}</pre>
</div></div>

<h3><a name="Steps"></a>Steps</h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Generate unique <tt>task_id</tt> for test</td>
<td class='confluenceTd'>Unique task_id created (format: <tt>singlechannel_min_ch0_&lt;timestamp&gt;</tt>)</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send GET /sensors to retrieve available sensors</td>
<td class='confluenceTd'>Status 200, sensors list contains 0</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create <tt>ConfigureRequest</tt> with <tt>view_type=SINGLECHANNEL</tt>, <tt>channels.min=0</tt>, <tt>channels.max=0</tt></td>
<td class='confluenceTd'>Request payload validated by Pydantic model</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send POST /configure with payload</td>
<td class='confluenceTd'>Status 200, response contains <tt>status: "Config received successfully"</tt></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify response <tt>stream_amount</tt></td>
<td class='confluenceTd'><tt>stream_amount == 1</tt> (exactly one stream)</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify response <tt>channel_to_stream_index</tt></td>
<td class='confluenceTd'>Mapping is {{
{"0": 0}
<p>}} (channel 0 maps to stream 0)</p></td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify response <tt>channel_amount</tt></td>
<td class='confluenceTd'><tt>channel_amount == 1</tt> (only one channel configured)</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Send GET /waterfall/
{task_id}
<p>/10 to poll data</p></td>
<td class='confluenceTd'>Status 201, data blocks returned</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify each data block contains exactly 1 stream</td>
<td class='confluenceTd'><tt>len(data_block.data) == 1</tt> for all blocks</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify rows contain sensor ID 0</td>
<td class='confluenceTd'>All rows have <tt>sensors<span class="error">&#91;0&#93;</span>.id == 0</tt></td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Validate intensity data is non-empty</td>
<td class='confluenceTd'><tt>len(sensors<span class="error">&#91;0&#93;</span>.intensity) &gt; 0</tt></td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Validate timestamps are sequential and increasing</td>
<td class='confluenceTd'><tt>startTimestamp &lt;= endTimestamp</tt>, timestamps increase between rows</td>
</tr>
</tbody></table>
</div>


<h3><a name="ExpectedResult"></a>Expected Result</h3>

<ul>
	<li><b>Status code</b>: 200 for /configure, 201 for /waterfall</li>
	<li><b>stream_amount</b>: 1</li>
	<li><b>channel_to_stream_index</b>: {{
{"0": 0}
<p>}}</p></li>
	<li><b>channel_amount</b>: 1</li>
	<li><b>Data integrity</b>: All rows contain sensor 0 with valid intensity data</li>
	<li><b>Timestamps</b>: Sequential and increasing</li>
</ul>


<h3><a name="PostConditions"></a>Post-Conditions</h3>

<ul>
	<li>Task remains active (for live monitoring) or completes successfully (for historic)</li>
	<li>No error messages in Focus Server logs</li>
	<li>RabbitMQ command was successfully routed to Baby Analyzer</li>
	<li>Consumer for <tt>task_id</tt> exists in server memory</li>
</ul>


<h3><a name="Assertions%28PythonCode%29"></a>Assertions (Python Code)</h3>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Test function: test_singlechannel_minimum_channel (<span class="code-keyword">from</span> test_singlechannel_view_mapping.py)
</span>
<span class="code-comment"># Assertion 1: Verify response status
</span><span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(response, ConfigTaskResponse)
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>

<span class="code-comment"># Assertion 2: Verify stream amount
</span><span class="code-keyword">assert</span> response.stream_amount == 1, \
    f<span class="code-quote">"Expected stream_amount=1 <span class="code-keyword">for</span> SingleChannel, got {response.stream_amount}"</span>

<span class="code-comment"># Assertion 3: Verify channel-to-stream mapping
</span><span class="code-keyword">assert</span> response.channel_to_stream_index == {<span class="code-quote">"0"</span>: 0}, \
    f<span class="code-quote">"Expected mapping {{<span class="code-quote">'0'</span>: 0}}, got {response.channel_to_stream_index}"</span>

<span class="code-comment"># Assertion 4: Verify channel amount
</span><span class="code-keyword">assert</span> response.channel_amount == 1, \
    f<span class="code-quote">"Expected channel_amount=1, got {response.channel_amount}"</span>

<span class="code-comment"># Assertion 5: Poll <span class="code-keyword">and</span> verify data structure
</span>waterfall_response = focus_server_api.get_waterfall(task_id, 10)
<span class="code-keyword">assert</span> waterfall_response.status_code == 201, <span class="code-quote">"No data received"</span>

<span class="code-comment"># Assertion 6: Verify exactly one stream <span class="code-keyword">in</span> data blocks
</span><span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
    <span class="code-keyword">assert</span> <span class="code-object">len</span>(data_block.data) == 1, \
        f<span class="code-quote">"Expected 1 stream per block, got {<span class="code-object">len</span>(data_block.data)}"</span>

<span class="code-comment"># Assertion 7: Verify sensor ID <span class="code-keyword">is</span> 0
</span><span class="code-keyword">for</span> data_block <span class="code-keyword">in</span> waterfall_response.data:
    <span class="code-keyword">for</span> row <span class="code-keyword">in</span> data_block.data[0].rows:  <span class="code-comment"># Access first (<span class="code-keyword">and</span> only) stream
</span>        <span class="code-keyword">assert</span> row.sensors[0].<span class="code-object">id</span> == 0, \
            f<span class="code-quote">"Expected sensor ID 0, got {row.sensors[0].<span class="code-object">id</span>}"</span>
        <span class="code-keyword">assert</span> <span class="code-object">len</span>(row.sensors[0].intensity) &gt; 0, <span class="code-quote">"Intensity data <span class="code-keyword">is</span> empty"</span></pre>
</div></div>

<h3><a name="Environment"></a>Environment</h3>

<ul>
	<li><b>Environment Name</b>: new_production</li>
	<li><b>Focus Server</b>: <a href="https://10.10.100.100/focus-server/" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/</a></li>
	<li><b>MongoDB</b>: 10.10.100.108:27017</li>
	<li><b>RabbitMQ</b>: 10.10.100.107:5672</li>
</ul>


<h3><a name="AutomationStatus"></a>Automation Status</h3>

<ul>
	<li>✅ <b>Automated</b></li>
	<li><b>Test Function</b>: <tt>test_singlechannel_minimum_channel</tt></li>
	<li><b>Test File</b>: <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></li>
	<li><b>Execution</b>: <tt>pytest -m "integration and api" tests/integration/api/test_singlechannel_view_mapping.py::TestSingleChannelViewEdgeCases::test_singlechannel_minimum_channel</tt></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13824]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13824">API – SingleChannel Rejects Channel Zero</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43360-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43360-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel Rejects Channel Zero</p>

<p><b>Objective:</b> Verify that channel 0 is rejected (if channels start from 1).</p>

<p><b>Priority:</b> Low</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, validation, boundary</p>

<p><b>Requirements:</b> FOCUS-CHANNEL-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Channel numbering starts from 1</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid Request:
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 0},  <span class="code-comment">// Channel 0
</span>  <span class="code-quote">"view_type"</span>: 1
}

Expected: HTTP 400 (<span class="code-keyword">if</span> channels start from 1)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request with channel=0</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 400 or success</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify behavior</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Depends on system</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>If channels start from 1: rejected</li>
	<li>If channels start from 0: accepted</li>
	<li>Behavior documented</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Depends on system configuration</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 0},  <span class="code-comment"># Channel 0
</span>    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

<span class="code-keyword">try</span>:
    response = focus_server_api.configure(config_request)
    <span class="code-comment"># If accepted, channel 0 <span class="code-keyword">is</span> valid
</span>    logger.info(<span class="code-quote">"Channel 0 <span class="code-keyword">is</span> valid (channels start <span class="code-keyword">from</span> 0)"</span>)
    <span class="code-keyword">assert</span> <span class="code-quote">"0"</span> <span class="code-keyword">in</span> response.channel_to_stream_index
<span class="code-keyword">except</span> APIError <span class="code-keyword">as</span> e:
    <span class="code-comment"># If rejected, channels start <span class="code-keyword">from</span> 1
</span>    logger.info(<span class="code-quote">"Channel 0 rejected (channels start <span class="code-keyword">from</span> 1)"</span>)
    <span class="code-keyword">assert</span> e.status_code == 400

logger.info(<span class="code-quote">"✅ Channel 0 behavior documented"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_zero_channel</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13823]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13823">API – SingleChannel Rejects When min ≠ max</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43359-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43359-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel Rejects When min ≠ max</p>

<p><b>Objective:</b> Verify that view_type=SINGLECHANNEL requires min=max in channels, and rejects min≠max.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enforces min=max for SINGLECHANNEL</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid Request (min ≠ max):
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 5, <span class="code-quote">"max"</span>: 10},  <span class="code-comment">// Invalid <span class="code-keyword">for</span> SINGLECHANNEL
</span>  <span class="code-quote">"view_type"</span>: 1
}

Expected: HTTP 400 or 422</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request</td>
<td class='confluenceTd'>min=5, max=10, view_type=1</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 400 or 422</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"SINGLECHANNEL requires min=max"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Request rejected</li>
	<li>Clear validation error</li>
	<li>No job created</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>No job created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 5, <span class="code-quote">"<span class="code-object">max</span>"</span>: 10},  <span class="code-comment"># Invalid <span class="code-keyword">for</span> SINGLECHANNEL!
</span>    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

<span class="code-keyword">try</span>:
    response = focus_server_api.configure(config_request)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>, <span class="code-quote">"Should have rejected <span class="code-object">min</span>≠<span class="code-object">max</span> <span class="code-keyword">for</span> SINGLECHANNEL"</span>
<span class="code-keyword">except</span> APIError <span class="code-keyword">as</span> e:
    <span class="code-keyword">assert</span> e.status_code <span class="code-keyword">in</span> [400, 422]
    logger.info(f<span class="code-quote">"✓ <span class="code-object">min</span>≠<span class="code-object">max</span> rejected <span class="code-keyword">for</span> SINGLECHANNEL: {e}"</span>)

logger.info(<span class="code-quote">"✅ SINGLECHANNEL correctly requires <span class="code-object">min</span>=<span class="code-object">max</span>"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_min_not_equal_max_should_fail</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13822]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13822">API – SingleChannel Rejects Invalid NFFT Value</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43358-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43358-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel Rejects Invalid NFFT Value</p>

<p><b>Objective:</b> Verify SingleChannel rejects NFFT that is not power of 2.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, validation, nfft</p>

<p><b>Requirements:</b> FOCUS-NFFT-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: NFFT validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid Request:
{
  <span class="code-quote">"nfftSelection"</span>: 1000,  <span class="code-comment">// Not power of 2
</span>  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 10, <span class="code-quote">"max"</span>: 10},
  <span class="code-quote">"view_type"</span>: 1
}

Expected: HTTP 400</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request with nfft=1000</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"NFFT must be power of 2"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Non-power-of-2 NFFT rejected</li>
	<li>Clear error message</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>No job created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1000,  <span class="code-comment"># Not power of 2!
</span>    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 10, <span class="code-quote">"<span class="code-object">max</span>"</span>: 10},
    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

<span class="code-keyword">try</span>:
    response = focus_server_api.configure(config_request)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>, <span class="code-quote">"Should have rejected non-power-of-2 NFFT"</span>
<span class="code-keyword">except</span> (APIError, PydanticValidationError) <span class="code-keyword">as</span> e:
    logger.info(f<span class="code-quote">"✓ Invalid NFFT rejected: {e}"</span>)

logger.info(<span class="code-quote">"✅ SingleChannel rejects invalid NFFT"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_invalid_nfft</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13821]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13821">API – SingleChannel Rejects Invalid Display Height</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43357-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43357-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel Rejects Invalid Display Height</p>

<p><b>Objective:</b> Verify SingleChannel rejects invalid display height (zero or negative).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid Request:
{
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 0},  <span class="code-comment">// Invalid height
</span>  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 10, <span class="code-quote">"max"</span>: 10},
  <span class="code-quote">"view_type"</span>: 1
}

Expected: HTTP 400</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request with height=0</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"Invalid height"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Zero height rejected</li>
	<li>Clear error message</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>No job created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 0},  <span class="code-comment"># Invalid!
</span>    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 10, <span class="code-quote">"<span class="code-object">max</span>"</span>: 10},
    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

<span class="code-keyword">try</span>:
    response = focus_server_api.configure(config_request)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>, <span class="code-quote">"Should have rejected zero height"</span>
<span class="code-keyword">except</span> (APIError, PydanticValidationError) <span class="code-keyword">as</span> e:
    logger.info(f<span class="code-quote">"✓ Zero height rejected: {e}"</span>)

logger.info(<span class="code-quote">"✅ SingleChannel rejects invalid height"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_invalid_height</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13820]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13820">API – SingleChannel Rejects Invalid Frequency Range</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43356-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43356-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel Rejects Invalid Frequency Range</p>

<p><b>Objective:</b> Verify SingleChannel view rejects configurations with invalid frequency ranges (min &gt; max).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid Request:
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 10, <span class="code-quote">"max"</span>: 10},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 500, <span class="code-quote">"max"</span>: 0},  <span class="code-comment">// Invalid: min &gt; max
</span>  <span class="code-quote">"view_type"</span>: 1
}

Expected: HTTP 400 or validation error</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create invalid request</td>
<td class='confluenceTd'>freq min &gt; max</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify error message</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"Invalid frequency range"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Request rejected with 400</li>
	<li>Clear error message</li>
	<li>No job created</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>No job created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 10, <span class="code-quote">"<span class="code-object">max</span>"</span>: 10},
    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 500, <span class="code-quote">"<span class="code-object">max</span>"</span>: 0},  <span class="code-comment"># Invalid!
</span>    view_type=ViewType.SINGLECHANNEL
)

<span class="code-keyword">try</span>:
    response = focus_server_api.configure(config_request)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>, <span class="code-quote">"Should have rejected invalid frequency <span class="code-object">range</span>"</span>
<span class="code-keyword">except</span> APIError <span class="code-keyword">as</span> e:
    <span class="code-keyword">assert</span> e.status_code == 400
    <span class="code-keyword">assert</span> <span class="code-quote">"frequency"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(e).lower() <span class="code-keyword">or</span> <span class="code-quote">"invalid"</span> <span class="code-keyword">in</span> <span class="code-object">str</span>(e).lower()
    logger.info(f<span class="code-quote">"✓ Invalid frequency rejected: {e}"</span>)

logger.info(<span class="code-quote">"✅ SingleChannel rejects invalid frequency <span class="code-object">range</span>"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_invalid_frequency_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13819]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13819">API – SingleChannel View with Various Frequency Ranges</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43355-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43355-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel View with Various Frequency Ranges</p>

<p><b>Objective:</b> Verify SingleChannel works with different frequency configurations.</p>

<p><b>Priority:</b> Low</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, frequency</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-FREQUENCY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Various frequency ranges supported</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Test 1: {<span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500}}
Test 2: {<span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 100, <span class="code-quote">"max"</span>: 400}}
Test 3: {<span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 1000}}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure with freq 0-500</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success, mapping correct</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Configure with freq 100-400</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success, mapping correct</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Configure with freq 0-1000</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success, mapping correct</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify all work</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All pass</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>SingleChannel works with all frequency ranges</li>
	<li>Mapping always correct</li>
	<li>Frequency doesn't affect channel mapping</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Multiple jobs created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">frequency_ranges = [
    (0, 500),
    (100, 400),
    (0, 1000)
]

channel = 10

<span class="code-keyword">for</span> freq_min, freq_max <span class="code-keyword">in</span> frequency_ranges:
    config_request = ConfigureRequest(
        displayTimeAxisDuration=10,
        nfftSelection=1024,
        displayInfo={<span class="code-quote">"height"</span>: 1000},
        channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: channel, <span class="code-quote">"<span class="code-object">max</span>"</span>: channel},
        frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: freq_min, <span class="code-quote">"<span class="code-object">max</span>"</span>: freq_max},
        view_type=ViewType.SINGLECHANNEL
    )
    
    response = focus_server_api.configure(config_request)
    
    <span class="code-keyword">assert</span> response.stream_amount == 1
    <span class="code-keyword">assert</span> <span class="code-object">str</span>(channel) <span class="code-keyword">in</span> response.channel_to_stream_index
    <span class="code-keyword">assert</span> response.channel_to_stream_index[<span class="code-object">str</span>(channel)] == 0
    
    logger.info(f<span class="code-quote">"✓ Freq [{freq_min},{freq_max}]: mapping correct"</span>)

logger.info(<span class="code-quote">"✅ SingleChannel works <span class="code-keyword">with</span> different frequency ranges"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_with_different_frequency_ranges</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13818]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13818">API – Compare SingleChannel vs MultiChannel View Types</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43354-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43354-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – Compare SingleChannel vs MultiChannel View Types</p>

<p><b>Objective:</b> Verify distinct behavior between view_type=SINGLECHANNEL (1) and view_type=MULTICHANNEL (0).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, view-type, comparison</p>

<p><b>Requirements:</b> FOCUS-VIEWTYPE-COMPARISON</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Both view types supported</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">MultiChannel Request:
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 1, <span class="code-quote">"max"</span>: 10},
  <span class="code-quote">"view_type"</span>: 0
}
Expected: stream_amount &gt; 1, multiple mappings

SingleChannel Request:
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 5, <span class="code-quote">"max"</span>: 5},
  <span class="code-quote">"view_type"</span>: 1
}
Expected: stream_amount = 1, single mapping</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure MultiChannel</td>
<td class='confluenceTd'>channels 1-10</td>
<td class='confluenceTd'>stream_amount &gt; 1</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Count mappings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>len(mapping) = 10</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Configure SingleChannel</td>
<td class='confluenceTd'>channel 5 only</td>
<td class='confluenceTd'>stream_amount = 1</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Count mappings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>len(mapping) = 1</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Compare results</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Clear difference</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>MultiChannel returns multiple streams</li>
	<li>SingleChannel returns one stream</li>
	<li>Mapping counts differ</li>
	<li>Behavior clearly distinct</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Two jobs created with different configs</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># MultiChannel request
</span>multi_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 1, <span class="code-quote">"<span class="code-object">max</span>"</span>: 10},
    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=0  <span class="code-comment"># MULTICHANNEL
</span>)

multi_response = focus_server_api.configure(multi_request)

<span class="code-keyword">assert</span> multi_response.stream_amount &gt; 1
<span class="code-keyword">assert</span> <span class="code-object">len</span>(multi_response.channel_to_stream_index) == 10

logger.info(f<span class="code-quote">"MultiChannel: {multi_response.stream_amount} streams, {<span class="code-object">len</span>(multi_response.channel_to_stream_index)} mappings"</span>)

<span class="code-comment"># SingleChannel request
</span>single_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 5, <span class="code-quote">"<span class="code-object">max</span>"</span>: 5},
    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

single_response = focus_server_api.configure(single_request)

<span class="code-keyword">assert</span> single_response.stream_amount == 1
<span class="code-keyword">assert</span> <span class="code-object">len</span>(single_response.channel_to_stream_index) == 1

logger.info(f<span class="code-quote">"SingleChannel: {single_response.stream_amount} stream, {<span class="code-object">len</span>(single_response.channel_to_stream_index)} mapping"</span>)

<span class="code-comment"># Verify difference
</span><span class="code-keyword">assert</span> multi_response.stream_amount != single_response.stream_amount
<span class="code-keyword">assert</span> <span class="code-object">len</span>(multi_response.channel_to_stream_index) != <span class="code-object">len</span>(single_response.channel_to_stream_index)

logger.info(<span class="code-quote">"✅ SingleChannel vs MultiChannel behavior distinct"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_singlechannel_vs_multichannel_comparison</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13817]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13817">API – Same SingleChannel Returns Consistent Mapping Across Multiple Requests</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43353-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43353-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – Same SingleChannel Returns Consistent Mapping Across Multiple Requests</p>

<p><b>Objective:</b> Verify that requesting the same single channel multiple times returns consistent mapping.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, consistency, idempotency</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-IDEMPOTENCY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Focus Server API accessible</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Request (repeated 3 times):
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 25, <span class="code-quote">"max"</span>: 25},
  <span class="code-quote">"view_type"</span>: 1
}

Expected: All 3 responses identical mapping:
{<span class="code-quote">"25"</span>: 0}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure channel 25 (1st)</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>mapping=
{"25": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Configure channel 25 (2nd)</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>mapping=
{"25": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Configure channel 25 (3rd)</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>mapping=
{"25": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Compare all mappings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All identical</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify consistency</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Passed</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All 3 requests return same mapping</li>
	<li>Consistent behavior across calls</li>
	<li>No randomness or drift</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>3 jobs created (may be different job_ids)</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">channel = 25
mappings = []

<span class="code-keyword">for</span> i <span class="code-keyword">in</span> <span class="code-object">range</span>(3):
    config_request = ConfigureRequest(
        displayTimeAxisDuration=10,
        nfftSelection=1024,
        displayInfo={<span class="code-quote">"height"</span>: 1000},
        channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: channel, <span class="code-quote">"<span class="code-object">max</span>"</span>: channel},
        frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
        view_type=ViewType.SINGLECHANNEL
    )
    
    response = focus_server_api.configure(config_request)
    mapping = response.channel_to_stream_index
    
    <span class="code-keyword">assert</span> <span class="code-object">str</span>(channel) <span class="code-keyword">in</span> mapping
    <span class="code-keyword">assert</span> mapping[<span class="code-object">str</span>(channel)] == 0
    
    mappings.append(mapping)
    logger.info(f<span class="code-quote">"Request {i+1}: mapping = {mapping}"</span>)

<span class="code-comment"># Verify <span class="code-object">all</span> mappings are identical
</span><span class="code-keyword">for</span> mapping <span class="code-keyword">in</span> mappings:
    <span class="code-keyword">assert</span> mapping == mappings[0], <span class="code-quote">"Inconsistent mappings!"</span>

logger.info(<span class="code-quote">"✅ Same channel returns consistent mapping"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_same_channel_multiple_requests_consistent_mapping</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13816]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13816">API – Different SingleChannels Return Different Mappings</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43352-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43352-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – Different SingleChannels Return Different Mappings</p>

<p><b>Objective:</b> Verify that requesting different single channels returns distinct channel_to_stream_index entries.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, mapping-consistency</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-CONSISTENCY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Focus Server API accessible</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Test 1: {<span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 5, <span class="code-quote">"max"</span>: 5}}
Test 2: {<span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 10, <span class="code-quote">"max"</span>: 10}}
Test 3: {<span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 50, <span class="code-quote">"max"</span>: 50}}

Expected:
- Test 1: {<span class="code-quote">"5"</span>: 0}
- Test 2: {<span class="code-quote">"10"</span>: 0}
- Test 3: {<span class="code-quote">"50"</span>: 0}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure channel 5</td>
<td class='confluenceTd'>min=max=5</td>
<td class='confluenceTd'>mapping=
{"5": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Configure channel 10</td>
<td class='confluenceTd'>min=max=10</td>
<td class='confluenceTd'>mapping=
{"10": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Configure channel 50</td>
<td class='confluenceTd'>min=max=50</td>
<td class='confluenceTd'>mapping=
{"50": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Compare mappings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All different channels</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify consistency</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All map to stream 0</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Each channel gets correct mapping</li>
	<li>Channel key differs in each response</li>
	<li>Stream index always 0 for SingleChannel</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Multiple jobs created</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">test_channels = [5, 10, 50]
mappings = []

<span class="code-keyword">for</span> channel <span class="code-keyword">in</span> test_channels:
    config_request = ConfigureRequest(
        displayTimeAxisDuration=10,
        nfftSelection=1024,
        displayInfo={<span class="code-quote">"height"</span>: 1000},
        channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: channel, <span class="code-quote">"<span class="code-object">max</span>"</span>: channel},
        frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
        view_type=ViewType.SINGLECHANNEL
    )
    
    response = focus_server_api.configure(config_request)
    
    <span class="code-keyword">assert</span> <span class="code-object">str</span>(channel) <span class="code-keyword">in</span> response.channel_to_stream_index
    <span class="code-keyword">assert</span> response.channel_to_stream_index[<span class="code-object">str</span>(channel)] == 0
    
    mappings.append(response.channel_to_stream_index)
    logger.info(f<span class="code-quote">"Channel {channel}: mapping = {response.channel_to_stream_index}"</span>)

<span class="code-comment"># Verify <span class="code-object">all</span> mappings are different (different channel keys)
</span><span class="code-keyword">assert</span> <span class="code-object">len</span>(<span class="code-object">set</span>(<span class="code-object">str</span>(m) <span class="code-keyword">for</span> m <span class="code-keyword">in</span> mappings)) == <span class="code-object">len</span>(mappings)

logger.info(<span class="code-quote">"✅ Different channels <span class="code-keyword">return</span> different mappings"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_different_channels_different_mappings</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13815]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13815">API – SingleChannel View for Channel 100 (Upper Boundary Test)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43351-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43351-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel View for Channel 100 (Upper Boundary Test)</p>

<p><b>Objective:</b> Verify SingleChannel view works correctly for channel 100 (upper boundary or high channel number).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, boundary-test</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-BOUNDARY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Focus Server supports channel 100</li>
	<li>PC-002: Max channels &gt;= 100</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">POST /configure
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 100, <span class="code-quote">"max"</span>: 100},
  <span class="code-quote">"view_type"</span>: 1,
  ...
}

Expected:
{
  <span class="code-quote">"stream_amount"</span>: 1,
  <span class="code-quote">"channel_to_stream_index"</span>: {<span class="code-quote">"100"</span>: 0}
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request</td>
<td class='confluenceTd'>channel 100</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate mapping</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>{"100": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify no overflow</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Channel 100 works correctly</li>
	<li>No overflow or boundary errors</li>
	<li>Correct mapping</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Job created for channel 100</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 100, <span class="code-quote">"<span class="code-object">max</span>"</span>: 100},  <span class="code-comment"># Channel 100 (upper boundary)
</span>    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

response = focus_server_api.configure(config_request)

<span class="code-keyword">assert</span> response.stream_amount == 1
<span class="code-keyword">assert</span> <span class="code-quote">"100"</span> <span class="code-keyword">in</span> response.channel_to_stream_index
<span class="code-keyword">assert</span> response.channel_to_stream_index[<span class="code-quote">"100"</span>] == 0

logger.info(<span class="code-quote">"✅ SingleChannel works <span class="code-keyword">for</span> channel 100 (upper boundary)"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_configure_singlechannel_channel_100</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13814]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13814">API – SingleChannel View for Channel 1 (First Channel)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43350-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43350-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel View for Channel 1 (First Channel)</p>

<p><b>Objective:</b> Verify SingleChannel view works correctly for channel 1 (lower boundary test).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, singlechannel, boundary-test</p>

<p><b>Requirements:</b> FOCUS-SINGLECHANNEL-BOUNDARY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Focus Server API accessible</li>
	<li>PC-002: Channel 1 valid (first channel)</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">POST /configure
{
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 1, <span class="code-quote">"max"</span>: 1},
  <span class="code-quote">"view_type"</span>: 1,
  ...
}

Expected:
{
  <span class="code-quote">"stream_amount"</span>: 1,
  <span class="code-quote">"channel_to_stream_index"</span>: {<span class="code-quote">"1"</span>: 0},
  <span class="code-quote">"channel_amount"</span>: 1
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create request</td>
<td class='confluenceTd'>channel 1</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate stream_amount</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>== 1</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Validate mapping</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>{"1": 0}</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check no errors</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Channel 1 works as SingleChannel</li>
	<li>Correct mapping returned</li>
	<li>No boundary errors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Job created for channel 1</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 1, <span class="code-quote">"<span class="code-object">max</span>"</span>: 1},  <span class="code-comment"># Channel 1 (lower boundary)
</span>    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    view_type=ViewType.SINGLECHANNEL
)

response = focus_server_api.configure(config_request)

<span class="code-keyword">assert</span> response.stream_amount == 1
<span class="code-keyword">assert</span> <span class="code-object">len</span>(response.channel_to_stream_index) == 1
<span class="code-keyword">assert</span> <span class="code-quote">"1"</span> <span class="code-keyword">in</span> response.channel_to_stream_index
<span class="code-keyword">assert</span> response.channel_to_stream_index[<span class="code-quote">"1"</span>] == 0

logger.info(<span class="code-quote">"✅ SingleChannel works <span class="code-keyword">for</span> channel 1 (lower boundary)"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_configure_singlechannel_channel_1</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13813]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13813">API – SingleChannel View Returns Correct 1:1 Mapping</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43349-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43349-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – SingleChannel View Returns Correct 1:1 Mapping</p>

<p><b>Objective:</b> Validate that view_type=SINGLECHANNEL returns exactly one stream with correct 1:1 channel-to-stream mapping for the requested channel.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, api, view-type, singlechannel, mapping</p>

<p><b>Requirements:</b> FOCUS-API-VIEWTYPE, FOCUS-SINGLECHANNEL</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Focus Server API accessible</li>
	<li>PC-002: /configure endpoint available</li>
	<li>PC-003: view_type=1 (SINGLECHANNEL) supported</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">POST /configure
{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 7, <span class="code-quote">"max"</span>: 7},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 1
}

Expected Response:
{
  <span class="code-quote">"job_id"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"stream_amount"</span>: 1,
  <span class="code-quote">"stream_port"</span>: <span class="code-quote">"integer"</span>,
  <span class="code-quote">"stream_url"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"channel_to_stream_index"</span>: {<span class="code-quote">"7"</span>: 0},
  <span class="code-quote">"channel_amount"</span>: 1,
  <span class="code-quote">"frequencies_list"</span>: [...],
  <span class="code-quote">"frequencies_amount"</span>: <span class="code-quote">"integer"</span>,
  <span class="code-quote">"lines_dt"</span>: <span class="code-quote">"number"</span>,
  <span class="code-quote">"status"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"view_type"</span>: 1
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create ConfigureRequest</td>
<td class='confluenceTd'>view_type=1, channels=
{min:7,max:7}</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>Request payload</td>
<td class='confluenceTd'>HTTP 200 OK</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate response schema</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Valid ConfigureResponse</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check stream_amount</td>
<td class='confluenceTd'>response.stream_amount</td>
<td class='confluenceTd'>== 1</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check channel_to_stream_index size</td>
<td class='confluenceTd'>len(mapping)</td>
<td class='confluenceTd'>== 1</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify mapping entry</td>
<td class='confluenceTd'>mapping<span class="error">&#91;&quot;7&quot;&#93;</span></td>
<td class='confluenceTd'>== 0</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Check channel_amount</td>
<td class='confluenceTd'>response.channel_amount</td>
<td class='confluenceTd'>== 1</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify no extra channels</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Only channel 7</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Validate view_type</td>
<td class='confluenceTd'>response.view_type</td>
<td class='confluenceTd'>== 1</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Configuration accepted (HTTP 200)</li>
	<li>Exactly one stream created (stream_amount=1)</li>
	<li>Single mapping: channel "7" → stream index 0</li>
	<li>No extraneous channels in mapping</li>
	<li>view_type returned as 1 (SINGLECHANNEL)</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Job created with correct configuration</li>
	<li>Baby Analyzer initialized for single channel</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">from</span> src.models.focus_server_models <span class="code-keyword">import</span> ConfigureRequest, ConfigureResponse, ViewType

<span class="code-comment"># Create request
</span>config_request = ConfigureRequest(
    displayTimeAxisDuration=10,
    nfftSelection=1024,
    displayInfo={<span class="code-quote">"height"</span>: 1000},
    channels={<span class="code-quote">"<span class="code-object">min</span>"</span>: 7, <span class="code-quote">"<span class="code-object">max</span>"</span>: 7},  <span class="code-comment"># Single channel
</span>    frequencyRange={<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 500},
    start_time=<span class="code-keyword"><span class="code-object">None</span></span>,
    end_time=<span class="code-keyword"><span class="code-object">None</span></span>,
    view_type=ViewType.SINGLECHANNEL  <span class="code-comment"># view_type = 1
</span>)

<span class="code-comment"># Send request
</span>response = focus_server_api.configure(config_request)

<span class="code-comment"># Validate response
</span><span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(response, ConfigureResponse)
<span class="code-keyword">assert</span> response.stream_amount == 1, f<span class="code-quote">"Expected 1 stream, got {response.stream_amount}"</span>

<span class="code-comment"># Validate mapping
</span>channel_mapping = response.channel_to_stream_index
<span class="code-keyword">assert</span> <span class="code-object">len</span>(channel_mapping) == 1, f<span class="code-quote">"Expected 1 mapping, got {<span class="code-object">len</span>(channel_mapping)}"</span>
<span class="code-keyword">assert</span> <span class="code-quote">"7"</span> <span class="code-keyword">in</span> channel_mapping, <span class="code-quote">"Channel 7 <span class="code-keyword">not</span> <span class="code-keyword">in</span> mapping"</span>
<span class="code-keyword">assert</span> channel_mapping[<span class="code-quote">"7"</span>] == 0, f<span class="code-quote">"Expected stream 0, got {channel_mapping[<span class="code-quote">'7'</span>]}"</span>

<span class="code-comment"># Validate channel amount
</span><span class="code-keyword">assert</span> response.channel_amount == 1, f<span class="code-quote">"Expected 1 channel, got {response.channel_amount}"</span>

<span class="code-comment"># Validate view <span class="code-object">type</span>
</span><span class="code-keyword">assert</span> response.view_type == 1, f<span class="code-quote">"Expected view_type=1, got {response.view_type}"</span>

logger.info(<span class="code-quote">"✅ SingleChannel mapping correct <span class="code-keyword">for</span> channel 7"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_configure_singlechannel_mapping</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13812]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13812">Data Quality – Verify Recordings Have Complete Metadata</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43348-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43348-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Data Quality – Verify Recordings Have Complete Metadata</p>

<p><b>Objective:</b> Confirm recordings have all required metadata fields populated (not null/empty).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> mongodb, data-quality, metadata</p>

<p><b>Requirements:</b> FOCUS-MONGO-METADATA</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: recordings collection accessible</li>
	<li>PC-002: Sample size &gt;= 10 recordings</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Required Non-Empty Fields:
[
  <span class="code-quote">"uuid"</span>,
  <span class="code-quote">"start_time"</span>,
  <span class="code-quote">"end_time"</span>,
  <span class="code-quote">"path"</span>,
  <span class="code-quote">"node"</span>
]</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to MongoDB</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Query 10 recent recordings</td>
<td class='confluenceTd'>limit=10</td>
<td class='confluenceTd'>Recordings retrieved</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>For each recording</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Check all fields</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify uuid not empty</td>
<td class='confluenceTd'>uuid != ""</td>
<td class='confluenceTd'>True for all</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify times not zero</td>
<td class='confluenceTd'>start_time &gt; 0</td>
<td class='confluenceTd'>True for all</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify path not empty</td>
<td class='confluenceTd'>path != ""</td>
<td class='confluenceTd'>True for all</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Count complete records</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All 10 complete</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All sampled recordings have complete metadata</li>
	<li>No null or empty required fields</li>
	<li>High data quality</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>None</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">client = MongoClient(host=<span class="code-quote">"10.10.100.108"</span>, port=27017,
                     username=<span class="code-quote">"prisma"</span>, password=<span class="code-quote">"prisma"</span>)
db = client[<span class="code-quote">"prisma"</span>]
recordings = db[<span class="code-quote">"recordings"</span>]

<span class="code-comment"># Get sample
</span>sample = <span class="code-object">list</span>(recordings.find().sort(<span class="code-quote">"start_time"</span>, -1).limit(10))

<span class="code-keyword">assert</span> <span class="code-object">len</span>(sample) &gt;= 10, f<span class="code-quote">"Not enough recordings: {<span class="code-object">len</span>(sample)}"</span>

required_fields = [<span class="code-quote">"uuid"</span>, <span class="code-quote">"start_time"</span>, <span class="code-quote">"end_time"</span>, <span class="code-quote">"path"</span>]

<span class="code-keyword">for</span> idx, rec <span class="code-keyword">in</span> <span class="code-object">enumerate</span>(sample, 1):
    logger.info(f<span class="code-quote">"Checking recording {idx}/{<span class="code-object">len</span>(sample)}"</span>)
    
    <span class="code-keyword">for</span> field <span class="code-keyword">in</span> required_fields:
        value = rec.get(field)
        <span class="code-keyword">assert</span> value <span class="code-keyword">is</span> <span class="code-keyword">not</span> <span class="code-keyword"><span class="code-object">None</span></span>, f<span class="code-quote">"Field <span class="code-quote">'{field}'</span> <span class="code-keyword">is</span> <span class="code-keyword"><span class="code-object">None</span></span>"</span>
        <span class="code-keyword">assert</span> value != <span class="code-quote">"", f"</span>Field <span class="code-quote">'{field}'</span> <span class="code-keyword">is</span> empty"
        
        <span class="code-keyword">if</span> field <span class="code-keyword">in</span> [<span class="code-quote">"start_time"</span>, <span class="code-quote">"end_time"</span>]:
            <span class="code-keyword">assert</span> value &gt; 0, f<span class="code-quote">"Field <span class="code-quote">'{field}'</span> <span class="code-keyword">is</span> zero"</span>

logger.info(<span class="code-quote">"✅ All recordings have complete metadata"</span>)
client.close()</pre>
</div></div>

<p><b>Environment:</b> Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_recordings_have_all_required_metadata</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_mongodb_data_quality.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13811]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13811">Data Quality – Validate Recordings Document Schema</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43347-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43347-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Data Quality – Validate Recordings Document Schema</p>

<p><b>Objective:</b> Verify recordings in MongoDB have all required fields with correct data types.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> mongodb, data-quality, schema, recordings</p>

<p><b>Requirements:</b> FOCUS-MONGO-SCHEMA</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: recordings collection has data</li>
	<li>PC-002: At least one recording exists</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Required Recording Fields:
{
  <span class="code-quote">"uuid"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"start_time"</span>: <span class="code-quote">"number (epoch)"</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-quote">"number (epoch)"</span>,
  <span class="code-quote">"path"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"node"</span>: <span class="code-quote">"string"</span>,
  <span class="code-quote">"sensor_min"</span>: <span class="code-quote">"number"</span>,
  <span class="code-quote">"sensor_max"</span>: <span class="code-quote">"number"</span>
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to MongoDB</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Query recent recording</td>
<td class='confluenceTd'>limit=1, sort=-start_time</td>
<td class='confluenceTd'>Recording found</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify uuid field</td>
<td class='confluenceTd'>type(doc<span class="error">&#91;&quot;uuid&quot;&#93;</span>)</td>
<td class='confluenceTd'>str</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify start_time</td>
<td class='confluenceTd'>type(doc<span class="error">&#91;&quot;start_time&quot;&#93;</span>)</td>
<td class='confluenceTd'>int/float</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify end_time</td>
<td class='confluenceTd'>type(doc<span class="error">&#91;&quot;end_time&quot;&#93;</span>)</td>
<td class='confluenceTd'>int/float</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify path</td>
<td class='confluenceTd'>type(doc<span class="error">&#91;&quot;path&quot;&#93;</span>)</td>
<td class='confluenceTd'>str</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Check start &lt; end</td>
<td class='confluenceTd'>start_time &lt; end_time</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Validate all required fields</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All present</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Recording has all required fields</li>
	<li>Field types correct</li>
	<li>start_time &lt; end_time</li>
	<li>uuid is valid string</li>
	<li>path is valid file path</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>None</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">client = MongoClient(host=<span class="code-quote">"10.10.100.108"</span>, port=27017,
                     username=<span class="code-quote">"prisma"</span>, password=<span class="code-quote">"prisma"</span>)
db = client[<span class="code-quote">"prisma"</span>]
recordings = db[<span class="code-quote">"recordings"</span>]

<span class="code-comment"># Get one recording
</span>recording = recordings.find_one(sort=[(<span class="code-quote">"start_time"</span>, -1)])

<span class="code-keyword">assert</span> recording <span class="code-keyword">is</span> <span class="code-keyword">not</span> <span class="code-keyword"><span class="code-object">None</span></span>, <span class="code-quote">"No recordings found"</span>

<span class="code-comment"># Validate schema
</span>required_fields = [<span class="code-quote">"uuid"</span>, <span class="code-quote">"start_time"</span>, <span class="code-quote">"end_time"</span>, <span class="code-quote">"path"</span>]

<span class="code-keyword">for</span> field <span class="code-keyword">in</span> required_fields:
    <span class="code-keyword">assert</span> field <span class="code-keyword">in</span> recording, f<span class="code-quote">"Missing field: {field}"</span>
    logger.info(f<span class="code-quote">"✓ Field <span class="code-quote">'{field}'</span> present"</span>)

<span class="code-comment"># Validate types
</span><span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(recording[<span class="code-quote">"uuid"</span>], <span class="code-object">str</span>)
<span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(recording[<span class="code-quote">"start_time"</span>], (<span class="code-object">int</span>, <span class="code-object">float</span>))
<span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(recording[<span class="code-quote">"end_time"</span>], (<span class="code-object">int</span>, <span class="code-object">float</span>))
<span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(recording[<span class="code-quote">"path"</span>], <span class="code-object">str</span>)

<span class="code-comment"># Validate logic
</span><span class="code-keyword">assert</span> recording[<span class="code-quote">"start_time"</span>] &lt; recording[<span class="code-quote">"end_time"</span>], <span class="code-quote">"Invalid time <span class="code-object">range</span>"</span>

logger.info(<span class="code-quote">"✅ Recording schema valid"</span>)
client.close()</pre>
</div></div>

<p><b>Environment:</b> Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_recording_schema_validation</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_mongodb_data_quality.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13810]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13810">Data Quality – Verify Critical MongoDB Indexes Exist</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43346-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43346-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Data Quality – Verify Critical MongoDB Indexes Exist</p>

<p><b>Objective:</b> Confirm performance-critical indexes exist on recordings collection.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> mongodb, indexes, performance</p>

<p><b>Requirements:</b> FOCUS-MONGO-INDEXES</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: recordings collection exists</li>
	<li>PC-002: Index creation completed</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Required Indexes on <span class="code-quote">"recordings"</span>:
[
  {<span class="code-quote">"field"</span>: <span class="code-quote">"start_time"</span>, <span class="code-quote">"type"</span>: <span class="code-quote">"ascending"</span>},
  {<span class="code-quote">"field"</span>: <span class="code-quote">"end_time"</span>, <span class="code-quote">"type"</span>: <span class="code-quote">"ascending"</span>},
  {<span class="code-quote">"field"</span>: <span class="code-quote">"uuid"</span>, <span class="code-quote">"type"</span>: <span class="code-quote">"ascending"</span>},
  {<span class="code-quote">"field"</span>: <span class="code-quote">"_id"</span>, <span class="code-quote">"type"</span>: <span class="code-quote">"ascending"</span>}
]</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to MongoDB</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Get recordings collection</td>
<td class='confluenceTd'>db<span class="error">&#91;&quot;recordings&quot;&#93;</span></td>
<td class='confluenceTd'>Collection object</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>List indexes</td>
<td class='confluenceTd'>collection.list_indexes()</td>
<td class='confluenceTd'>Index list</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify start_time index</td>
<td class='confluenceTd'>"start_time_1" in indexes</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify end_time index</td>
<td class='confluenceTd'>"end_time_1" in indexes</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify uuid index</td>
<td class='confluenceTd'>"uuid_1" in indexes</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Log index details</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>All indexes logged</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>start_time index exists</li>
	<li>end_time index exists</li>
	<li>uuid index exists</li>
	<li>All indexes are ascending</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>None</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">client = MongoClient(host=<span class="code-quote">"10.10.100.108"</span>, port=27017,
                     username=<span class="code-quote">"prisma"</span>, password=<span class="code-quote">"prisma"</span>)
db = client[<span class="code-quote">"prisma"</span>]
collection = db[<span class="code-quote">"recordings"</span>]

<span class="code-comment"># Get indexes
</span>indexes = <span class="code-object">list</span>(collection.list_indexes())
index_names = [idx[<span class="code-quote">'name'</span>] <span class="code-keyword">for</span> idx <span class="code-keyword">in</span> indexes]

logger.info(f<span class="code-quote">"Found {<span class="code-object">len</span>(indexes)} indexes:"</span>)
<span class="code-keyword">for</span> idx <span class="code-keyword">in</span> indexes:
    logger.info(f<span class="code-quote">"  - {idx[<span class="code-quote">'name'</span>]}: {idx[<span class="code-quote">'key'</span>]}"</span>)

<span class="code-comment"># Verify required indexes
</span>required_indexes = [<span class="code-quote">"start_time_1"</span>, <span class="code-quote">"end_time_1"</span>, <span class="code-quote">"uuid_1"</span>]

<span class="code-keyword">for</span> idx_name <span class="code-keyword">in</span> required_indexes:
    <span class="code-keyword">assert</span> idx_name <span class="code-keyword">in</span> index_names, f<span class="code-quote">"Missing index: {idx_name}"</span>
    logger.info(f<span class="code-quote">"✓ Index <span class="code-quote">'{idx_name}'</span> exists"</span>)

logger.info(<span class="code-quote">"✅ All critical indexes exist"</span>)
client.close()</pre>
</div></div>

<p><b>Environment:</b> Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_mongodb_indexes_exist_and_optimal</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_mongodb_data_quality.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13809]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13809">Data Quality – Verify Required MongoDB Collections Exist</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43345-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43345-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Data Quality – Verify Required MongoDB Collections Exist</p>

<p><b>Objective:</b> Confirm all required MongoDB collections exist for Focus Server operation.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> mongodb, data-quality, collections</p>

<p><b>Requirements:</b> FOCUS-MONGO-SCHEMA</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: MongoDB accessible</li>
	<li>PC-002: Database "prisma" exists</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Required Collections:
[
  <span class="code-quote">"recordings"</span>,
  <span class="code-quote">"node4"</span>,
  <span class="code-quote">"tasks"</span>,
  <span class="code-quote">"jobs"</span>
]</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to MongoDB</td>
<td class='confluenceTd'>database="prisma"</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>List collections</td>
<td class='confluenceTd'>db.list_collection_names()</td>
<td class='confluenceTd'>Collection list</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify "recordings"</td>
<td class='confluenceTd'>"recordings" in collections</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify "node4"</td>
<td class='confluenceTd'>"node4" in collections</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify "tasks"</td>
<td class='confluenceTd'>"tasks" in collections</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify "jobs"</td>
<td class='confluenceTd'>"jobs" in collections</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Check collection counts</td>
<td class='confluenceTd'>db<span class="error">&#91;col&#93;</span>.count_documents({})</td>
<td class='confluenceTd'><blockquote><p>= 0 </p></blockquote></td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All required collections exist</li>
	<li>Collections are accessible</li>
	<li>No permission errors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>None</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">client = MongoClient(host=<span class="code-quote">"10.10.100.108"</span>, port=27017,
                     username=<span class="code-quote">"prisma"</span>, password=<span class="code-quote">"prisma"</span>)
db = client[<span class="code-quote">"prisma"</span>]

collections = db.list_collection_names()

required_collections = [<span class="code-quote">"recordings"</span>, <span class="code-quote">"node4"</span>, <span class="code-quote">"tasks"</span>, <span class="code-quote">"jobs"</span>]

<span class="code-keyword">for</span> col_name <span class="code-keyword">in</span> required_collections:
    <span class="code-keyword">assert</span> col_name <span class="code-keyword">in</span> collections, f<span class="code-quote">"Collection <span class="code-quote">'{col_name}'</span> <span class="code-keyword">not</span> found"</span>
    logger.info(f<span class="code-quote">"✓ Collection <span class="code-quote">'{col_name}'</span> exists"</span>)
    
    <span class="code-comment"># Check accessible
</span>    count = db[col_name].count_documents({})
    logger.info(f<span class="code-quote">"  Documents: {count}"</span>)

logger.info(<span class="code-quote">"✅ All required collections exist"</span>)
client.close()</pre>
</div></div>

<p><b>Environment:</b> Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_required_collections_exist</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_mongodb_data_quality.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13808]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13808">Infrastructure – MongoDB Quick Response Time Test (Performance)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43344-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43344-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Infrastructure – MongoDB Quick Response Time Test</p>

<p><b>Objective:</b> Verify MongoDB responds to ping within acceptable time limit (&lt;100ms).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> mongodb, performance, latency</p>

<p><b>Requirements:</b> FOCUS-MONGO-PERFORMANCE</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: MongoDB accessible</li>
	<li>PC-002: Normal load conditions</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Performance Criteria:
{
  <span class="code-quote">"max_response_time_ms"</span>: 100,
  <span class="code-quote">"acceptable_response_time_ms"</span>: 50
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to MongoDB</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Record start time</td>
<td class='confluenceTd'>time.time()</td>
<td class='confluenceTd'>Timestamp captured</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send ping command</td>
<td class='confluenceTd'>client.admin.command('ping')</td>
<td class='confluenceTd'>Response received</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Record end time</td>
<td class='confluenceTd'>time.time()</td>
<td class='confluenceTd'>Timestamp captured</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Calculate latency</td>
<td class='confluenceTd'>(end - start) * 1000</td>
<td class='confluenceTd'>Latency in ms</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify latency</td>
<td class='confluenceTd'>latency &lt; 100ms</td>
<td class='confluenceTd'>Pass if under threshold</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Log result</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Latency logged</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Ping response time &lt; 100ms</li>
	<li>Ideally &lt; 50ms</li>
	<li>Consistent performance</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Connection closed</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">import</span> time

client = MongoClient(host=<span class="code-quote">"10.10.100.108"</span>, port=27017)

<span class="code-comment"># Measure ping time
</span>start_time = time.time()
ping_result = client.admin.command(<span class="code-quote">'ping'</span>)
end_time = time.time()

latency_ms = (end_time - start_time) * 1000

<span class="code-keyword">assert</span> ping_result[<span class="code-quote">'ok'</span>] == 1.0
<span class="code-keyword">assert</span> latency_ms &lt; 100, f<span class="code-quote">"MongoDB ping too slow: {latency_ms:.2f}ms"</span>

logger.info(f<span class="code-quote">"✅ MongoDB ping: {latency_ms:.2f}ms"</span>)

<span class="code-keyword">if</span> latency_ms &lt; 50:
    logger.info(<span class="code-quote">"⚡ Excellent latency!"</span>)
<span class="code-keyword">elif</span> latency_ms &lt; 100:
    logger.info(<span class="code-quote">"✓ Acceptable latency"</span>)

client.close()</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_quick_mongodb_ping</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_basic_connectivity.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13807]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13807">Infrastructure – MongoDB Connection Using Focus Server Config</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43343-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43343-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Infrastructure – MongoDB Connection Using Focus Server Config</p>

<p><b>Objective:</b> Verify MongoDB connection works using Focus Server's ConfigManager for consistent configuration across application.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, mongodb, config-manager</p>

<p><b>Requirements:</b> FOCUS-CONFIG-MONGODB</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: ConfigManager configured</li>
	<li>PC-002: MongoDB config in environments.yaml</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-yaml">new_<span class="code-keyword">production: </span>  <span class="code-keyword">mongodb: </span>    <span class="code-keyword">host: </span><span class="code-quote">"<span class="code-object">10</span>.<span class="code-object">10</span>.<span class="code-object">100</span>.<span class="code-object">108</span>"</span>
    <span class="code-keyword">port: </span><span class="code-object">27017</span>
    <span class="code-keyword">username: </span><span class="code-quote">"username"</span>
    <span class="code-keyword">password: </span><span class="code-quote">"password"</span>
    <span class="code-keyword">database: </span><span class="code-quote">"prisma"</span>
    auth_<span class="code-keyword">source: </span><span class="code-quote">"prisma"</span></pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Initialize ConfigManager</td>
<td class='confluenceTd'>env="new_production"</td>
<td class='confluenceTd'>Manager created</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Get database config</td>
<td class='confluenceTd'>get_database_config()</td>
<td class='confluenceTd'>Config dict returned</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify host</td>
<td class='confluenceTd'>config<span class="error">&#91;&quot;host&quot;&#93;</span></td>
<td class='confluenceTd'>"10.10.100.108"</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify port</td>
<td class='confluenceTd'>config<span class="error">&#91;&quot;port&quot;&#93;</span></td>
<td class='confluenceTd'>27017</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Create MongoDB client</td>
<td class='confluenceTd'>Using config</td>
<td class='confluenceTd'>Client created</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Test connection</td>
<td class='confluenceTd'>ping</td>
<td class='confluenceTd'>Success</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>ConfigManager loads MongoDB config correctly</li>
	<li>All connection parameters accurate</li>
	<li>Connection successful using config</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Connection closed</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">config_manager = ConfigManager(<span class="code-quote">"new_production"</span>)
mongo_config = config_manager.get_database_config()

<span class="code-keyword">assert</span> mongo_config[<span class="code-quote">"host"</span>] == <span class="code-quote">"10.10.100.108"</span>
<span class="code-keyword">assert</span> mongo_config[<span class="code-quote">"port"</span>] == 27017
<span class="code-keyword">assert</span> mongo_config[<span class="code-quote">"username"</span>] == <span class="code-quote">"username"</span>
<span class="code-keyword">assert</span> mongo_config[<span class="code-quote">"database"</span>] == <span class="code-quote">"database"</span>

<span class="code-comment"># Test connection <span class="code-keyword">with</span> config
</span>client = MongoClient(**mongo_config)
ping_result = client.admin.command(<span class="code-quote">'ping'</span>)
<span class="code-keyword">assert</span> ping_result[<span class="code-quote">'ok'</span>] == 1.0

client.close()
logger.info(<span class="code-quote">"✅ MongoDB connection via ConfigManager works"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_mongodb_connection</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_basic_connectivity.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13806]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13806">Infrastructure – MongoDB Direct TCP Connection and Authentication</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43342-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            infrastructure_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43342-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Infrastructure – MongoDB Direct TCP Connection and Authentication</p>

<p><b>Objective:</b> Verify Focus Server can establish direct TCP connection to MongoDB server, authenticate successfully, and execute basic ping command.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, mongodb, infrastructure, database, connectivity</p>

<p><b>Requirements:</b> FOCUS-INFRA-MONGODB, FOCUS-DB-CONNECTION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: MongoDB server running at configured host/port</li>
	<li>PC-002: MongoDB credentials configured (username/password)</li>
	<li>PC-003: Authentication database accessible</li>
	<li>PC-004: pymongo client library installed</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">MongoDB Configuration:
{
  <span class="code-quote">"host"</span>: <span class="code-quote">"10.10.100.108"</span>,
  <span class="code-quote">"port"</span>: 27017,
  <span class="code-quote">"username"</span>: <span class="code-quote">"username"</span>,
  <span class="code-quote">"password"</span>: <span class="code-quote">"password"</span>,
  <span class="code-quote">"auth_source"</span>: <span class="code-quote">"prisma"</span>,
  <span class="code-quote">"database"</span>: <span class="code-quote">"prisma"</span>,
  <span class="code-quote">"connection_timeout_ms"</span>: 10000,
  <span class="code-quote">"server_selection_timeout_ms"</span>: 10000
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Load MongoDB config</td>
<td class='confluenceTd'>ConfigManager("new_production")</td>
<td class='confluenceTd'>Config loaded</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Create MongoClient</td>
<td class='confluenceTd'>host, port, credentials</td>
<td class='confluenceTd'>Client created</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Establish TCP connection</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connection established</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Authenticate</td>
<td class='confluenceTd'>authSource="prisma"</td>
<td class='confluenceTd'>Authentication success</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send ping command</td>
<td class='confluenceTd'>client.admin.command('ping')</td>
<td class='confluenceTd'>{'ok': 1.0}</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Get server info</td>
<td class='confluenceTd'>client.server_info()</td>
<td class='confluenceTd'>Version returned</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>List databases</td>
<td class='confluenceTd'>client.list_database_names()</td>
<td class='confluenceTd'>Database list returned</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Verify prisma DB exists</td>
<td class='confluenceTd'>"prisma" in db_list</td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Close connection</td>
<td class='confluenceTd'>client.close()</td>
<td class='confluenceTd'>Clean disconnect</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>TCP connection to MongoDB successful</li>
	<li>Authentication passes with prisma/prisma credentials</li>
	<li>Ping command returns 
{'ok': 1.0}</li>
	<li>Server version retrieved (e.g., "7.0.5")</li>
	<li>Database list includes "prisma"</li>
	<li>Connection closes cleanly without errors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>MongoDB connection closed</li>
	<li>No hanging connections</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">from</span> pymongo <span class="code-keyword">import</span> MongoClient
<span class="code-keyword">from</span> pymongo.errors <span class="code-keyword">import</span> ConnectionFailure, ServerSelectionTimeoutError

config_manager = ConfigManager(<span class="code-quote">"new_production"</span>)
mongo_config = config_manager.get_database_config()

<span class="code-comment"># Create client
</span>client = MongoClient(
    host=mongo_config[<span class="code-quote">"host"</span>],  <span class="code-comment"># 10.10.100.108
</span>    port=mongo_config[<span class="code-quote">"port"</span>],  <span class="code-comment"># 27017
</span>    username=mongo_config[<span class="code-quote">"username"</span>],  
    password=mongo_config[<span class="code-quote">"password"</span>],  
    authSource=mongo_config.get(<span class="code-quote">"auth_source"</span>, <span class="code-quote">"admin"</span>),
    serverSelectionTimeoutMS=10000,
    connectTimeoutMS=10000,
    socketTimeoutMS=10000
)

<span class="code-comment"># Test connection <span class="code-keyword">with</span> ping
</span>ping_result = client.admin.command(<span class="code-quote">'ping'</span>)
<span class="code-keyword">assert</span> ping_result[<span class="code-quote">'ok'</span>] == 1.0

<span class="code-comment"># Get server info
</span>server_info = client.server_info()
<span class="code-keyword">assert</span> <span class="code-quote">'version'</span> <span class="code-keyword">in</span> server_info
logger.info(f<span class="code-quote">"MongoDB Version: {server_info[<span class="code-quote">'version'</span>]}"</span>)

<span class="code-comment"># List databases
</span>db_list = client.list_database_names()
<span class="code-keyword">assert</span> <span class="code-quote">'prisma'</span> <span class="code-keyword">in</span> db_list
<span class="code-keyword">assert</span> <span class="code-object">len</span>(db_list) &gt; 0

<span class="code-comment"># Close
</span>client.close()
logger.info(<span class="code-quote">"✅ MongoDB connectivity test PASSED"</span>)</pre>
</div></div>

<p><b>Environment:</b> Staging, Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_mongodb_direct_connection</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_basic_connectivity.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13805]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13805">Integration – Dynamic Visualization – Colormap Change Commands</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43341-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43341-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic Visualization – Colormap Change Commands</p>

<p><b>Objective:</b> Verify colormap selection commands work via RabbitMQ.</p>

<p><b>Priority:</b> Low</p>

<p><b>Components/Labels:</b> focus-server, colormap, rabbitmq</p>

<p><b>Requirements:</b> FOCUS-COLORMAP</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Supported colormaps known (e.g., "jet", "viridis")</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Colormap Command:
{
  <span class="code-quote">"command_type"</span>: <span class="code-quote">"ColormapCommand"</span>,
  <span class="code-quote">"colormap"</span>: <span class="code-quote">"viridis"</span>
}

Supported: jet, viridis, plasma, hot, cool</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send colormap command</td>
<td class='confluenceTd'>"viridis"</td>
<td class='confluenceTd'>Accepted</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Verify visualization</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Uses new colormap</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Colormap changed dynamically</li>
	<li>Visualization updated</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>New colormap active</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">colormap = <span class="code-quote">"viridis"</span>

mq_client.send_colormap_command(colormap=colormap)
logger.info(f<span class="code-quote">"✅ Colormap changed to {colormap}"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_colormap_commands</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13804]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13804">Integration – Valid CAxis Range</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43340-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43340-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic Visualization – Valid CAxis Adjustment</p>

<p><b>Objective:</b> Confirm valid CAxis ranges are accepted.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, caxis, colormap</p>

<p><b>Requirements:</b> FOCUS-CAXIS</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Baby Analyzer running</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Valid CAxis:
{
  <span class="code-quote">"caxis_min"</span>: -80,
  <span class="code-quote">"caxis_max"</span>: -10
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define valid range</td>
<td class='confluenceTd'><span class="error">&#91;-80, -10&#93;</span></td>
<td class='confluenceTd'>Valid</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Accepted</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify applied</td>
<td class='confluenceTd'>GET /waterfall</td>
<td class='confluenceTd'>New range used</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Valid CAxis accepted</li>
	<li>Visualization updated</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Colormap uses new range</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">caxis_min = -80
caxis_max = -10

<span class="code-keyword">assert</span> caxis_min &lt; caxis_max  <span class="code-comment"># Valid
</span>
mq_client.send_caxis_adjustment(caxis_min, caxis_max)
logger.info(<span class="code-quote">"✅ Valid CAxis applied"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_valid_caxis_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13803]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13803">Integration – Invalid CAxis Range (General)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43339-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43339-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic Visualization – Various Invalid CAxis Scenarios</p>

<p><b>Objective:</b> Test multiple invalid CAxis scenarios.</p>

<p><b>Priority:</b> Low</p>

<p><b>Components/Labels:</b> focus-server, caxis, validation</p>

<p><b>Requirements:</b> FOCUS-CAXIS-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation rules defined</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Scenarios:
1. {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 0} - Zero range
2. {<span class="code-quote">"min"</span>: <span class="code-keyword">null</span>, <span class="code-quote">"max"</span>: -20} - Null value
3. {<span class="code-quote">"min"</span>: <span class="code-quote">"invalid"</span>, <span class="code-quote">"max"</span>: -20} - Wrong type</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Test zero range</td>
<td class='confluenceTd'>min=0, max=0</td>
<td class='confluenceTd'>Rejected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Test null value</td>
<td class='confluenceTd'>min=null</td>
<td class='confluenceTd'>Rejected</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Test wrong type</td>
<td class='confluenceTd'>min="string"</td>
<td class='confluenceTd'>Rejected</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All invalid scenarios rejected</li>
	<li>Clear error messages</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System state unchanged</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Zero <span class="code-object">range</span>
</span><span class="code-keyword">try</span>:
    mq_client.send_caxis_adjustment(0, 0)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>
<span class="code-keyword">except</span>:
    logger.info(<span class="code-quote">"✅ Zero <span class="code-object">range</span> rejected"</span>)

<span class="code-comment"># Other invalid cases...</span></pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_invalid_caxis_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13802]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13802">Integration – CAxis with Invalid Range (Min &gt; Max)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43338-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43338-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic Visualization – Reject Invalid CAxis Range</p>

<p><b>Objective:</b> Ensure invalid CAxis ranges (min &gt; max) are rejected.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, caxis, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-CAXIS-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid CAxis:
{
  <span class="code-quote">"caxis_min"</span>: -20,
  <span class="code-quote">"caxis_max"</span>: -60
}

Reversed range (min &gt; max)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define invalid CAxis</td>
<td class='confluenceTd'>min=-20, max=-60</td>
<td class='confluenceTd'>Reversed</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate range</td>
<td class='confluenceTd'>min &gt; max</td>
<td class='confluenceTd'>Invalid</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Attempt send</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Should fail or warn</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Validation detects reversed range</li>
	<li>Command rejected or warning issued</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Invalid command not applied</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">caxis_min = -20
caxis_max = -60

<span class="code-keyword">assert</span> caxis_min &gt; caxis_max  <span class="code-comment"># Invalid!
</span>
<span class="code-comment"># Should <span class="code-keyword">raise</span> exception <span class="code-keyword">or</span> validation error
</span><span class="code-keyword">try</span>:
    mq_client.send_caxis_adjustment(caxis_min, caxis_max)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">False</span></span>, <span class="code-quote">"Should have rejected invalid CAxis"</span>
<span class="code-keyword">except</span> <span class="code-object">Exception</span> <span class="code-keyword">as</span> e:
    logger.info(f<span class="code-quote">"✅ Invalid CAxis correctly rejected: {e}"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_caxis_with_invalid_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13801]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13801">Integration – CAxis Adjustment Command</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43337-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43337-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic Visualization – Send CAxis Adjustment Command</p>

<p><b>Objective:</b> Verify CAxis (color axis) adjustment commands can be sent via RabbitMQ for dynamic colormap range changes.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, caxis, colormap, rabbitmq</p>

<p><b>Requirements:</b> FOCUS-CAXIS-COMMAND</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
	<li>PC-002: Baby Analyzer supports CAxis commands</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">CAxis Command:
{
  <span class="code-quote">"command_type"</span>: <span class="code-quote">"CAxisAdjustmentCommand"</span>,
  <span class="code-quote">"caxis_min"</span>: -60,
  <span class="code-quote">"caxis_max"</span>: -20,
  <span class="code-quote">"routing_key"</span>: <span class="code-quote">"caxis"</span>
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to RabbitMQ</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Define CAxis range</td>
<td class='confluenceTd'>min=-60, max=-20</td>
<td class='confluenceTd'>Range defined</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create CAxis command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Command created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Publish to exchange</td>
<td class='confluenceTd'>routing_key="caxis"</td>
<td class='confluenceTd'>Published</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify no errors</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Success</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>CAxis command sent successfully</li>
	<li>Baby Analyzer receives command</li>
	<li>Colormap range adjusted dynamically</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Waterfall visualization uses new color range</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">caxis_min = -60
caxis_max = -20

<span class="code-keyword">assert</span> caxis_min &lt; caxis_max  <span class="code-comment"># Valid <span class="code-object">range</span>
</span>
mq_client.send_caxis_adjustment(
    caxis_min=caxis_min,
    caxis_max=caxis_max,
    routing_key=<span class="code-quote">"caxis"</span>
)

logger.info(<span class="code-quote">"✅ CAxis command sent successfully"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_caxis_adjustment</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13800]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13800">Integration – Safe ROI Change (Within Limits)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43336-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43336-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Validate Safe ROI Change</p>

<p><b>Objective:</b> Confirm safe ROI changes pass validation.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, safety, validation</p>

<p><b>Requirements:</b> FOCUS-ROI-SAFETY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Safety rules configured</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 100}
Safe New ROI: {<span class="code-quote">"min"</span>: 10, <span class="code-quote">"max"</span>: 110}
Change: +10 shift, 90% overlap</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate overlap</td>
<td class='confluenceTd'><span class="error">&#91;10,100&#93;</span> overlap</td>
<td class='confluenceTd'>90%</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate size change</td>
<td class='confluenceTd'>100 vs 100</td>
<td class='confluenceTd'>0%</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Passes</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check is_safe</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>True</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Safe change approved</li>
	<li>No warnings</li>
	<li>Command sent successfully</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>ROI changed to new range</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">current_min = 0
current_max = 100
new_min = 10
new_max = 110

safety_result = validate_roi_change_safety(
    current_min=current_min,
    current_max=current_max,
    new_min=new_min,
    new_max=new_max,
    max_change_percent=50.0
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">True</span></span>
<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"overlap_percent"</span>] &gt;= 80
<span class="code-keyword">assert</span> <span class="code-object">len</span>(safety_result[<span class="code-quote">"warnings"</span>]) == 0

mq_client.send_roi_change(start=new_min, end=new_max)
logger.info(<span class="code-quote">"✅ Safe ROI change approved"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_safe_roi_change</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13799]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13799">Integration – Unsafe ROI Shift (Large Position Change)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43335-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43335-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Detect Unsafe Position Shift</p>

<p><b>Objective:</b> Verify detection when ROI shifts position dramatically.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, safety, validation</p>

<p><b>Requirements:</b> FOCUS-ROI-SAFETY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Safety rules for position shifts</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 100}
New ROI: {<span class="code-quote">"min"</span>: 150, <span class="code-quote">"max"</span>: 250}
Shift: +150 sensors, 0% overlap</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate shift</td>
<td class='confluenceTd'>new_min - current_min</td>
<td class='confluenceTd'>+150</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate overlap</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>0%</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Warning issued</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Large shift detected</li>
	<li>Low overlap flagged</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Warning logged</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">current_min = 0
current_max = 100
new_min = 150
new_max = 250

shift = new_min - current_min
<span class="code-keyword">assert</span> shift == 150  <span class="code-comment"># Large shift
</span>
safety_result = validate_roi_change_safety(
    current_min=current_min,
    current_max=current_max,
    new_min=new_min,
    new_max=new_max
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"overlap_percent"</span>] == 0
logger.info(<span class="code-quote">"✅ Large shift detected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_unsafe_roi_shift</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13798]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13798">Integration - Unsafe ROI Range Change (Size Change &gt; 50%)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43334-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43334-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Detect Unsafe Size Change</p>

<p><b>Objective:</b> Verify detection of unsafe size changes (e.g., doubling or halving ROI).</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, safety, validation</p>

<p><b>Requirements:</b> FOCUS-ROI-SAFETY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Safety rules configured</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 100, <span class="code-quote">"size"</span>: 100}
Unsafe New ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 250, <span class="code-quote">"size"</span>: 250}
Size change: 150% (unsafe)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Calculate size change</td>
<td class='confluenceTd'>(250-100)/100</td>
<td class='confluenceTd'>150% increase</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>max_change=50%</td>
<td class='confluenceTd'>Fails</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Check warnings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"size change too large"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Size change &gt; 50% detected as unsafe</li>
	<li>Warning issued</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Change logged</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">current_size = 100
new_size = 250
size_change_percent = ((new_size - current_size) / current_size) * 100

<span class="code-keyword">assert</span> size_change_percent == 150  <span class="code-comment"># &gt; 50% threshold
</span>
safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=0,
    new_max=250,
    max_change_percent=50.0
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
logger.info(<span class="code-quote">"✅ Unsafe size change detected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_unsafe_roi_range_change</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13797]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13797">Integration - Unsafe ROI Change (Large Jump)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43333-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43333-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Detect Unsafe ROI Change (Large Jump)</p>

<p><b>Objective:</b> Verify safety validation detects unsafe ROI changes (e.g., &gt;50% change).</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, roi, safety, validation</p>

<p><b>Requirements:</b> FOCUS-ROI-SAFETY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Safety rules: max_change_percent=50%</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 100}
Unsafe New ROI: {<span class="code-quote">"min"</span>: 200, <span class="code-quote">"max"</span>: 300}
Change: 100% shift, 0% overlap</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define large jump</td>
<td class='confluenceTd'><span class="error">&#91;0,100&#93;</span> → <span class="error">&#91;200,300&#93;</span></td>
<td class='confluenceTd'>No overlap</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Run safety validation</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Fails</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Check is_safe</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>False</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check warnings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"unsafe" or "large change"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Validation detects unsafe change</li>
	<li>Warning issued</li>
	<li>Command not sent (or sent with warning logged)</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Admin notified of unsafe change</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">current_min = 0
current_max = 100
new_min = 200
new_max = 300

safety_result = validate_roi_change_safety(
    current_min=current_min,
    current_max=current_max,
    new_min=new_min,
    new_max=new_max,
    max_change_percent=50.0
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"overlap_percent"</span>] == 0  <span class="code-comment"># No overlap
</span><span class="code-keyword">assert</span> <span class="code-object">len</span>(safety_result[<span class="code-quote">"warnings"</span>]) &gt; 0

logger.info(<span class="code-quote">"✅ Unsafe ROI change detected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_unsafe_roi_change</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13796]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13796">Integration - ROI Starting at Zero</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43332-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43332-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – ROI Starting at Sensor Index 0</p>

<p><b>Objective:</b> Verify ROI can start at sensor 0 (boundary).</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, boundary</p>

<p><b>Requirements:</b> FOCUS-ROI-BOUNDARY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">ROI at Lower Boundary:
{
  <span class="code-quote">"start"</span>: 0,
  <span class="code-quote">"end"</span>: 50
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define ROI at 0</td>
<td class='confluenceTd'><span class="error">&#91;0, 50&#93;</span></td>
<td class='confluenceTd'>Valid</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Accepted</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify waterfall</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Sensors start at 0</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Sensor 0 included correctly</li>
	<li>No index errors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System monitoring from sensor 0</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = 0
end = 50

mq_client.send_roi_change(start=start, end=end)
time.sleep(5)

waterfall = focus_api.get_waterfall(task_id)
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>] == 0
logger.info(<span class="code-quote">"✅ ROI at sensor 0 works"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_with_zero_start</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13795]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13795">Integration - ROI with Large Range (Edge Case)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43331-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43331-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Very Large ROI Range (e.g., all sensors)</p>

<p><b>Objective:</b> Test edge case where ROI covers maximum sensor range.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, edge-case, performance</p>

<p><b>Requirements:</b> FOCUS-ROI-EDGE</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: System max sensors known (e.g., 512 or 1024)</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Large Valid ROI:
{
  <span class="code-quote">"start"</span>: 0,
  <span class="code-quote">"end"</span>: 512
}

Size: 512 sensors (maximum)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define large ROI</td>
<td class='confluenceTd'><span class="error">&#91;0, 512&#93;</span></td>
<td class='confluenceTd'>All sensors</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Passes</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Accepted</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Monitor resources</td>
<td class='confluenceTd'>CPU/Memory</td>
<td class='confluenceTd'>No exhaustion</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Maximum ROI accepted</li>
	<li>System handles high data volume</li>
	<li>No performance degradation</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System monitoring all sensors</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = 0
end = 512  <span class="code-comment"># Or max_sensors <span class="code-keyword">from</span> config
</span>size = end - start

<span class="code-keyword">assert</span> size == 512

safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">True</span></span>
mq_client.send_roi_change(start=start, end=end)
logger.info(<span class="code-quote">"✅ Large ROI handled correctly"</span>)</pre>
</div></div>

<p><b>Environment:</b> Staging, Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_with_large_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13794]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13794">Integration - ROI with Small Range (Edge Case)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43330-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43330-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Very Small ROI Range (e.g., 2 sensors)</p>

<p><b>Objective:</b> Test edge case where ROI is very small but valid.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, edge-case</p>

<p><b>Requirements:</b> FOCUS-ROI-EDGE</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Small Valid ROI:
{
  <span class="code-quote">"start"</span>: 50,
  <span class="code-quote">"end"</span>: 52
}

Size: 2 sensors</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define small ROI</td>
<td class='confluenceTd'><span class="error">&#91;50, 52&#93;</span></td>
<td class='confluenceTd'>2 sensors</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Passes (warning maybe)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Accepted</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify system handles</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>No crash or error</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Small ROI accepted (possibly with warning)</li>
	<li>System handles edge case gracefully</li>
	<li>Baby Analyzer reinitializes with 2 sensors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System monitoring 2 sensors only</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = 50
end = 52
size = end - start

<span class="code-keyword">assert</span> size == 2  <span class="code-comment"># Very small
</span>
<span class="code-comment"># May <span class="code-keyword">pass</span> <span class="code-keyword">with</span> warning
</span>safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-comment"># Should work even <span class="code-keyword">if</span> small
</span>mq_client.send_roi_change(start=start, end=end)
logger.info(<span class="code-quote">"✅ Small ROI handled correctly"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_with_small_range</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13793]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13793">Integration - Dynamic ROI – Reject ROI with Negative End Value</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43329-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43329-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Reject ROI with Negative End Value</p>

<p><b>Objective:</b> Verify system rejects ROI with negative end sensor index.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-ROI-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid ROI (Negative End):
{
  <span class="code-quote">"start"</span>: 10,
  <span class="code-quote">"end"</span>: -50
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define negative end</td>
<td class='confluenceTd'>start=10, end=-50</td>
<td class='confluenceTd'>ROI defined</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Check end value</td>
<td class='confluenceTd'>end &lt; 0</td>
<td class='confluenceTd'>True (invalid)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Fails</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Negative end value rejected</li>
	<li>Clear error message</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>No state change</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = 10
end = -50

<span class="code-keyword">assert</span> end &lt; 0  <span class="code-comment"># Negative end
</span>
safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
logger.info(<span class="code-quote">"✅ Negative end ROI rejected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_with_negative_end</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13792]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13792">Integration - ROI with Negative Start</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43328-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43328-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Reject ROI with Negative Start Value</p>

<p><b>Objective:</b> Verify system rejects ROI with negative start sensor index.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-ROI-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Validation enabled</li>
	<li>PC-002: Sensor indices must be &gt;= 0</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid ROI (Negative Start):
{
  <span class="code-quote">"start"</span>: -10,
  <span class="code-quote">"end"</span>: 50
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define negative start</td>
<td class='confluenceTd'>start=-10, end=50</td>
<td class='confluenceTd'>ROI defined</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Check start value</td>
<td class='confluenceTd'>start &lt; 0</td>
<td class='confluenceTd'>True (invalid)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Fails</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check warnings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"negative" or "invalid index"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Validation rejects negative sensor index</li>
	<li>Warning message clear</li>
	<li>No command sent</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System state unchanged</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = -10
end = 50

<span class="code-keyword">assert</span> start &lt; 0  <span class="code-comment"># Negative start
</span>
safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
<span class="code-keyword">assert</span> <span class="code-object">any</span>(<span class="code-quote">"negative"</span> <span class="code-keyword">in</span> w.lower() <span class="code-keyword">or</span> <span class="code-quote">"invalid"</span> <span class="code-keyword">in</span> w.lower() 
           <span class="code-keyword">for</span> w <span class="code-keyword">in</span> safety_result[<span class="code-quote">"warnings"</span>])

logger.info(<span class="code-quote">"✅ Negative start ROI rejected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_with_negative_start</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13791]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13791">Integration - ROI with Reversed Range (Start &gt; End)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43327-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43327-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Reject Reversed ROI Range</p>

<p><b>Objective:</b> Ensure system rejects ROI where start &gt; end (reversed range).</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, roi, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-ROI-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Safety validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid ROI (Reversed):
{
  <span class="code-quote">"start"</span>: 150,
  <span class="code-quote">"end"</span>: 50
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define reversed ROI</td>
<td class='confluenceTd'>start=150, end=50</td>
<td class='confluenceTd'>ROI defined</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate size</td>
<td class='confluenceTd'>end - start</td>
<td class='confluenceTd'>size = -100 (negative!)</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Fails</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check is_safe</td>
<td class='confluenceTd'>result<span class="error">&#91;&quot;is_safe&quot;&#93;</span></td>
<td class='confluenceTd'>False</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check warnings</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>"reversed" or "invalid range"</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Validation fails due to reversed range</li>
	<li>Clear warning message</li>
	<li>No command sent</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Original ROI preserved</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">start = 150
end = 50

safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
<span class="code-keyword">assert</span> end - start &lt; 0  <span class="code-comment"># Negative size
</span><span class="code-keyword">assert</span> <span class="code-object">len</span>(safety_result[<span class="code-quote">"warnings"</span>]) &gt; 0

logger.info(<span class="code-quote">"✅ Reversed ROI correctly rejected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_invalid_roi_reversed</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13790]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13790">Integration - ROI with Equal Start and End (Zero Size)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43326-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43326-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Reject ROI with Start Equal to End</p>

<p><b>Objective:</b> Verify that the system rejects an ROI change where start equals end (zero-size ROI) as this is invalid.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, validation, negative-test</p>

<p><b>Requirements:</b> FOCUS-ROI-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
	<li>PC-010: Safety validation enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Invalid ROI (Zero Size):
{
  <span class="code-quote">"start"</span>: 50,
  <span class="code-quote">"end"</span>: 50
}

Expected Validation Result:
{
  <span class="code-quote">"is_safe"</span>: <span class="code-keyword">false</span>,
  <span class="code-quote">"warnings"</span>: [<span class="code-quote">"ROI size is zero"</span>]
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define zero-size ROI</td>
<td class='confluenceTd'>start=50, end=50</td>
<td class='confluenceTd'>ROI defined</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Calculate ROI size</td>
<td class='confluenceTd'>end - start</td>
<td class='confluenceTd'>size = 0</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Run safety validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Validation fails</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check is_safe flag</td>
<td class='confluenceTd'>result<span class="error">&#91;&quot;is_safe&quot;&#93;</span></td>
<td class='confluenceTd'>False</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check warnings</td>
<td class='confluenceTd'>result<span class="error">&#91;&quot;warnings&quot;&#93;</span></td>
<td class='confluenceTd'>Contains "zero" or "invalid size"</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Attempt to send command</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Command should not be sent</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Safety validation fails (is_safe=False)</li>
	<li>Warning about zero-size ROI generated</li>
	<li>Command not sent to RabbitMQ</li>
	<li>System protects against invalid ROI</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Original ROI unchanged</li>
	<li>No command published</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Zero-size ROI
</span>start = 50
end = 50

<span class="code-comment"># Validate safety
</span>safety_result = validate_roi_change_safety(
    current_min=0,
    current_max=100,
    new_min=start,
    new_max=end
)

<span class="code-comment"># Should fail validation
</span><span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">False</span></span>
<span class="code-keyword">assert</span> <span class="code-object">len</span>(safety_result[<span class="code-quote">"warnings"</span>]) &gt; 0
<span class="code-keyword">assert</span> <span class="code-object">any</span>(<span class="code-quote">"size"</span> <span class="code-keyword">in</span> w.lower() <span class="code-keyword">or</span> <span class="code-quote">"zero"</span> <span class="code-keyword">in</span> w.lower() 
           <span class="code-keyword">for</span> w <span class="code-keyword">in</span> safety_result[<span class="code-quote">"warnings"</span>])

logger.info(<span class="code-quote">"✅ Zero-size ROI correctly rejected"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_equal_start_end</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13789]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13789">Integration - ROI Shift (Move Range)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43325-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43325-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Shift ROI Range Without Changing Size</p>

<p><b>Objective:</b> Verify that shifting ROI (moving the window while keeping size constant) works correctly.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, shift, pan</p>

<p><b>Requirements:</b> FOCUS-ROI-SHIFT</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Task configured with ROI <span class="error">&#91;0, 50&#93;</span></li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50}
New ROI (Shifted): {<span class="code-quote">"min"</span>: 100, <span class="code-quote">"max"</span>: 150}
Change: Moved +100 sensors right, size unchanged</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure initial ROI</td>
<td class='confluenceTd'><span class="error">&#91;0, 50&#93;</span></td>
<td class='confluenceTd'>50 sensors (0-49)</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send shift command</td>
<td class='confluenceTd'><span class="error">&#91;100, 150&#93;</span></td>
<td class='confluenceTd'>Command accepted</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Wait</td>
<td class='confluenceTd'>5 sec</td>
<td class='confluenceTd'>Reinitialization</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify new range</td>
<td class='confluenceTd'>GET /waterfall</td>
<td class='confluenceTd'>Sensors <span class="error">&#91;100, 150&#93;</span></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check size unchanged</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>Still 50 sensors</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>ROI shifted right by 100 sensors</li>
	<li>Size remains 50 sensors</li>
	<li>No overlap with previous range</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System monitoring new shifted range</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">initial_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 50}
initial_size = initial_roi[<span class="code-quote">"<span class="code-object">max</span>"</span>] - initial_roi[<span class="code-quote">"<span class="code-object">min</span>"</span>]

new_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 100, <span class="code-quote">"<span class="code-object">max</span>"</span>: 150}
mq_client.send_roi_change(start=100, end=150)
time.sleep(5)

waterfall = focus_api.get_waterfall(task_id)
new_size = waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] - waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>]

<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>] == 100
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] == 150
<span class="code-keyword">assert</span> new_size == initial_size  <span class="code-comment"># Size unchanged
</span>
logger.info(<span class="code-quote">"✅ ROI shifted successfully"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_shift</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13788]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13788">Integration - ROI Shrinking (Decrease Range)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43324-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43324-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Shrink ROI Range (Reduce Sensor Coverage)</p>

<p><b>Objective:</b> Validate that shrinking the ROI range (making it smaller) works correctly for focusing on specific area.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, shrink, focus</p>

<p><b>Requirements:</b> FOCUS-ROI-SHRINK</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Task configured with ROI <span class="error">&#91;0, 200&#93;</span></li>
	<li>PC-002: System monitoring 200 sensors</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 200}
New ROI (Shrunk): {<span class="code-quote">"min"</span>: 75, <span class="code-quote">"max"</span>: 125}
Change: -150 sensors (focus on middle 50)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure initial ROI</td>
<td class='confluenceTd'><span class="error">&#91;0, 200&#93;</span></td>
<td class='confluenceTd'>200 sensors monitored</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send shrink command</td>
<td class='confluenceTd'><span class="error">&#91;75, 125&#93;</span></td>
<td class='confluenceTd'>Command accepted</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Wait for reinitialization</td>
<td class='confluenceTd'>5 sec</td>
<td class='confluenceTd'>Baby Analyzer restarts</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify new range</td>
<td class='confluenceTd'>GET /waterfall</td>
<td class='confluenceTd'>Sensors <span class="error">&#91;75, 125&#93;</span></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check sensor count</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>50 sensors monitored</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>ROI successfully shrunk from 200 to 50 sensors</li>
	<li>System now monitors only middle range</li>
	<li>Performance improved due to fewer sensors</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System continues with shrunk ROI</li>
	<li>Resources freed up</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Initial ROI
</span>initial_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 0, <span class="code-quote">"<span class="code-object">max</span>"</span>: 200}
<span class="code-keyword">assert</span> (initial_roi[<span class="code-quote">"<span class="code-object">max</span>"</span>] - initial_roi[<span class="code-quote">"<span class="code-object">min</span>"</span>]) == 200

<span class="code-comment"># Shrink ROI
</span>new_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 75, <span class="code-quote">"<span class="code-object">max</span>"</span>: 125}
mq_client.send_roi_change(start=75, end=125)
time.sleep(5)

<span class="code-comment"># Verify shrink
</span>waterfall = focus_api.get_waterfall(task_id)
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>] == 75
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] == 125
<span class="code-keyword">assert</span> (waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] - waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>]) == 50

logger.info(<span class="code-quote">"✅ ROI shrunk successfully"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_shrinking</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13787]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13787">Integration -  ROI Expansion (Increase Range)</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43323-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43323-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Expand ROI Range (Increase Sensor Coverage)</p>

<p><b>Objective:</b> Validate that expanding the ROI range (making it larger) works correctly and system adapts to monitor more sensors.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, roi, expansion</p>

<p><b>Requirements:</b> FOCUS-ROI-EXPANSION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Task configured with ROI <span class="error">&#91;50, 100&#93;</span></li>
	<li>PC-002: System monitoring 50 sensors</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI: {<span class="code-quote">"min"</span>: 50, <span class="code-quote">"max"</span>: 100}
New ROI (Expanded): {<span class="code-quote">"min"</span>: 25, <span class="code-quote">"max"</span>: 125}
Change: +50 sensors (25 below, 25 above)</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Configure initial ROI</td>
<td class='confluenceTd'><span class="error">&#91;50, 100&#93;</span></td>
<td class='confluenceTd'>50 sensors monitored</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Send expansion command</td>
<td class='confluenceTd'><span class="error">&#91;25, 125&#93;</span></td>
<td class='confluenceTd'>Command accepted</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Wait for reinitialization</td>
<td class='confluenceTd'>5 sec</td>
<td class='confluenceTd'>Baby Analyzer restarts</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify new range</td>
<td class='confluenceTd'>GET /waterfall</td>
<td class='confluenceTd'>Sensors <span class="error">&#91;25, 125&#93;</span></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check sensor count</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>100 sensors monitored</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>ROI successfully expanded from 50 to 100 sensors</li>
	<li>System now monitors additional 50 sensors</li>
	<li>No data loss or corruption</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>System continues with expanded ROI</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Initial ROI
</span>initial_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 50, <span class="code-quote">"<span class="code-object">max</span>"</span>: 100}
<span class="code-keyword">assert</span> (initial_roi[<span class="code-quote">"<span class="code-object">max</span>"</span>] - initial_roi[<span class="code-quote">"<span class="code-object">min</span>"</span>]) == 50

<span class="code-comment"># Expand ROI
</span>new_roi = {<span class="code-quote">"<span class="code-object">min</span>"</span>: 25, <span class="code-quote">"<span class="code-object">max</span>"</span>: 125}
mq_client.send_roi_change(start=25, end=125)
time.sleep(5)

<span class="code-comment"># Verify expansion
</span>waterfall = focus_api.get_waterfall(task_id)
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>] == 25
<span class="code-keyword">assert</span> waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] == 125
<span class="code-keyword">assert</span> (waterfall.sensor_range[<span class="code-quote">"<span class="code-object">max</span>"</span>] - waterfall.sensor_range[<span class="code-quote">"<span class="code-object">min</span>"</span>]) == 100

logger.info(<span class="code-quote">"✅ ROI expanded successfully"</span>)</pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_expansion</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13786]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13786">Integration - Multiple ROI Changes in Sequence</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43322-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43322-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI – Sequential ROI Changes Without System Restart</p>

<p><b>Objective:</b> Verify that multiple ROI change commands can be sent in sequence without requiring system restart or causing state corruption.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, roi, sequence, stability</p>

<p><b>Requirements:</b> FOCUS-ROI-MULTIPLE, FOCUS-STABILITY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
	<li>PC-010: Live task configured and running</li>
	<li>PC-011: Baby Analyzer responsive to commands</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">ROI Sequence:
[
  {<span class="code-quote">"start"</span>: 0, <span class="code-quote">"end"</span>: 100},
  {<span class="code-quote">"start"</span>: 50, <span class="code-quote">"end"</span>: 150},
  {<span class="code-quote">"start"</span>: 100, <span class="code-quote">"end"</span>: 200},
  {<span class="code-quote">"start"</span>: 75, <span class="code-quote">"end"</span>: 175},
  {<span class="code-quote">"start"</span>: 25, <span class="code-quote">"end"</span>: 125}
]

Wait Time Between Commands: 2 seconds</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Send ROI command 1</td>
<td class='confluenceTd'><span class="error">&#91;0, 100&#93;</span></td>
<td class='confluenceTd'>Command sent</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Wait</td>
<td class='confluenceTd'>2 seconds</td>
<td class='confluenceTd'>System stabilizes</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Send ROI command 2</td>
<td class='confluenceTd'><span class="error">&#91;50, 150&#93;</span></td>
<td class='confluenceTd'>Command sent</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Wait</td>
<td class='confluenceTd'>2 seconds</td>
<td class='confluenceTd'>System stabilizes</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Send ROI command 3</td>
<td class='confluenceTd'><span class="error">&#91;100, 200&#93;</span></td>
<td class='confluenceTd'>Command sent</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Wait</td>
<td class='confluenceTd'>2 seconds</td>
<td class='confluenceTd'>System stabilizes</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Send ROI command 4</td>
<td class='confluenceTd'><span class="error">&#91;75, 175&#93;</span></td>
<td class='confluenceTd'>Command sent</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Wait</td>
<td class='confluenceTd'>2 seconds</td>
<td class='confluenceTd'>System stabilizes</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Send ROI command 5</td>
<td class='confluenceTd'><span class="error">&#91;25, 125&#93;</span></td>
<td class='confluenceTd'>Command sent</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Verify all successful</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>No errors in sequence</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All 5 ROI commands sent successfully</li>
	<li>No connection drops or timeouts</li>
	<li>System remains responsive throughout</li>
	<li>No memory leaks or resource exhaustion</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Final ROI applied correctly (<span class="error">&#91;25, 125&#93;</span>)</li>
	<li>System stable and operational</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">roi_sequence = [
    (0, 100),
    (50, 150),
    (100, 200),
    (75, 175),
    (25, 125)
]

<span class="code-keyword">for</span> i, (start, end) <span class="code-keyword">in</span> <span class="code-object">enumerate</span>(roi_sequence, 1):
    logger.info(f<span class="code-quote">"Sending ROI change {i}/5: [{start}, {end}]"</span>)
    client.send_roi_change(start=start, end=end)
    <span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">True</span></span>  <span class="code-comment"># No exception
</span>    time.sleep(2)  <span class="code-comment"># Wait <span class="code-keyword">for</span> processing
</span>
logger.info(<span class="code-quote">"✅ All 5 ROI commands sent successfully"</span>)
<span class="code-keyword">assert</span> <span class="code-object">len</span>(roi_sequence) == 5</pre>
</div></div>

<p><b>Environment:</b> Staging, Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_multiple_roi_changes_sequence</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13785]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13785">Integration - ROI Change with Safety Validation</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43321-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43321-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI Change – Validate Safety Before Sending Command</p>

<p><b>Objective:</b> Ensure ROI change requests undergo safety validation to prevent unsafe or destructive changes that could impact system stability.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, roi, safety-validation, rabbitmq</p>

<p><b>Requirements:</b> FOCUS-ROI-SAFETY, FOCUS-VALIDATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ accessible</li>
	<li>PC-010: Current ROI known (min=0, max=100)</li>
	<li>PC-011: Safety validation rules configured (max_change_percent=50%)</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Current ROI:
{
  <span class="code-quote">"current_min"</span>: 0,
  <span class="code-quote">"current_max"</span>: 100
}

New ROI (Safe):
{
  <span class="code-quote">"new_min"</span>: 20,
  <span class="code-quote">"new_max"</span>: 120
}

Safety Rules:
{
  <span class="code-quote">"max_change_percent"</span>: 50.0,
  <span class="code-quote">"min_overlap_percent"</span>: 30.0
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Define current ROI</td>
<td class='confluenceTd'>min=0, max=100</td>
<td class='confluenceTd'>Current state captured</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Define new ROI</td>
<td class='confluenceTd'>min=20, max=120</td>
<td class='confluenceTd'>New state defined</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Calculate change percentage</td>
<td class='confluenceTd'>(120-20) vs (100-0)</td>
<td class='confluenceTd'>0% change (same size)</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Calculate overlap</td>
<td class='confluenceTd'><span class="error">&#91;20,100&#93;</span> overlap</td>
<td class='confluenceTd'>80% overlap</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Run safety validation</td>
<td class='confluenceTd'>validate_roi_change_safety()</td>
<td class='confluenceTd'>Safety check passes</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Check is_safe flag</td>
<td class='confluenceTd'>result<span class="error">&#91;&quot;is_safe&quot;&#93;</span></td>
<td class='confluenceTd'>True</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Send ROI command</td>
<td class='confluenceTd'>start=20, end=120</td>
<td class='confluenceTd'>Command sent successfully</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Safety validation passes (is_safe=True)</li>
	<li>No warnings generated</li>
	<li>ROI command sent to RabbitMQ</li>
	<li>System accepts new ROI range</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Safety validation logs recorded</li>
	<li>Command successfully delivered</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python">current_min = 0
current_max = 100
new_min = 20
new_max = 120

<span class="code-comment"># Validate safety
</span>safety_result = validate_roi_change_safety(
    current_min=current_min,
    current_max=current_max,
    new_min=new_min,
    new_max=new_max,
    max_change_percent=50.0
)

<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"is_safe"</span>] == <span class="code-keyword"><span class="code-object">True</span></span>
<span class="code-keyword">assert</span> <span class="code-object">len</span>(safety_result[<span class="code-quote">"warnings"</span>]) == 0
<span class="code-keyword">assert</span> safety_result[<span class="code-quote">"overlap_percent"</span>] &gt;= 30.0

<span class="code-comment"># Send command
</span>client.send_roi_change(start=new_min, end=new_max)
<span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">True</span></span>  <span class="code-comment"># No exception means success</span></pre>
</div></div>

<p><b>Environment:</b> All</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_roi_change_with_validation</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13784]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13784">Integration - Send ROI Change Command via RabbitMQ</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43320-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43320-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Dynamic ROI Change – Send RegionOfInterestCommand via RabbitMQ</p>

<p><b>Objective:</b> Verify that a RegionOfInterestCommand can be successfully published to RabbitMQ Baby Analyzer exchange and accepted by the system without errors.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, rabbitmq, roi, baby-analyzer, mq-commands</p>

<p><b>Requirements:</b> FOCUS-ROI-COMMAND, FOCUS-RABBITMQ-INTEGRATION</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: RabbitMQ server accessible at configured host/port</li>
	<li>PC-002: RabbitMQ credentials valid (username/password)</li>
	<li>PC-003: Baby Analyzer exchange exists</li>
	<li>PC-004: ROI routing key configured</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">RabbitMQ Connection:
{
  <span class="code-quote">"host"</span>: <span class="code-quote">"10.10.100.107"</span>,
  <span class="code-quote">"port"</span>: 5672,
  <span class="code-quote">"username"</span>: <span class="code-quote">"prisma"</span>,
  <span class="code-quote">"password"</span>: <span class="code-quote">"prisma"</span>,
  <span class="code-quote">"vhost"</span>: <span class="code-quote">"/"</span>
}

ROI Command Payload:
{
  <span class="code-quote">"command_type"</span>: <span class="code-quote">"RegionOfInterestCommand"</span>,
  <span class="code-quote">"start"</span>: 50,
  <span class="code-quote">"end"</span>: 150,
  <span class="code-quote">"routing_key"</span>: <span class="code-quote">"roi"</span>
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Connect to RabbitMQ</td>
<td class='confluenceTd'>host=10.10.100.107, port=5672</td>
<td class='confluenceTd'>Connection established</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Verify exchange exists</td>
<td class='confluenceTd'>exchange="baby_analyzer"</td>
<td class='confluenceTd'>Exchange available</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Create ROI command</td>
<td class='confluenceTd'>start=50, end=150</td>
<td class='confluenceTd'>Command object created</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Publish command</td>
<td class='confluenceTd'>routing_key="roi"</td>
<td class='confluenceTd'>Message published successfully</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify no exceptions</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>No errors raised</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Check MQ acknowledgment</td>
<td class='confluenceTd'>*</td>
<td class='confluenceTd'>ACK received</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>ROI change command published to RabbitMQ successfully</li>
	<li>No exceptions or connection errors</li>
	<li>Command delivered to Baby Analyzer queue</li>
	<li>MQ acknowledgment received</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>RabbitMQ connection closed cleanly</li>
	<li>No orphaned messages in queues</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Connect to RabbitMQ
</span>client = BabyAnalyzerMQClient(host=<span class="code-quote">"10.10.100.107"</span>, port=5672, 
                               username=<span class="code-quote">"prisma"</span>, password=<span class="code-quote">"prisma"</span>)
client.connect()
<span class="code-keyword">assert</span> client.is_connected() == <span class="code-keyword"><span class="code-object">True</span></span>

<span class="code-comment"># Send ROI command
</span>new_start = 50
new_end = 150
client.send_roi_change(start=new_start, end=new_end, routing_key=<span class="code-quote">"roi"</span>)

<span class="code-comment"># Verify no exceptions
</span><span class="code-keyword">assert</span> <span class="code-keyword"><span class="code-object">True</span></span>  <span class="code-comment"># Test passes <span class="code-keyword">if</span> no exception raised
</span>
<span class="code-comment"># Cleanup
</span>client.disconnect()</pre>
</div></div>

<p><b>Environment:</b> Staging, Production</p>

<p><b>Automation Status:</b> IMPLEMENTED  <br/>
<b>Test Function:</b> <tt>test_send_roi_change_command</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_dynamic_roi_adjustment.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13770]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13770">Performance – /config Latency P95/P99</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43299-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            performance_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43299-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Objective"></a>Objective</h2>

<p>Measures and validates <b>P95 and P99 latency</b> for the critical {{POST /config/</p>
{task_id}
<p>}} endpoint. This performance test ensures that the configuration endpoint responds within acceptable time limits under normal load. P95 (95th percentile) and P99 (99th percentile) metrics are industry-standard SLA indicators.</p>

<h2><a name="Priority"></a>Priority</h2>

<p><b>High</b></p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<ul>
	<li><b>Component</b>: Focus Server Backend API</li>
	<li><b>Labels</b>: <tt>performance</tt>, <tt>latency</tt>, <tt>p95</tt>, <tt>p99</tt>, <tt>sla</tt>, <tt>load-test</tt></li>
	<li><b>Test Type</b>: Performance Test</li>
</ul>


<h2><a name="Requirements"></a>Requirements</h2>

<ul>
	<li><b>Requirement ID</b>: FOCUS-API-PERFORMANCE-001</li>
	<li><b>Description</b>: Configuration endpoint must meet P95/P99 latency SLAs</li>
</ul>


<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ol>
	<li>Focus Server is running under normal load (not stressed)</li>
	<li>System resources are available (CPU &lt; 80%, Memory &lt; 85%)</li>
	<li>MongoDB and RabbitMQ are responsive</li>
	<li>No other heavy tests running concurrently</li>
</ol>


<h2><a name="TestData"></a>Test Data</h2>

<p><b>Standard Configuration Payload</b> (repeated 100 times):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: {<span class="code-quote">"height"</span>: 1000},
  <span class="code-quote">"channels"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 50},
  <span class="code-quote">"frequencyRange"</span>: {<span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500},
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Note</b>: Same config used for all 100 requests (different task_ids)</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Step Description</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Prepare test: 100 unique task_ids</td>
<td class='confluenceTd'>100 task_ids generated</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Clear any previous test data</td>
<td class='confluenceTd'>System clean</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>For i=1 to 100: Record start time <tt>t_start<span class="error">&#91;i&#93;</span></tt></td>
<td class='confluenceTd'>Time recorded</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Send <tt>POST &lt;<a href="https://10.10.100.100/focus-server/config/%7Btask_id%5Bi%5D%7D" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/config/{task_id[i]}</a></tt>&gt; with payload</td>
<td class='confluenceTd'>Request sent</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Record end time <tt>t_end<span class="error">&#91;i&#93;</span></tt></td>
<td class='confluenceTd'>Time recorded</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Calculate latency: <tt>latency<span class="error">&#91;i&#93;</span> = (t_end<span class="error">&#91;i&#93;</span> - t_start<span class="error">&#91;i&#93;</span>) * 1000</tt> ms</td>
<td class='confluenceTd'>Latency in milliseconds</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Verify response status: 200 OK or "Config received successfully"</td>
<td class='confluenceTd'>Success confirmed</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Add 100ms delay every 10 requests to avoid overwhelming server</td>
<td class='confluenceTd'>Controlled load</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>After all 100 requests, sort latencies</td>
<td class='confluenceTd'>Latencies sorted</td>
</tr>
<tr>
<td class='confluenceTd'>10</td>
<td class='confluenceTd'>Calculate P50 (median): <tt>latency<span class="error">&#91;50&#93;</span></tt></td>
<td class='confluenceTd'>P50 value</td>
</tr>
<tr>
<td class='confluenceTd'>11</td>
<td class='confluenceTd'>Calculate P95: <tt>latency<span class="error">&#91;95&#93;</span></tt></td>
<td class='confluenceTd'>P95 value</td>
</tr>
<tr>
<td class='confluenceTd'>12</td>
<td class='confluenceTd'>Calculate P99: <tt>latency<span class="error">&#91;99&#93;</span></tt></td>
<td class='confluenceTd'>P99 value</td>
</tr>
<tr>
<td class='confluenceTd'>13</td>
<td class='confluenceTd'>Calculate min, max, average</td>
<td class='confluenceTd'>Statistical summary</td>
</tr>
<tr>
<td class='confluenceTd'>14</td>
<td class='confluenceTd'>Count errors/failures</td>
<td class='confluenceTd'>Error count</td>
</tr>
<tr>
<td class='confluenceTd'>15</td>
<td class='confluenceTd'>Verify P95 &lt; <b><span class="error">&#91;THRESHOLD&#93;</span></b> ms (need specs!)</td>
<td class='confluenceTd'>P95 within SLA</td>
</tr>
<tr>
<td class='confluenceTd'>16</td>
<td class='confluenceTd'>Verify P99 &lt; <b><span class="error">&#91;THRESHOLD&#93;</span></b> ms (need specs!)</td>
<td class='confluenceTd'>P99 within SLA</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult"></a>Expected Result</h2>

<ul>
	<li><b>100 requests</b> executed successfully</li>
	<li><b>P50 (median)</b> latency: &lt; 200ms (target)</li>
	<li><b>P95 latency</b>: &lt; <b><span class="error">&#91;THRESHOLD&#93;</span></b> ms (e.g., 500ms - <b>needs specs meeting</b>)</li>
	<li><b>P99 latency</b>: &lt; <b><span class="error">&#91;THRESHOLD&#93;</span></b> ms (e.g., 1000ms - <b>needs specs meeting</b>)</li>
	<li><b>Error rate</b>: &lt; 5% (95% success rate minimum)</li>
	<li><b>No timeouts</b> or crashes</li>
	<li>System remains stable throughout test</li>
</ul>


<p><b>Current Thresholds</b> (to be updated after specs meeting):</p>

<ul>
	<li>P95: 500ms (reasonable default)</li>
	<li>P99: 1000ms (reasonable default)</li>
</ul>


<h2><a name="PostConditions"></a>Post-Conditions</h2>

<ul>
	<li>Test tasks can be cleaned up</li>
	<li>Performance metrics logged</li>
	<li>System resources return to normal</li>
	<li>No degradation in subsequent requests</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p><b>Same as PZ-13879</b> (new_production environment)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>✅ <b>Automated</b></p>

<p><b>Test Function</b>: <tt>test_config_endpoint_latency_p95_p99</tt>, <tt>test_waterfall_endpoint_latency_p95</tt>  <br/>
<b>Test File</b>: <tt>tests/integration/performance/test_performance_high_priority.py</tt>  <br/>
<b>Test Class</b>: <tt>TestAPILatencyP95</tt>  <br/>
<b>Lines</b>: 53-195</p>

<p><b>Run Command</b>:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-bash"><span class="code-comment"># Run performance tests (slow)
</span>pytest tests/integration/performance/test_performance_high_priority.py::TestAPILatencyP95 -v -s

<span class="code-comment"># Generate performance report
</span>pytest tests/integration/performance/test_performance_high_priority.py::TestAPILatencyP95::test_config_endpoint_latency_p95_p99 \
  --junitxml=results/performance_p95.xml \
  --html=results/performance_p95.html</pre>
</div></div>

<p><b>Expected Test Duration</b>: ~60-90 seconds (100 requests with delays)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13769]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13769">Security – Malformed Input Handling</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43298-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            security_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43298-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Security – Malformed Input Handling</p>

<p><b>Objective:</b> Validate input hardening against malformed/injection attempts.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, security, input-validation</p>

<p><b>Requirements:</b> FOCUS-SEC-ROBUSTNESS</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: Security logging enabled</li>
</ul>


<p><b>Test Data:</b></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>1. Malformed JSON: {"invalid": unclosed
2. SQL Injection: ?id='1' OR '1'='1
3. XSS: &lt;script&gt;alert('xss')&lt;/script&gt;
4. XXE: &lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;]&gt;
5. Oversized: 10MB JSON
6. Null bytes: \u0000
7. Path traversal: ../../etc/passwd</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>POST malformed JSON</td>
<td class='confluenceTd'>Broken JSON</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>GET with SQLi</td>
<td class='confluenceTd'>Injection param</td>
<td class='confluenceTd'>Sanitized</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>POST XSS</td>
<td class='confluenceTd'>Script tags</td>
<td class='confluenceTd'>Rejected</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>POST XXE</td>
<td class='confluenceTd'>Entity payload</td>
<td class='confluenceTd'>Rejected</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>POST oversized</td>
<td class='confluenceTd'>10MB</td>
<td class='confluenceTd'>HTTP 413 or handled</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>POST null bytes</td>
<td class='confluenceTd'>\u0000</td>
<td class='confluenceTd'>Sanitized</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Path traversal</td>
<td class='confluenceTd'>../..</td>
<td class='confluenceTd'>Blocked</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Check logs</td>
<td class='confluenceTd'>Security log</td>
<td class='confluenceTd'>All logged</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>Verify server</td>
<td class='confluenceTd'>Status</td>
<td class='confluenceTd'>Running</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>All attacks blocked</li>
	<li>No 500 errors</li>
	<li>Security logged</li>
	<li>Server stable</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> <span class="code-object">all</span>(r.status_code != 500 <span class="code-keyword">for</span> r <span class="code-keyword">in</span> attacks)
<span class="code-keyword">assert</span> malformed.status_code == 400
<span class="code-keyword">assert</span> security_log.contains_all_attempts()
<span class="code-keyword">assert</span> server.is_running()</pre>
</div></div>

<p><b>Environment:</b> Staging</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_security_malformed_inputs</tt><br/>
<b>Test File:</b> <tt>tests/integration/security/test_input_security.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13768]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13768">Integration – RabbitMQ Outage Handling</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43297-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43297-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Integration – RabbitMQ Outage Handling</p>

<p><b>Objective:</b> Validate graceful failure when RabbitMQ unavailable.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, resilience, rabbitmq, outage</p>

<p><b>Requirements:</b> FOCUS-RESILIENCE-RABBIT</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-020: RabbitMQ can be blocked</li>
	<li>PC-021: Live payload ready</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"start_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"end_time"</span>: <span class="code-keyword">null</span>,
  <span class="code-quote">"view_type"</span>: 0,
  ...
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Verify RabbitMQ healthy</td>
<td class='confluenceTd'>Connection test</td>
<td class='confluenceTd'>Connected</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Block RabbitMQ</td>
<td class='confluenceTd'>Network/credentials</td>
<td class='confluenceTd'>Blocked</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>POST /config/
{task_id}</td>
<td class='confluenceTd'>Live</td>
<td class='confluenceTd'>HTTP 503 or 502</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check error</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>"RabbitMQ unavailable"</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Verify no resources</td>
<td class='confluenceTd'>kubectl</td>
<td class='confluenceTd'>No Job/Service</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Check logs</td>
<td class='confluenceTd'>Server</td>
<td class='confluenceTd'>Error logged</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Restore RabbitMQ</td>
<td class='confluenceTd'>Unblock</td>
<td class='confluenceTd'>Restored</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>POST /config again</td>
<td class='confluenceTd'>Same</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Proper 5xx during outage</li>
	<li>No resource allocation</li>
	<li>Quick recovery</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>RabbitMQ restored</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> outage_response.status_code <span class="code-keyword">in</span> [502, 503]
<span class="code-keyword">assert</span> <span class="code-quote">"rabbit"</span> <span class="code-keyword">in</span> error.lower()
<span class="code-keyword">assert</span> <span class="code-keyword">not</span> kubernetes.job_created()
<span class="code-keyword">assert</span> recovery_response.status_code == 200</pre>
</div></div>

<p><b>Environment:</b> Staging</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_rabbitmq_outage_resilience</tt><br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_resilience.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13767]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13767">Integration – MongoDB Outage Handling</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43296-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43296-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> Integration – MongoDB Outage Handling</p>

<p><b>Objective:</b> Ensure MongoDB outage fails gracefully without launching jobs.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, resilience, mongodb, outage</p>

<p><b>Requirements:</b> FOCUS-RESILIENCE-MONGO</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-010: MongoDB can be disabled (K8s access)</li>
	<li>PC-011: Historical payload ready</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"start_time"</span>: 1700000000,
  <span class="code-quote">"end_time"</span>: 1700000600,
  ...
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Verify MongoDB healthy</td>
<td class='confluenceTd'>kubectl</td>
<td class='confluenceTd'>Running</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Scale MongoDB to 0</td>
<td class='confluenceTd'>kubectl scale</td>
<td class='confluenceTd'>Stopped</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Verify unreachable</td>
<td class='confluenceTd'>Connection test</td>
<td class='confluenceTd'>Refused</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>POST /config/
{task_id}</td>
<td class='confluenceTd'>Historical</td>
<td class='confluenceTd'>HTTP 503</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check error</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>"MongoDB unavailable"</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify no K8s job</td>
<td class='confluenceTd'>kubectl</td>
<td class='confluenceTd'>No new jobs</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Check server</td>
<td class='confluenceTd'>Logs</td>
<td class='confluenceTd'>Still running</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Restore MongoDB</td>
<td class='confluenceTd'>kubectl scale</td>
<td class='confluenceTd'>Restored</td>
</tr>
<tr>
<td class='confluenceTd'>9</td>
<td class='confluenceTd'>POST /config again</td>
<td class='confluenceTd'>Same</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Clean 503 during outage</li>
	<li>No resource leaks</li>
	<li>Automatic recovery</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>MongoDB restored</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> outage_response.status_code == 503
<span class="code-keyword">assert</span> <span class="code-quote">"mongo"</span> <span class="code-keyword">in</span> error.lower()
<span class="code-keyword">assert</span> <span class="code-keyword">not</span> kubernetes.new_jobs_created()
<span class="code-keyword">assert</span> recovery_response.status_code == 200</pre>
</div></div>

<p><b>Environment:</b> Staging (K8s required)</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_mongodb_outage_resilience</tt><br/>
<b>Test File:</b> <tt>tests/integration/infrastructure/test_resilience.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13766]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13766"> API – POST /recordings_in_time_range – Returns Recording Windows</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43295-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43295-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – POST /recordings_in_time_range – Returns Recording Windows</p>

<p><b>Objective:</b> Validate endpoint returns recordings that intersect time range.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, api, history, recordings</p>

<p><b>Requirements:</b> FOCUS-API-RECORDINGS</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-010: MongoDB accessible</li>
	<li>PC-011: Recordings exist</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{
  <span class="code-quote">"start_time"</span>: 1700000000,
  <span class="code-quote">"end_time"</span>: 1700000600
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>POST /recordings_in_time_range</td>
<td class='confluenceTd'>Time window</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate format</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>List of <span class="error">&#91;start, end&#93;</span></td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Check overlap</td>
<td class='confluenceTd'>Each recording</td>
<td class='confluenceTd'>Overlaps request</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Validate timestamps</td>
<td class='confluenceTd'>Values</td>
<td class='confluenceTd'>Valid epochs</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check ordering</td>
<td class='confluenceTd'>List</td>
<td class='confluenceTd'>Sorted by start</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Test empty range</td>
<td class='confluenceTd'>Future time</td>
<td class='confluenceTd'>Empty list</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Correct recordings returned</li>
	<li>Proper overlap</li>
	<li>Sorted results</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 200
<span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(response.json(), <span class="code-object">list</span>)
<span class="code-keyword">assert</span> <span class="code-object">all</span>(r[0] &lt; req_end <span class="code-keyword">and</span> r[1] &gt; req_start <span class="code-keyword">for</span> r <span class="code-keyword">in</span> recordings)</pre>
</div></div>

<p><b>Environment:</b> Staging/Production</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_post_recordings_in_time_range</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_history_endpoints.py</tt></p>

<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13765]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13765">API – GET /live_metadata – Returns 404 When Unavailable</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43294-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43294-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – GET /live_metadata – Returns 404 When Unavailable</p>

<p><b>Objective:</b> Validate proper 404 when metadata not available.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, api, metadata, negative-test</p>

<p><b>Requirements:</b> FOCUS-API-METADATA</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: fiber_metadata NOT configured</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request)</p>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Ensure metadata=None</td>
<td class='confluenceTd'>Server config</td>
<td class='confluenceTd'>Not available</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>GET /live_metadata</td>
<td class='confluenceTd'>None</td>
<td class='confluenceTd'>HTTP 404</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate error</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>"Not available" message</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check no crash</td>
<td class='confluenceTd'>Logs</td>
<td class='confluenceTd'>No exceptions</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Clean 404</li>
	<li>Clear message</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 404
<span class="code-keyword">assert</span> <span class="code-quote">"<span class="code-keyword">not</span> available"</span> <span class="code-keyword">in</span> response.json()[<span class="code-quote">'error'</span>].lower()</pre>
</div></div>

<p><b>Environment:</b> Dev without metadata</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_get_live_metadata_missing</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_info_endpoints.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13764]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13764"> API – GET /live_metadata – Returns Metadata When Available</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43293-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43293-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – GET /live_metadata – Returns Metadata When Available</p>

<p><b>Objective:</b> Validate live metadata endpoint returns complete fiber metadata.</p>

<p><b>Priority:</b> Medium</p>

<p><b>Components/Labels:</b> focus-server, api, metadata, live</p>

<p><b>Requirements:</b> FOCUS-API-METADATA</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: fiber_metadata configured</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request)</p>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>GET /live_metadata</td>
<td class='confluenceTd'>None</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate schema</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>Contains dx, prr, fiber_*</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Check dx</td>
<td class='confluenceTd'>Value</td>
<td class='confluenceTd'><blockquote><p>0 </p></blockquote></td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check prr</td>
<td class='confluenceTd'>Value</td>
<td class='confluenceTd'><blockquote><p>0 </p></blockquote></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Validate all fields</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>No nulls</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Complete metadata returned</li>
	<li>All fields populated</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 200
<span class="code-keyword">assert</span> response.json()[<span class="code-quote">'dx'</span>] &gt; 0
<span class="code-keyword">assert</span> response.json()[<span class="code-quote">'prr'</span>] &gt; 0</pre>
</div></div>

<p><b>Environment:</b> Dev/Staging with metadata</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_get_live_metadata_present</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_info_endpoints.py</tt> </p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13762]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13762">API – GET /channels – Returns System Channel Bounds</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43291-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43291-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – GET /channels – Returns System Channel Bounds</p>

<p><b>Objective:</b> Validate channel range endpoint returns authoritative bounds.</p>

<p><b>Priority:</b> High</p>

<p><b>Components/Labels:</b> focus-server, api, channels, info</p>

<p><b>Requirements:</b> FOCUS-API-CHANNELS</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-001: API reachable</li>
	<li>PC-002: FocusManager.channels configured</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request)</p>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>GET /channels</td>
<td class='confluenceTd'>None</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate schema</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>Contains lowest_channel, highest_channel</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Check lowest_channel</td>
<td class='confluenceTd'>Value</td>
<td class='confluenceTd'>== 1</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Check highest_channel</td>
<td class='confluenceTd'>Value</td>
<td class='confluenceTd'><blockquote><p>0, matches config </p></blockquote></td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Call 5 times</td>
<td class='confluenceTd'>None</td>
<td class='confluenceTd'>Consistent results</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Check response time</td>
<td class='confluenceTd'>Latency</td>
<td class='confluenceTd'>&lt; 100ms</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Returns configured bounds</li>
	<li>Consistent across calls</li>
	<li>Fast response</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 200
<span class="code-keyword">assert</span> response.json()[<span class="code-quote">'lowest_channel'</span>] == 1
<span class="code-keyword">assert</span> response.json()[<span class="code-quote">'highest_channel'</span>] &gt; 0</pre>
</div></div>

<p><b>Environment:</b> Any</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_get_channels</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_info_endpoints.py</tt> </p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13761]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13761">API – POST /config/{task_id} – Invalid Frequency Range Rejection</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43289-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43289-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – POST /config/</p>
{task_id} – Invalid Frequency Range Rejection<br/>
<br/>
<b>Objective:</b> Validate rejection of malformed frequency ranges.<br/>
<br/>
<b>Priority:</b> High<br/>
<br/>
<b>Components/Labels:</b> focus-server, api, validation, negative-test<br/>
<br/>
<b>Requirements:</b> FOCUS-API-VALIDATION<br/>
<br/>
<b>Pre-Conditions:</b><br/>
<br/>
* PC-001: API reachable<br/>
<br/>
<b>Test Data:</b><br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Test A - min &gt; max:
{
  <span class="code-quote">"frequencyRange"</span>: { <span class="code-quote">"min"</span>: 500, <span class="code-quote">"max"</span>: 0 },
  ...
}

Test B - negative:
{
  <span class="code-quote">"frequencyRange"</span>: { <span class="code-quote">"min"</span>: -100, <span class="code-quote">"max"</span>: 500 },
  ...
}</pre>
</div></div><br/>
<br/>
<b>Steps:</b><br/>
<br/>
||#||Action||Data||Expected Result||<br/>
|1|POST /config/{task_id}
<p>|min &gt; max|HTTP 400|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate error</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>"Invalid frequency range"</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>POST /config/
{task_id}</td>
<td class='confluenceTd'>Negative</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Test valid range</td>
<td class='confluenceTd'>min=0, max=1000</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Invalid rejected</li>
	<li>Valid accepted</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> invalid_response.status_code == 400
<span class="code-keyword">assert</span> <span class="code-quote">"frequency"</span> <span class="code-keyword">in</span> error_message.lower()</pre>
</div></div>

<p><b>Environment:</b> Any</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_config_invalid_frequency</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_config_validation.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13760]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13760">API – POST /config/{task_id} – Invalid Channel Range Rejection</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43288-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43288-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – POST /config/</p>
{task_id} – Invalid Channel Range Rejection<br/>
<br/>
<b>Objective:</b> Confirm server blocks illegal channel windows (min &gt; max, negative, out of bounds).<br/>
<br/>
<b>Priority:</b> High<br/>
<br/>
<b>Components/Labels:</b> focus-server, api, validation, negative-test<br/>
<br/>
<b>Requirements:</b> FOCUS-API-VALIDATION<br/>
<br/>
<b>Pre-Conditions:</b><br/>
<br/>
* PC-001: API reachable<br/>
* PC-002: System max channels known<br/>
<br/>
<b>Test Data:</b><br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Test A - min &gt; max:
{
  <span class="code-quote">"channels"</span>: { <span class="code-quote">"min"</span>: 300, <span class="code-quote">"max"</span>: 100 },
  ...
}

Test B - negative:
{
  <span class="code-quote">"channels"</span>: { <span class="code-quote">"min"</span>: -5, <span class="code-quote">"max"</span>: 10 },
  ...
}

Test C - out of bounds:
{
  <span class="code-quote">"channels"</span>: { <span class="code-quote">"min"</span>: 1, <span class="code-quote">"max"</span>: 99999 },
  ...
}</pre>
</div></div><br/>
<br/>
<b>Steps:</b><br/>
<br/>
||#||Action||Data||Expected Result||<br/>
|1|POST /config/{task_id}
<p>|min &gt; max|HTTP 400|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Check error</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>"Invalid channel range"</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>POST /config/
{task_id}|Negative|HTTP 400|<br/>
|4|POST /config/{task_id}</td>
<td class='confluenceTd'>Out of bounds</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Test boundary</td>
<td class='confluenceTd'>min=1, max=max_channels</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Invalid ranges rejected</li>
	<li>Boundary values work</li>
	<li>Clear errors</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> invalid_response.status_code == 400
<span class="code-keyword">assert</span> <span class="code-quote">"channel"</span> <span class="code-keyword">in</span> error_message.lower()
<span class="code-keyword">assert</span> boundary_response.status_code == 200</pre>
</div></div>

<p><b>Environment:</b> Any</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_config_invalid_channels</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_config_validation.py</tt></p>

<hr />
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13759]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13759">API – POST /config/{task_id} – Invalid Time Range Rejection</a>
            <span class="subText">
               Created: 20/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-43287-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-43287-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – POST /config/</p>
{task_id} – Invalid Time Range Rejection<br/>
<br/>
<b>Objective:</b> Ensure invalid time ranges (start &gt;= end) are rejected with proper 400 error.<br/>
<br/>
<b>Priority:</b> High<br/>
<br/>
<b>Components/Labels:</b> focus-server, api, validation, negative-test<br/>
<br/>
<b>Requirements:</b> FOCUS-API-VALIDATION<br/>
<br/>
<b>Pre-Conditions:</b><br/>
<br/>
* PC-001: API reachable<br/>
<br/>
<b>Test Data:</b><br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Test Case A - start &gt; end:
{
  <span class="code-quote">"start_time"</span>: 1700000600,
  <span class="code-quote">"end_time"</span>: 1700000000,
  <span class="code-quote">"view_type"</span>: 0,
  ...
}

Test Case B - start == end:
{
  <span class="code-quote">"start_time"</span>: 1700000000,
  <span class="code-quote">"end_time"</span>: 1700000000,
  <span class="code-quote">"view_type"</span>: 0,
  ...
}</pre>
</div></div><br/>
<br/>
<b>Steps:</b><br/>
<br/>
||#||Action||Data||Expected Result||<br/>
|1|Generate task_id|Unique ID|Valid task_id|<br/>
|2|POST /config/{task_id}
<p>|start &gt; end|HTTP 400|</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate error message</td>
<td class='confluenceTd'>Response</td>
<td class='confluenceTd'>Contains "Invalid time range"</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>POST /config/
{task_id}</td>
<td class='confluenceTd'>start == end</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>Check no task created</td>
<td class='confluenceTd'>System</td>
<td class='confluenceTd'>Task doesn't exist</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Verify logs</td>
<td class='confluenceTd'>Server logs</td>
<td class='confluenceTd'>Validation error logged</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Invalid time ranges rejected with 400</li>
	<li>Clear error messages</li>
	<li>No task creation</li>
</ul>


<p><b>Post-Conditions:</b><br/>
None</p>

<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 400
<span class="code-keyword">assert</span> <span class="code-quote">"time <span class="code-object">range</span>"</span> <span class="code-keyword">in</span> response.json()[<span class="code-quote">'error'</span>].lower()
<span class="code-keyword">assert</span> <span class="code-keyword">not</span> task_exists(task_id)</pre>
</div></div>

<p><b>Environment:</b> Any</p>

<p><b>Automation Status:</b> TO BE AUTOMATED<br/>
<b>Test Function:</b> <tt>test_config_invalid_time_range</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_config_validation.py</tt> (NEW FILE)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13705]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13705">Data Lifecycle – Historical vs Live Recordings Classification</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42987-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42987-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Requirements</p>

<p>
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
 (Data Quality – Mongo collections and schema)</p>

<p>FOCUS-DATA-LIFECYCLE (Recording lifecycle management)</p>

<p>FOCUS-CLEANUP-SERVICE (Data cleanup and retention)</p>

<p>Objective</p>

<p>Validate that MongoDB correctly distinguishes between Historical (completed), Live (in-progress), and Deleted (cleanup) recordings. Verify that the recording lifecycle is properly managed and that cleanup services (Sweeper/Data Manager) are functioning correctly.</p>

<p>Business Impact:</p>

<p>Historical recordings must be properly indexed for history playback via POST /recordings_in_time_range</p>

<p>Live recordings must be distinguished from stale/crashed recordings</p>

<p>Deleted recordings must be properly marked for cleanup</p>

<p>Missing end_time on deleted recordings indicates improper cleanup logic</p>

<p>Pre-Conditions</p>

<p>PC-010: MongoDB is reachable and accessible</p>

<p>PC-013: Recording collection exists and contains data</p>

<p>PC-021: Recording collection is dynamically named (GUID-based)</p>

<p>PC-022: base_paths collection contains GUID for recording collection</p>

<p>PC-023: System has active or historical recordings</p>

<p>Architectural Context</p>

<p>MongoDB Role in Focus/Panda System</p>

<p>MongoDB serves as a metadata index for recordings:</p>

<p>Purpose: Store metadata for recordings (NOT raw data)</p>

<p>Used by: Focus Server &amp; Baby Analyzer</p>

<p>Function: Find raw files (PRP2/SEGY) in S3/local storage for specific time ranges</p>

<p>API: POST /recordings_in_time_range requires start_time and end_time</p>

<p>Recording Types</p>

<p>Type</p>

<p>Description</p>

<p>Schema</p>

<p>Status</p>

<p>Historical </p>

<p>Completed recordings </p>

<p>Has start_time AND end_time, deleted=False </p>

<p>Normal ✅ </p>

<p>Live </p>

<p>Currently recording </p>

<p>Has start_time, NO end_time (yet), deleted=False </p>

<p>Normal ✅ </p>

<p>Deleted </p>

<p>Soft-deleted recordings </p>

<p>Has deleted=True </p>

<p>Cleanup ⚠️ </p>

<p>Stale </p>

<p>Crashed/failed recordings </p>

<p>Old (&gt;24h) with NO end_time, deleted=False </p>

<p>Bug ❌ </p>

<p>Test Data</p>

<p>Database name: prisma (staging)</p>

<p>Collections:</p>

<p>base_paths - contains GUID for recording collection</p>

{GUID} - dynamic recording collection (e.g., 77e49b5d-e06a-4aae-a33e-17117418151c)<br/>
{GUID}
<p>-unrecognized_recordings - failed recognition recordings</p>

<p>Expected Recording Fields:</p>

<p>uuid (string, unique) - Recording identifier</p>

<p>start_time (datetime) - Recording start timestamp</p>

<p>end_time (datetime or null) - Recording end timestamp</p>

<p>deleted (boolean) - Soft delete flag</p>

<p>Thresholds:</p>

<p>Stale threshold: 24 hours (recordings older than 24h without end_time)</p>

<p>Historical majority: &gt;50% of recordings should be completed</p>

<p>Test Steps</p>

<p>#</p>

<p>Action</p>

<p>Data</p>

<p>Expected Result</p>

<p>SETUP </p>

<p>1 </p>

<p>Connect to MongoDB </p>

<p>Database name from config </p>

<p>Connection successful </p>

<p>2 </p>

<p>Access base_paths collection </p>

<p>Collection name: "base_paths" </p>

<p>Collection accessible </p>

<p>3 </p>

<p>Get dynamic recording collection GUID </p>

<p>Query base_paths for GUID </p>

<p>GUID retrieved </p>

<p>4 </p>

<p>Access recording collection </p>

<p>Collection name: </p>
{GUID}
<p> </p>

<p>Collection accessible </p>

<p>5 </p>

<p>Count total recordings </p>

<p>count_documents({}) </p>

<p>Total count &gt; 0 </p>

<p>CLASSIFICATION </p>

<p>6 </p>

<p>Count Historical recordings </p>

<p>Query: {start_time: exists, end_time: {$ne: null}, deleted: false} </p>

<p>Count returned </p>

<p>7 </p>

<p>Count Live recordings </p>

<p>Query: </p>
{start_time: exists, end_time: null, deleted: false}
<p> </p>

<p>Count returned </p>

<p>8 </p>

<p>Count Deleted recordings </p>

<p>Query: </p>
{deleted: true}
<p> </p>

<p>Count returned </p>

<p>9 </p>

<p>Count Invalid recordings </p>

<p>Query: {start_time: {$exists: false}} </p>

<p>Should be 0 </p>

<p>10 </p>

<p>Calculate percentages </p>

<p>(count / total) * 100 </p>

<p>Percentages calculated </p>

<p>11 </p>

<p>Log classification summary </p>

<p>All categories </p>

<p>Summary displayed </p>

<p>VALIDATION </p>

<p>12 </p>

<p>Sample Historical recordings </p>

<p>Limit: 5, sort by start_time </p>

<p>Retrieve 5 records </p>

<p>13 </p>

<p>Verify Historical have complete metadata </p>

<p>Check: uuid, start_time, end_time, deleted </p>

<p>All fields present </p>

<p>14 </p>

<p>Calculate recording durations </p>

<p>(end_time - start_time) in hours </p>

<p>Duration calculated </p>

<p>15 </p>

<p>Log Historical samples </p>

<p>UUID, Start, End, Duration </p>

<p>Details displayed </p>

<p>LIVE ANALYSIS </p>

<p>16 </p>

<p>Check Live recordings age </p>

<p>For each Live, calculate age from start_time </p>

<p>Age in hours </p>

<p>17 </p>

<p>Identify stale Live recordings </p>

<p>Filter: age &gt; 24 hours </p>

<p>Stale recordings listed </p>

<p>18 </p>

<p>If stale found, log details </p>

<p>UUID, age, start_time </p>

<p>Warning displayed </p>

<p>19 </p>

<p>If no stale, confirm all Live are recent </p>

<p>Age &lt; 24 hours </p>

<p>Success message </p>

<p>CLEANUP SERVICE </p>

<p>20 </p>

<p>Count Deleted with end_time </p>

<p>Query: {deleted: true, end_time: {$ne: null}} </p>

<p>Count returned </p>

<p>21 </p>

<p>Count Deleted without end_time </p>

<p>Query: </p>
{deleted: true, end_time: null}
<p> </p>

<p>Count returned </p>

<p>22 </p>

<p>Calculate Deleted percentages </p>

<p>(count / total_deleted) * 100 </p>

<p>Percentages calculated </p>

<p>23 </p>

<p>Sample Deleted recordings </p>

<p>Limit: 3 </p>

<p>Retrieve 3 deleted records </p>

<p>24 </p>

<p>For each Deleted, calculate age </p>

<p>(now - start_time) in days </p>

<p>Age calculated </p>

<p>25 </p>

<p>Log Deleted samples </p>

<p>UUID, Started, Age, Has end_time </p>

<p>Details displayed </p>

<p>26 </p>

<p>If no Deleted, note cleanup status </p>

<p>Check if cleanup service active </p>

<p>Note displayed </p>

<p>ASSERTIONS </p>

<p>27 </p>

<p>Assert: No invalid recordings </p>

<p>invalid_count == 0 </p>

<p>PASS if 0, FAIL otherwise </p>

<p>28 </p>

<p>Assert: Classification integrity </p>

<p>historical + live + deleted == total </p>

<p>PASS if match </p>

<p>29 </p>

<p>Assert: Historical majority </p>

<p>(historical / total) &gt; 0.50 </p>

<p>PASS if &gt;50% </p>

<p>30 </p>

<p>Log final test result </p>

<p>Overall status </p>

<p>Test result displayed </p>

<p>Expected Result (overall)</p>

<p>Classification Results</p>

<p>Historical (completed): ~99% of total recordings</p>

<p>Live (in-progress): &lt;1% of total recordings (recent, &lt;24h old)</p>

<p>Deleted (cleanup): &lt;1% of total recordings</p>

<p>Invalid (no start_time): 0 recordings ✅</p>

<p>Stale (crashed/failed): 0 recordings ✅</p>

<p>Data Integrity</p>

<p>✅ All recordings have start_time</p>

<p>✅ Classification totals match overall count</p>

<p>✅ Historical recordings are the majority (&gt;50%)</p>

<p>✅ All Historical recordings have complete metadata (uuid, start_time, end_time)</p>

<p>✅ Live recordings are recent (&lt;24 hours old)</p>

<p>⚠️ Deleted recordings may be missing end_time (deleted while running)</p>

<p>Cleanup Service Behavior</p>

<p>Cleanup service (Sweeper/Data Manager) sets deleted=True</p>

<p>Some deleted recordings may lack end_time (indicates deletion during recording)</p>

<p>Pattern analysis of deleted recordings shows cleanup policy (age, retention)</p>

<p>Post-Conditions</p>

<p>None (read-only test)</p>

<p>Note: If test identifies issues (stale recordings, improper cleanup), these should be reported but do not affect test cleanup.</p>

<p>Attachments</p>

<p>Recording classification report (JSON/CSV)</p>

<p>Sample Historical recordings (JSON)</p>

<p>Sample Deleted recordings (JSON)</p>

<p>Stale recordings list (if any found)</p>

<p>Test execution log with full details</p>

<p>Authentication</p>

<p>MongoDB credentials from environments.yaml</p>

<p>Read-only access required (no write operations)</p>

<p>Assertions</p>

<p>Critical Assertions (Test FAILS if violated)</p>

<p>No Invalid Recordings:</p>

<p>assert invalid_count == 0, </p>

<p>f"Found </p>
{invalid_count}
<p> recordings without start_time!"</p>

<p>Classification Integrity:</p>

<p>assert (historical_count + live_count + deleted_count) == total_count, </p>

<p>f"Classification mismatch: </p>
{classified}
<p> vs </p>
{total}
<p>"</p>

<p>Historical Majority:</p>

<p>assert (historical_count / total_count) &gt; 0.50, </p>

<p>f"Historical recordings only </p>
{percentage:.1f}
<p>% (expected &gt;50%)"</p>

<p>Warning Assertions (Test WARNS but doesn't FAIL)</p>

<p>Stale Recordings Detection:</p>

<p>if stale_count &gt; 0:<br/>
logger.warning(f"Found </p>
{stale_count}
<p> stale recordings (&gt;24h without end_time)")</p>

<p>Deleted Missing end_time:</p>

<p>if deleted_without_endtime &gt; 0:<br/>
logger.warning(f"</p>
{deleted_without_endtime}
<p> deleted recordings missing end_time")</p>

<p>Automation Status</p>

<p>✅ Automated with Pytest</p>

<p>Test Function: test_historical_vs_live_recordings  <br/>
Test File: tests/integration/infrastructure/test_mongodb_data_quality.py  <br/>
Test Class: TestMongoDBDataQuality</p>

<p>Execution Command</p>

<ol>
	<li>Run this test alone<br/>
pytest tests/integration/infrastructure/test_mongodb_data_quality.py::TestMongoDBDataQuality::test_historical_vs_live_recordings -v</li>
</ol>


<ol>
	<li>Run with detailed output<br/>
pytest tests/integration/infrastructure/test_mongodb_data_quality.py::TestMongoDBDataQuality::test_historical_vs_live_recordings -v -s</li>
</ol>


<ol>
	<li>Run all data lifecycle tests<br/>
pytest -m data_lifecycle -v</li>
</ol>


<ol>
	<li>Run all MongoDB data quality tests<br/>
pytest tests/integration/infrastructure/test_mongodb_data_quality.py -v</li>
</ol>


<p>Related Issues</p>

<p>
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
 (Parent - MongoDB Data Quality)</p>

<p>T-DATA-001 (Soft Delete Implementation - Related test)</p>

<p>BUG-CLEANUP-001 (Deleted recordings missing end_time - Discovered by this test)</p>

<p>Sample Historical Recordings</p>

<p>UUID</p>

<p>Duration</p>

<p>Status</p>

<p>38e432b0-7c87-468c-9b85-fd48462d8901 </p>

<p>1.97 hours </p>

<p>✅ Valid </p>

<p>2b58e51e-50fd-4ad8-a623-46f5d48c9e8b </p>

<p>0.01 hours </p>

<p>✅ Valid </p>

<p>55c582e8-1de4-4a03-b7e2-bd803e03264f </p>

<p>0.02 hours </p>

<p>✅ Valid </p>

<p>Deleted Recordings Analysis</p>

<p>With end_time: 0 (0%)</p>

<p>Without end_time: 24 (100%)</p>

<p>Age: 84 days (all deleted on 2025-07-23)</p>

<p>Pattern: Bulk cleanup operation or retention policy</p>

<p>Performance Metrics</p>

<p>Test Duration: ~10 seconds</p>

<p>Database Queries: 15 queries</p>

<p>Data Scanned: 3,439 recordings</p>

<p>Memory Usage: Low (streaming queries)</p>

<p>Known Limitations</p>

<p>24-hour heuristic for stale detection:</p>

<p>Recordings older than 24h without end_time are flagged as stale</p>

<p>May have false positives for extremely long recordings</p>

<p>Recommendation: Add explicit status field in future</p>

<p>Dynamic collection naming:</p>

<p>Test depends on base_paths collection to find recording collection GUID</p>

<p>If base_paths is missing or corrupted, test will fail</p>

<p>Cleanup service identification:</p>

<p>Test can detect cleanup behavior but cannot identify which service performed cleanup</p>

<p>Action required: Manual confirmation with development team</p>

<p>Success Criteria</p>

<p>Test PASSES if:</p>

<p>✅ All recordings have start_time (no invalid records)</p>

<p>✅ Classification totals match overall count</p>

<p>✅ Historical recordings are &gt;50% of total</p>

<p>✅ All Historical recordings have complete metadata</p>

<p>✅ Live recordings are recent (&lt;24h old)</p>

<p>✅ No stale recordings detected</p>

<p>Test WARNS if:</p>

<p>⚠️ Deleted recordings missing end_time</p>

<p>⚠️ Live recordings count is unusually high (&gt;5%)</p>

<p>⚠️ Recognition rate is low (&lt;80%)</p>

<p>Test FAILS if:</p>

<p>❌ Any recordings missing start_time</p>

<p>❌ Classification doesn't match total count</p>

<p>❌ Historical recordings &lt;50% (indicates cleanup issues)</p>

<p>❌ Stale recordings detected (&gt;24h without end_time, not deleted)</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13687]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13687">MongoDB Recovery – Recordings Indexed After Outage</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42961-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            performance_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42961-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Test Summary:<br/>
Validates that recordings added to storage during a MongoDB outage are automatically indexed once MongoDB recovers.</p>

<p>Summary: Focus Server – MongoDB Recovery and Indexing</p>

<p>Objective: Confirm that new recordings are indexed post-outage without manual intervention.</p>

<p>Priority: Critical</p>

<p>Components/Labels: focus-server, mongodb, resilience, recovery, indexing, data-sync</p>

<p>Requirements: 
    <span class="jira-issue-macro" data-jira-key="PZ-13604" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13604" class="jira-issue-macro-key issue-link"  title="Integration – Orchestrator error triggers rollback" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13604
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
, FOCUS-RESILIENCE-RECOVERY</p>

<p>Pre-Conditions:</p>

<p>MongoDB is healthy.</p>

<p>Kubernetes access available.</p>

<p>Focus Server recovery mechanism active.</p>

<p>Recording storage available.</p>

<p>Test Data:<br/>
Namespace: default<br/>
Deployment: mongodb<br/>
New recording file created during outage.</p>

<p>Steps:<br/>
a. Action: Verify MongoDB health<br/>
Expected: Connection successful</p>

<p>b. Action: Count existing recordings<br/>
Expected: Returns count N</p>

<p>c. Action: Simulate outage<br/>
Data: Scale replicas=0<br/>
Expected: Mongo unreachable</p>

<p>d. Action: Add new recording file<br/>
Expected: File created successfully</p>

<p>e. Action: Recover MongoDB<br/>
Data: Scale replicas=1<br/>
Expected: Mongo accessible</p>

<p>f. Action: Wait for recovery indexing<br/>
Expected: New recording indexed automatically</p>

<p>g. Action: Verify new recording appears<br/>
Expected: Found in node4</p>

<p>Expected Result (overall):<br/>
MongoDB recovery triggers automatic indexing of new recordings. No data loss occurs.</p>

<p>Post-Conditions:</p>

<p>MongoDB restored</p>

<p>Test recording cleaned up</p>

<p>Assertions:</p>

<p>Outage simulated successfully</p>

<p>Recovery completed</p>

<p>New recording indexed automatically</p>

<p>Count increases by +1</p>

<p>Environment:<br/>
Staging only (requires Kubernetes access)</p>

<p>Automation Status:<br/>
Automated integration test with Pytest<br/>
Test Function: test_mongodb_recovery_indexes_pending_recordings<br/>
Test File: tests/integration/infrastructure/test_mongodb_outage_resilience.py</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13686]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13686">Data Quality – MongoDB Indexes Validation</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42960-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42960-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Test Summary:<br/>
Ensures critical indexes exist on node4 for efficient queries. Missing indexes degrade performance during time-based lookups.</p>

<p>Summary: Focus Server – MongoDB Indexes Validation</p>

<p>Objective: Verify the existence of required indexes on node4.</p>

<p>Priority: High</p>

<p>Components/Labels: focus-server, mongodb, data-quality, performance, indexes</p>

<p>Requirements: 
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
, FOCUS-PERF-QUERY</p>

<p>Pre-Conditions:</p>

<p>MongoDB reachable.</p>

<p>node4 collection exists.</p>

<p>Database admin access available.</p>

<p>Test Data:<br/>
Expected indexes:</p>

<p>start_time (ascending)</p>

<p>end_time (ascending)</p>

<p>uuid (unique, ascending)</p>

<p>deleted (ascending)</p>

<p>Steps:<br/>
a. Action: List indexes on node4<br/>
Expected: Index list returned</p>

<p>b. Action: Verify index<br/>
Data: start_time asc<br/>
Expected: Found</p>

<p>c. Action: Verify index<br/>
Data: end_time asc<br/>
Expected: Found</p>

<p>d. Action: Verify unique index<br/>
Data: uuid asc<br/>
Expected: Found and marked unique</p>

<p>e. Action: Verify index<br/>
Data: deleted asc<br/>
Expected: Found</p>

<p>Expected Result (overall):<br/>
All expected indexes exist and are correctly configured.</p>

<p>Post-Conditions:<br/>
None</p>

<p>Assertions:</p>

<p>Indexes found on all required fields</p>

<p>uuid is unique</p>

<p>No missing indexes</p>

<p>Environment:<br/>
Any (Dev / Staging / Production)</p>

<p>Automation Status:<br/>
Automated integration test with Pytest<br/>
Test Function: test_mongodb_indexes_exist_and_optimal<br/>
Test File: tests/integration/infrastructure/test_mongodb_data_quality.py</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13685]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13685">Data Quality – Recordings Metadata Completeness</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42959-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42959-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Test Summary:<br/>
Verifies that all recordings in node4 have complete metadata. Missing metadata indicates data corruption and impacts history playback.</p>

<p>Summary: Focus Server – Recordings Metadata Completeness</p>

<p>Objective: Validate metadata completeness for all recordings in node4.</p>

<p>Priority: Critical</p>

<p>Components/Labels: focus-server, mongodb, data-quality, data-integrity, recordings</p>

<p>Requirements: 
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
</p>

<p>Pre-Conditions:</p>

<p>MongoDB is reachable.</p>

<p>node4 collection exists.</p>

<p>Real recording data is available.</p>

<p>Test Data:</p>

<p>Collection: node4</p>

<p>Fields: uuid, start_time, end_time, deleted</p>

<p>Steps:<br/>
a. Action: Access node4 collection<br/>
Expected: Collection accessible</p>

<p>b. Action: Count total documents<br/>
Expected: Count returned</p>

<p>c. Action: Count missing values per field<br/>
Expected: Zero missing for all critical fields</p>

<p>d. Action: Identify orphaned records<br/>
Expected: No documents missing ≥2 critical fields</p>

<p>e. Action: Generate completeness report<br/>
Expected: Report summary logged (CSV/JSON)</p>

<p>Expected Result (overall):<br/>
All recordings have full metadata; no missing or null fields; no orphaned records.</p>

<p>Post-Conditions:<br/>
None (read-only)</p>

<p>Assertions:</p>

<p>No missing metadata fields</p>

<p>No nulls</p>

<p>No orphaned records</p>

<p>Environment:<br/>
Staging / Production</p>

<p>Automation Status:<br/>
Automated integration test with Pytest<br/>
Test Function: test_recordings_have_all_required_metadata<br/>
Test File: tests/integration/infrastructure/test_mongodb_data_quality.py</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13684]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13684">Data Quality – node4 Schema Validation</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42958-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42958-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Test Summary:<br/>
Ensures that documents in the node4 collection contain all required fields with correct data types to prevent playback or parsing errors.</p>

<p>Summary: Focus Server – node4 Schema Validation</p>

<p>Objective: Validate field existence and data types for node4 documents.</p>

<p>Priority: High</p>

<p>Components/Labels: focus-server, mongodb, data-quality, schema, node4</p>

<p>Requirements: 
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
</p>

<p>Pre-Conditions:</p>

<p>MongoDB is reachable.</p>

<p>node4 collection exists and contains data.</p>

<p>At least one document is available.</p>

<p>Test Data:</p>

<p>Collection: node4</p>

<p>Sample: up to 100 documents</p>

<p>Required fields: uuid, start_time, end_time, deleted</p>

<p>Steps:<br/>
a. Action: Access node4 collection<br/>
Data: Collection name = node4<br/>
Expected: Collection accessible</p>

<p>b. Action: Count total documents<br/>
Data: N/A<br/>
Expected: Count returned</p>

<p>c. Action: Sample up to 100 documents<br/>
Data: min(100, total)<br/>
Expected: Documents retrieved</p>

<p>d. Action: Validate field presence and type<br/>
Data: uuid, start_time, end_time, deleted<br/>
Expected: Fields exist and match expected type</p>

<p>e. Action: Check for null values<br/>
Data: Critical fields only<br/>
Expected: No null values present</p>

<p>Expected Result (overall):<br/>
All sampled documents have required fields, correct types, and no nulls.</p>

<p>Post-Conditions:<br/>
None (read-only)</p>

<p>Assertions:</p>

<p>All fields exist</p>

<p>Data types match expected types</p>

<p>No null values in critical fields</p>

<p>Environment:<br/>
Any (Dev / Staging / Production)</p>

<p>Automation Status:<br/>
Automated integration test with Pytest<br/>
Test Function: test_node4_schema_validation<br/>
Test File: tests/integration/infrastructure/test_mongodb_data_quality.py</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13683]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13683">Data Quality – MongoDB Collections Exist</a>
            <span class="subText">
               Created: 15/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42957-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42957-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Test Summary:<br/>
Validates that all required MongoDB collections exist. Missing collections cause Focus Server to fail during metadata queries or history playback.</p>

<p>Summary: Focus Server – Data Quality – MongoDB Collections Exist</p>

<p>Objective: Verify that base_paths, node2, and node4 collections exist in the database.</p>

<p>Priority: High</p>

<p>Components/Labels: focus-server, mongodb, data-quality, infrastructure, database</p>

<p>Requirements: 
    <span class="jira-issue-macro" data-jira-key="PZ-13598" >
                <a href="https://prismaphotonics.atlassian.net/browse/PZ-13598" class="jira-issue-macro-key issue-link"  title="Data Quality – Mongo collections and schema" >
            <img class="icon" src="https://prismaphotonics.atlassian.net/rest/api/2/universal_avatar/view/type/issuetype/avatar/10621?size=medium" />
            PZ-13598
        </a>
                                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-complete jira-macro-single-issue-export-pdf">TO DO</span>
            </span>
</p>

<p>Pre-Conditions:</p>

<p>MongoDB is reachable and accessible.</p>

<p>Database name is configured in environments.yaml.</p>

<p>Valid MongoDB credentials are available.</p>

<p>Test Data:</p>

<p>Database: prisma (staging) or focus_db (local).</p>

<p>Required collections: base_paths, node2, node4.</p>

<p>Steps:<br/>
a. Action: Connect to MongoDB<br/>
Data: Database name from config<br/>
Expected: Connection successful</p>

<p>b. Action: List all collections<br/>
Data: N/A<br/>
Expected: List of collections returned</p>

<p>c. Action: Verify collection existence<br/>
Data: base_paths, node2, node4<br/>
Expected: Each required collection is present</p>

<p>Expected Result (overall):<br/>
All required MongoDB collections exist. No missing or misnamed collections.</p>

<p>Post-Conditions:</p>

<p>None (read-only validation)</p>

<p>Assertions:</p>

<p>All required collections exist</p>

<p>No missing critical collections</p>

<p>Environment:<br/>
Any environment (Dev / Staging / Production)</p>

<p>Automation Status:<br/>
Automated integration test with Pytest<br/>
Test Function: test_required_collections_exist<br/>
Test File: tests/integration/infrastructure/test_mongodb_data_quality.py</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13604]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13604">Integration – Orchestrator error triggers rollback</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42581-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42581-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <ul class="alternate" type="square">
	<li>Summary: Focus Server – History configure – Mongo unavailable → 503, no orchestration</li>
	<li>Objective: Ensure dependency outage fails fast and clean without launching processing.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, integration, history, mongo, resilience</li>
	<li>Requirements: FOCUS-API-CONFIGURE</li>
	<li>Pre-Conditions:</li>
	<li>PC-040 Disable Mongo or block network to it</li>
	<li>Test Data:</li>
	<li>Valid history payload</li>
	<li>Steps:<br/>
  1) Action: POST /configure | Data: history payload | Expected: 503 (or documented), clear message; no job_id<br/>
  2) Action: K8s/Rabbit | Data: events/queues | Expected: no new resources<br/>
  3) Action: Logs | Data: server logs | Expected: dependency error; no crash</li>
	<li>Expected Result (overall):</li>
	<li>Clean failure; no side effects.</li>
	<li>Post-Conditions:</li>
	<li>None</li>
	<li>Attachments:</li>
	<li>Error/logs; dependency outage proof</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35103"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">08/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35103"><td bgcolor="#ffffff">
            <p>need to fix the test, the test should check that in case that MongDB is off for while and then return to work , the recordings that didnt processed in this time will be indexing after that  </p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13603]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13603">Integration – Mongo outage on History configure</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42580-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42580-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Summary: Focus Server – History configure – Mongo unavailable → 503, no orchestration</p>
<ul class="alternate" type="square">
	<li>Objective: Ensure dependency outage fails fast and clean without launching processing.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, integration, history, mongo, resilience</li>
	<li>Requirements: FOCUS-API-CONFIGURE</li>
	<li>Pre-Conditions:</li>
	<li>PC-040 Disable Mongo or block network to it</li>
	<li>Test Data:</li>
	<li>Valid history payload</li>
	<li>Steps:<br/>
  1) Action: POST /configure | Data: history payload | Expected: 503 (or documented), clear message; no job_id<br/>
  2) Action: K8s/Rabbit | Data: events/queues | Expected: no new resources<br/>
  3) Action: Logs | Data: server logs | Expected: dependency error; no crash</li>
	<li>Expected Result (overall):</li>
	<li>Clean failure; no side effects.</li>
	<li>Post-Conditions:</li>
	<li>None</li>
	<li>Attachments:</li>
	<li>Error/logs; dependency outage proof</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13602]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13602">Integration – RabbitMQ outage on Live configure</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 26/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42579-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42579-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>RabbitMQ is unavailable on the Live configure server, causing a fail fast situation without launching downstream resources.</p>

<h2><a name="Context"></a>Context</h2>

<p>The focus is on validating graceful upstream failure (AMQP) when RabbitMQ is blocked or credentials are invalid. This is a high-priority issue affecting the focus-server integration.</p>

<h2><a name="Acceptancecriteria"></a>Acceptance criteria</h2>

<ul>
	<li>Validate graceful failure without launching downstream resources.</li>
	<li>Expected outcomes for actions:
	<ol>
		<li><b>Action:</b> POST /configure
		<ul>
			<li><b>Data:</b> live payload</li>
			<li><b>Expected:</b> 503/502 error with a friendly message; no job_id.</li>
		</ul>
		</li>
		<li><b>Action:</b> K8s
		<ul>
			<li><b>Data:</b> events</li>
			<li><b>Expected:</b> no Job/Service created.</li>
		</ul>
		</li>
		<li><b>Action:</b> Logs
		<ul>
			<li><b>Data:</b> focus-server logs</li>
			<li><b>Expected:</b> upstream-unavailable entry; no crash/stacktrace.</li>
		</ul>
		</li>
	</ol>
	</li>
	<li>Proper 5xx mapping with a clear message and no resource leaks.</li>
</ul>


<h2><a name="Otherinformation"></a>Other information</h2>

<ul>
	<li><b>Components/Labels:</b> focus-server, integration, live, rabbit, resilience</li>
	<li><b>Requirements:</b> FOCUS-API-CONFIGURE</li>
	<li><b>Pre-Conditions:</b>
	<ul>
		<li>PC-030 RabbitMQ blocked/blackholed for test or credentials invalid</li>
	</ul>
	</li>
	<li><b>Test Data:</b> Valid live payload</li>
	<li><b>Post-Conditions:</b> None</li>
	<li><b>Attachments:</b>
	<ul>
		<li>Error body</li>
		<li>Rabbit health proof</li>
		<li>Logs</li>
	</ul>
	</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13601]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13601">Integration – History with empty window returns 400 and no side effects</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42578-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42578-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p> Summary: Focus Server – History configure – No recordings → 400, no Baby/K8s, no storage reads</p>
<ul class="alternate" type="square">
	<li>Objective: Ensure “no data” short-circuit with no orchestration nor storage scanning.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, integration, history, mongo, storage</li>
	<li>Requirements: FOCUS-API-CONFIGURE, FOCUS-API-REC-RANGE</li>
	<li>Pre-Conditions:</li>
	<li>PC-010 MONGO_URI reachable; selected window has no recordings</li>
	<li>Test Data:</li>
	<li>start_time/end_time where rec_mapper has zero hits</li>
	<li>Steps:<br/>
  1) Action: POST /configure | Data: empty-window payload | Expected: 400; message “No recording found…”<br/>
  2) Action: K8s | Data: events | Expected: no Job/Service created<br/>
  3) Action: Storage | Data: access logs/metrics | Expected: no storage read attempts<br/>
  4) Action: Mongo | Data: index | Expected: no new docs</li>
	<li>Expected Result (overall):</li>
	<li>Clean 400; no orchestration/storage activity.</li>
	<li>Post-Conditions:</li>
	<li>None</li>
	<li>Attachments:</li>
	<li>Mongo proof of zero hits; logs</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13600]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13600">Integration – Invalid configure does not launch orchestration</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42577-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            Integration_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42577-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Summary: Focus Server – Invalid configure – No orchestration, no side effects</p>

<ul class="alternate" type="square">
	<li>Objective: Prove invalid input is rejected with 4xx and does not start Baby/K8s/Rabbit nor mutate indexes.</li>
	<li>Priority: Critical</li>
	<li>Components/Labels: focus-server, integration, validation, k8s, rabbit, mongo</li>
	<li>Requirements: FOCUS-API-VALIDATION</li>
	<li>Pre-Conditions:</li>
	<li>PC-001 API reachable; focus-server logs accessible</li>
	<li>PC-020 Observability available (Rabbit mgmt/K8s API/read-only Mongo)</li>
	<li>Test Data:</li>
	<li>Payload: channels 
{min:300,max:100}
<p> or frequencyRange </p>
{min&gt;max}</li>
	<li>Steps:<br/>
  1) Action: POST /configure | Data: invalid payload | Expected: 400; structured error; no job_id<br/>
  2) Action: Check orchestrator activity | Data: K8s API/events | Expected: no Job/Service/YAML applied<br/>
  3) Action: Check Rabbit | Data: queues list | Expected: no new grpc-job-* queue created<br/>
  4) Action: Check Mongo | Data: relevant index collections | Expected: no new documents for this request<br/>
  5) Action: Check logs | Data: server logs | Expected: validation error; no stacktrace/5xx</li>
	<li>Expected Result (overall):</li>
	<li>4xx rejection with zero cross-component side effects.</li>
	<li>Post-Conditions:</li>
	<li>None</li>
	<li>Attachments:</li>
	<li>Error body, K8s/Rabbit snapshots, log excerpt (redacted)</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13599]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13599">Data Quality – Postgres connectivity and catalogs</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42576-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42576-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>Summary: Data Quality – Postgres – Connectivity and required system objects present</p>

<p>Objective: Validate DB connectivity and presence of core catalogs referenced by monitoring.</p>

<p>Components/Labels: data-quality, postgres, observability</p>

<p>Requirements: N/A (infra)</p>

<p>Pre-Conditions: POSTGRES_DSN reachable.</p>

<p>Test Data: N/A.</p>

<p>Steps:<br/>
  1) Action: Connect and run SELECT 1 | Data: N/A | Expected: returns 1<br/>
  2) Action: Check system relations | Data: pg_stat_activity, pg_database, pg_namespace | Expected: all present</p>

<p>Expected Result (overall): DB connectivity verified; required catalogs exist.</p>

<p>Post-Conditions: None</p>

<p>Attachments: ERD snippet or catalog list.</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13598]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13598">Data Quality – Mongo collections and schema</a>
            <span class="subText">
               Created: 05/Oct/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42575-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            data_quality_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42575-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <ul class="alternate" type="square">
	<li>Summary: Data Quality – Mongo – Collections exist and node4 schema sane</li>
	<li>Objective: Validate presence of critical collections and minimal schema integrity; detect illegal inserts.</li>
	<li>Priority: High</li>
	<li>Components/Labels: data-quality, mongo, history, rec-mapper</li>
	<li>Requirements: FOCUS-API-REC-RANGE</li>
	<li>Pre-Conditions:</li>
	<li>MONGO_URI and DB reachable; seeded data.</li>
	<li>Test Data:</li>
	<li>Collections: base_paths, node2, node4; node4 expected keys: uuid, start_time, end_time, deleted.</li>
	<li>Steps:<br/>
  1) Action: Connect to Mongo | Data: MONGO_URI | Expected: Connection successful<br/>
  2) Action: List collections | Data: N/A | Expected: base_paths, node2, node4 present<br/>
  3) Action: Sample node4 doc | Data: N/A | Expected: required keys and reasonable types<br/>
  4) Action: Try invalid insert | Data: wrong types | Expected: Insert rejected (if validation enforced) or flagged for schema enforcement</li>
	<li>Expected Result (overall):</li>
	<li>Collections present; schema sanity; illegal insert detected or blocked.</li>
	<li>Post-Conditions:</li>
	<li>Remove any accidental inserts.</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35102"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">08/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35102"><td bgcolor="#ffffff">
            <p>Add tests that check the indexes of the mongoDB collocations on all the recording that exist in the DB </p>

<p>check for missing recording metadata in the MongoDB </p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13572]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13572">Security – Robustness to malformed inputs</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42328-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            security_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42328-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Stress-tests input validation and basic hardening: missing/extra fields, extreme values, type violations, and simple injection attempts. Expects precise <tt>4xx</tt> responses, no server crashes, no sensitive data leakage, and correct CORS headers where applicable.</p>

<ul>
	<li>Summary: Focus Server – Security – Malformed inputs do not crash server</li>
	<li>Objective: Validate input hardening: malformed/oversized/CORS/SQLi-like params.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, security, input-validation, cors</li>
	<li>Requirements: FOCUS-SEC-ROBUSTNESS</li>
	<li>Pre-Conditions:
	<ul>
		<li>Logging enabled for auditing; server reachable.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>Malformed JSON; OPTIONS request; oversized payload (e.g., 10MB); query params with injection strings.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /configure with malformed JSON | Data: corrupt body | Expected: 4xx; not 5xx</li>
		<li>Action: OPTIONS any endpoint | Data: N/A | Expected: CORS headers present</li>
		<li>Action: GET with SQLi-like params | Data: e.g., ?search='1'%20OR%20'1'='1 | Expected: No 500; sanitized</li>
		<li>Action: POST oversized payload | Data: ~10MB | Expected: rejected/handled gracefully; no crash</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>No 5xx due to malformed inputs; stable behavior; CORS ok.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
Various malformed and malicious payloads:</p>

<ul>
	<li>{{
<div class="error"><span class="error">Unknown macro: {&quot;invalid_json&quot;}</span> </div>
<p>}</p></li>
	<li><tt>?search='1' OR '1'='1</tt></li>
	<li><tt>?id=&lt;script&gt;alert('xss')&lt;/script&gt;</tt></li>
	<li>Extremely large JSON payload (10MB+)</li>
</ul>


<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>No 500 Internal Server Error for malformed inputs</li>
	<li>CORS headers present on OPTIONS requests</li>
	<li>SQLi attempts do not cause crashes</li>
	<li>XSS attempts are sanitized</li>
	<li>Large payloads rejected gracefully</li>
	<li>Server logs security events appropriately</li>
</ul>


<p><b>Environment:</b><br/>
Any (preferably Staging)</p>

<p><b>Automation Status:</b><br/>
Automated security smoke test<br/>
Test Function: <tt>test_security_resilience</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13571]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13571">Performance – /configure latency p95</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42327-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            performance_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42327-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Measures <tt>/configure</tt> response times under varying loads/concurrency for both Live and Historical flows. Tracks p50/p95/p99 against targets, watches error rates/timeouts, and flags regressions or scalability limits under burst conditions.</p>

<p> Summary: Focus Server – /configure latency – p95 &lt; 2.0s under minimal load</p>

<ul>
	<li>Objective: Ensure low-latency control plane for configure requests.</li>
	<li>Priority: Low</li>
	<li>Components/Labels: focus-server, performance, latency, configure</li>
	<li>Requirements: FOCUS-PERF-CONFIGURE</li>
	<li>Pre-Conditions:
	<ul>
		<li>Minimal concurrent load on environment.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>Live payload; 5 sequential requests.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: Send 5 POST /configure | Data: live payload | Expected: All 200</li>
		<li>Action: Compute p95 | Data: collected latencies | Expected: p95 &lt; 2.0s</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>SLA met for latency.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
Standard live configure payload</p>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Response time &lt; 2.0 seconds (95th percentile)</li>
	<li>No significant variance between runs</li>
	<li>Server remains stable during repeated requests</li>
	<li>No memory leaks or resource exhaustion</li>
</ul>


<p><b>Environment:</b><br/>
Dev/Staging (non-loaded)</p>

<p><b>Automation Status:</b><br/>
Automated performance smoke test<br/>
Test Function: <tt>test_configure_latency</tt></p>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35101"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">08/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35101"><td bgcolor="#ffffff">
            <p>need to add memory load tests </p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13570]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13570">E2E – Configure → Metadata → gRPC (mock)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 27/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42326-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            e2e_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42326-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="Summary"></a>Summary</h2>

<p>This test flow focuses on running an end-to-end integration test for the <tt>/configure</tt> endpoint. It involves connecting to a gRPC stream and validating the data received. The test checks the time-to-first-message SLO, the integrity of the data frames, and ensures stable streaming without disconnects.</p>

<h2><a name="Context"></a>Context</h2>

<p>The test aims to validate the configuration to metadata roundtrip and the stream contract, ensuring that the expected data shapes and fields are returned. It is a high-priority task associated with the focus server and utilizes a mock gRPC server.</p>

<h2><a name="Acceptancecriteria"></a>Acceptance criteria</h2>

<ul>
	<li><b>Pre-Conditions:</b>
	<ul>
		<li>Mock gRPC server/client must be available and reachable.</li>
	</ul>
	</li>
	<li><b>Test Steps:</b>
	<ol>
		<li><b>Action:</b> POST /configure<br/>
*<b>Data:</b> live payload  <br/>
*<b>Expected:</b> 200; job_id, stream_url, stream_port</li>
		<li><b>Action:</b> GET /metadata/
{job_id}
<p>*<b>Data:</b> job_id  <br/>
*<b>Expected:</b> 200; config matches</p></li>
		<li><b>Action:</b> Connect to stream<br/>
*<b>Data:</b> stream_url:stream_port  <br/>
*<b>Expected:</b> connection established; frames contain expected fields</li>
	</ol>
	</li>
	<li><b>Expected Results:</b>
	<ul>
		<li>Roundtrip is valid; stream contract holds.</li>
	</ul>
	</li>
	<li><b>Post-Conditions:</b>
	<ul>
		<li>Job must be cleaned up.</li>
	</ul>
	</li>
	<li><b>Assertions:</b>
	<ul>
		<li>Configuration successful (200)</li>
		<li>Metadata retrieval successful</li>
		<li>gRPC connection established</li>
		<li>DataStream messages received</li>
		<li>Data fields present: timestamps, spectrograms, shapes</li>
		<li>No data corruption or connection errors</li>
	</ul>
	</li>
</ul>


<h2><a name="Otherinformation"></a>Other information</h2>

<ul>
	<li><b>Test Data:</b> Use standard configure payload from Test Case #1</li>
	<li><b>Environment:</b> Integration test environment (Dev/Staging)</li>
	<li><b>Automation Status:</b> Automated integration test with Pytest<br/>
<b>Test Function:</b> <tt>test_e2e_grpc_mock_flow</tt></li>
	<li><b>Components/Labels:</b> focus-server, e2e, grpc, mock</li>
	<li><b>Requirements:</b> FOCUS-E2E-GRPC</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13564]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13564">API – POST /recordings_in_time_range</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42320-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42320-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Checks that the endpoint returns <b>precise</b> recording windows (epoch tuples) that intersect a requested time range. Ensures ordering, non-overlap (if guaranteed), valid timestamp types, and alignment with stored recordings.</p>

<p>Summary: Focus Server – Recordings in time range – Returns intersecting windows</p>

<ul>
	<li>Objective: Validate returned windows overlap request and policy on ongoing recordings.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, api, history, mongo</li>
	<li>Requirements: FOCUS-API-REC-RANGE</li>
	<li>Pre-Conditions:
	<ul>
		<li>rec_mapper seeded for requested range.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>start_ts, end_ts (epoch) with known recordings; include an ongoing run if applicable.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /recordings_in_time_range | Data: window | Expected: 200; list of <span class="error">&#91;start_ts, end_ts&#93;</span></li>
		<li>Action: Validate ongoing policy | Data: response | Expected: ongoing end per implementation (e.g., equals request end)</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Correct, overlapping windows returned in consistent format.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "start_time": 1700000000,
  "end_time": 1700000600
}</pre>
</div></div>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 200</li>
	<li>Response is a list of tuples/arrays</li>
	<li>Timestamps are valid epoch values</li>
	<li>Recordings match requested time range</li>
</ul>


<p><b>Environment:</b><br/>
Dev/Staging with MongoDB seed data</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_recordings_in_time_range</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13563]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13563">API - GET /metadata/{job_id} - Valid and Invalid Job ID</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42319-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42319-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – GET /metadata/</p>
{task_id} – Valid Task Metadata Retrieval<br/>
<br/>
<b>Objective:</b> Add test for valid metadata retrieval (currently only invalid case exists).<br/>
<br/>
<b>Priority:</b> High<br/>
<br/>
<b>Components/Labels:</b> focus-server, api, metadata, tasks<br/>
<br/>
<b>Requirements:</b> FOCUS-API-METADATA<br/>
<br/>
<b>Pre-Conditions:</b><br/>
<br/>
* PC-001: Valid task created via /config/{task_id}
<ul>
	<li>PC-002: Task exists in system</li>
</ul>


<p><b>Test Data:</b></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Valid task_id: From previous /config call
Invalid task_ids: "non_existent", "12345", "", "../../etc/passwd"</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Create task via POST /config</td>
<td class='confluenceTd'>Valid payload</td>
<td class='confluenceTd'>Get task_id</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>GET /metadata/
{task_id}</td>
<td class='confluenceTd'>Valid task_id</td>
<td class='confluenceTd'>HTTP 200</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate metadata returned</td>
<td class='confluenceTd'>Response body</td>
<td class='confluenceTd'>Contains configuration</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Verify config matches</td>
<td class='confluenceTd'>Original vs returned</td>
<td class='confluenceTd'>Exact match</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>GET /metadata/
{invalid}</td>
<td class='confluenceTd'>"non_existent"</td>
<td class='confluenceTd'>HTTP 404</td>
</tr>
<tr>
<td class='confluenceTd'>6</td>
<td class='confluenceTd'>Validate error message</td>
<td class='confluenceTd'>404 response</td>
<td class='confluenceTd'>"Task not found" or similar</td>
</tr>
<tr>
<td class='confluenceTd'>7</td>
<td class='confluenceTd'>Test path traversal</td>
<td class='confluenceTd'>"../../etc/passwd"</td>
<td class='confluenceTd'>HTTP 400 or 404</td>
</tr>
<tr>
<td class='confluenceTd'>8</td>
<td class='confluenceTd'>Test empty ID</td>
<td class='confluenceTd'>""</td>
<td class='confluenceTd'>HTTP 400</td>
</tr>
</tbody></table>
</div>


<p><b>Expected Result (overall):</b></p>

<ul>
	<li>Valid tasks return complete metadata</li>
	<li>Invalid tasks return proper 404</li>
	<li>No security vulnerabilities</li>
	<li>Clear error messages</li>
</ul>


<p><b>Post-Conditions:</b></p>

<ul>
	<li>Test task cleaned up</li>
</ul>


<p><b>Assertions:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-comment"># Valid case
</span><span class="code-keyword">assert</span> valid_response.status_code == 200
<span class="code-keyword">assert</span> valid_response.json()[<span class="code-quote">'task_id'</span>] == task_id
<span class="code-keyword">assert</span> valid_response.json()[<span class="code-quote">'config'</span>] == original_config

<span class="code-comment"># Invalid case  
</span><span class="code-keyword">assert</span> invalid_response.status_code == 404
<span class="code-keyword">assert</span> <span class="code-quote">"<span class="code-keyword">not</span> found"</span> <span class="code-keyword">in</span> invalid_response.json()[<span class="code-quote">'error'</span>].lower()

<span class="code-comment"># Security
</span><span class="code-keyword">assert</span> path_traversal_response.status_code <span class="code-keyword">in</span> [400, 404]</pre>
</div></div>

<p><b>Environment:</b> Any</p>

<p><b>Automation Status:</b> PARTIALLY IMPLEMENTED (add valid case)<br/>
<b>Test Function:</b> <tt>test_metadata_for_invalid_task_id</tt> (exists), <tt>test_metadata_for_valid_task_id</tt> (TO ADD)<br/>
<b>Test File:</b> <tt>tests/integration/api/test_live_monitoring_flow.py</tt></p>

<p><b>Notes:</b></p>

<ul>
	<li>Currently only invalid case tested</li>
	<li>Add valid case test</li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13562]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13562">API – GET /live_metadata missing</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42318-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42318-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
If live fiber metadata is not available, the server returns a <b>clean</b> <tt>404</tt> with a clear message. Ensures no ambiguous <tt>200</tt> with empty payload, and no server errors.</p>

<ul>
	<li>Summary: Focus Server – Live metadata missing – Returns 404 with clear error</li>
	<li>Objective: Validate clean error when metadata unavailable.</li>
	<li>Priority: Medium</li>
	<li>Components/Labels: focus-server, api, metadata, live</li>
	<li>Requirements: FOCUS-API-METADATA</li>
	<li>Pre-Conditions:
	<ul>
		<li>fiber_metadata=None</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>N/A.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: GET /live_metadata | Data: N/A | Expected: 404 with meaningful message; no crash</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Clear absence signal without server error.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request)</p>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 404</li>
	<li>Error response contains meaningful message</li>
	<li>No server crash or unexpected behavior</li>
</ul>


<p><b>Environment:</b><br/>
Dev/Staging without fiber_metadata</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_live_metadata_missing</tt></p>

<p><b>Linked Issues:</b><br/>
FOCUS-API-METADATA</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13561]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13561">API – GET /live_metadata present</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42317-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42317-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
When live fiber metadata exists, the endpoint returns a <b>complete</b> and well-typed structure. Confirms mandatory fields are present and values are in valid ranges (no nulls for required attributes).</p>

<ul>
	<li>Summary: Focus Server – Live metadata present – Returns full metadata</li>
	<li>Objective: Validate metadata completeness and typing.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, api, metadata, live</li>
	<li>Requirements: FOCUS-API-METADATA</li>
	<li>Pre-Conditions:
	<ul>
		<li>fiber_metadata populated (dx, prr, fiber_* fields).</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>N/A.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: GET /live_metadata | Data: N/A | Expected: 200; required fields present and well-typed</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Complete, valid metadata.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request)</p>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 200</li>
	<li>All required metadata fields present</li>
	<li>Field values are valid and within expected ranges</li>
	<li>JSON response is well-formed</li>
</ul>


<p><b>Environment:</b><br/>
Dev/Staging with fiber_metadata configured</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_live_metadata_present</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13560]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13560">API – GET /channels</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42316-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42316-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Ensures the endpoint returns the <b>authoritative</b> channel bounds (e.g., <tt>lowest_channel</tt>, <tt>highest_channel</tt>) for the deployment. Validates response schema, value ranges, and stability across calls.</p>

<ul>
	<li>Summary: Focus Server – Channels endpoint – Returns authoritative channel bounds</li>
	<li>Objective: Validate channel range response is correct and stable.</li>
	<li>Priority: High</li>
	<li>Components/Labels: focus-server, api, channels</li>
	<li>Requirements: FOCUS-API-CHANNELS</li>
	<li>Pre-Conditions:
	<ul>
		<li>FocusManager.channels configured.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>N/A.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: GET /channels | Data: N/A | Expected: 200; lowest_channel=1; highest_channel=configured value</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Range reflects server configuration.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
N/A (GET request, no payload)</p>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 200</li>
	<li>lowest_channel = 1</li>
	<li>highest_channel matches system configuration</li>
	<li>Response follows expected JSON schema</li>
</ul>


<p><b>Environment:</b><br/>
Any (Dev/Staging/Prod)</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_channels_endpoint</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13558]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13558">API - Overlap/NFFT Escalation Edge Case</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42314-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42314-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Verifies the internal rule that when <tt>window_overlap</tt> is below a threshold, the server escalates <tt>internal_nfft</tt> up to a documented maximum and applies padding policy if needed. Ensures these derived values are reflected in metadata and remain within safe limits.</p>

<ul>
	<li>Summary: Focus Server – Overlap escalation – Small window triggers internal_nfft increase</li>
	<li>Objective: Validate algorithm escalates internal_nfft under low overlap and sets padding flags if capped.</li>
	<li>Priority: Low</li>
	<li>Components/Labels: focus-server, api, algorithm, overlap, nfft</li>
	<li>Requirements: FOCUS-ALG-OVERLAP</li>
	<li>Pre-Conditions:
	<ul>
		<li>Known PRR and display height to force overlap &lt; 0.5.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>Values tuned to produce window_overlap &lt; 0.5 (document exact chosen parameters).</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /configure | Data: tuned payload | Expected: 200</li>
		<li>Action: Validate escalation | Data: logs/flags/metadata | Expected: internal_nfft increased up to cap; if cap reached and view != SINGLECHANNEL → padding flags set</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Correct escalation and padding policy execution.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b><br/>
Specific values calculated based on PRR and display height to force small overlap<br/>
(Values depend on system configuration)</p>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 200</li>
	<li>internal_nfft escalation logic is applied correctly</li>
	<li>MAX_INTERNAL_NFFT cap is respected</li>
	<li>Padding flags are set when appropriate</li>
</ul>


<p><b>Environment:</b><br/>
Dev/Staging</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_configure_overlap_escalation</tt></p>

<p><b>Linked Issues:</b><br/>
FOCUS-ALG-OVERLAP</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13557]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13557">API – Waterfall view handling</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42313-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42313-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Checks <tt>view_type=WATERFALL</tt> specifics: response includes Waterfall-specific parameters (e.g., display height and any view-specific derived fields) with internally consistent values. Confirms the configuration produces a stream suitable for Waterfall rendering (no schema drift vs. other views).</p>

<ul>
	<li>Summary: Focus Server – Waterfall view – Response contains consistent waterfall parameters</li>
	<li>Objective: Validate response consistency and view_type for Waterfall.</li>
	<li>Priority: Medium</li>
	<li>Components/Labels: focus-server, api, view-type, waterfall</li>
	<li>Requirements: FOCUS-API-VIEWTYPE</li>
	<li>Pre-Conditions:
	<ul>
		<li>Server reachable.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>view_type=2; nfftSelection=1; displayInfo.height=800; channels 1..10; frequencyRange 0..1000.</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /configure | Data: waterfall payload | Expected: 200</li>
		<li>Action: Validate response | Data: response | Expected: view_type=2; waterfall-specific parameters present/consistent (per spec)</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Waterfall config returned; fields are coherent for rendering.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "displayTimeAxisDuration": 10,
  "nfftSelection": 1024,
  "displayInfo": { "height": 800 },
  "channels": { "min": 1, "max": 10 },
  "frequencyRange": { "min": 0, "max": 1000 },
  "start_time": null,
  "end_time": null,
  "view_type": 2
}</pre>
</div></div>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 200</li>
	<li>Response structure matches waterfall view requirements</li>
	<li>Waterfall-specific parameters are present and valid</li>
</ul>


<p><b>Environment:</b><br/>
Any (Dev/Staging)</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_configure_waterfall</tt></p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13556]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13556">API – SingleChannel view mapping</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42312-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42312-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <h2><a name="TestSummary"></a>Test Summary</h2>

<p>Validates view_type=SINGLECHANNEL behavior: the server must return exactly one stream (stream_amount=1) and a single, correct channel mapping. Ensures the requested channel (min=max) maps 1:1 to the produced stream, with no extra channels or stray mappings.</p>

<h2><a name="Summary"></a>Summary</h2>

<p>Focus Server – SingleChannel view – Exactly one stream and 1:1 mapping</p>

<h2><a name="Objective"></a>Objective</h2>

<p>Prove SingleChannel returns exactly one stream and correct mapping.</p>

<h2><a name="Components%2FLabels"></a>Components/Labels</h2>

<p>focus-server, api, view-type, singlechannel</p>

<h2><a name="Requirements"></a>Requirements</h2>

<p>FOCUS-API-VIEWTYPE</p>

<h2><a name="PreConditions"></a>Pre-Conditions</h2>

<ul>
	<li>Server reachable</li>
</ul>


<h2><a name="TestData"></a>Test Data</h2>

<p>channels </p>
{min: X, max: X}
<p>; view_type=1; otherwise valid.</p>

<h2><a name="Steps"></a>Steps</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>POST /configure</td>
<td class='confluenceTd'>single channel payload</td>
<td class='confluenceTd'>200</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Validate stream_amount</td>
<td class='confluenceTd'>response</td>
<td class='confluenceTd'>stream_amount = 1</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate mapping</td>
<td class='confluenceTd'>response</td>
<td class='confluenceTd'>exactly one entry; 1:1 mapping for requested channel</td>
</tr>
</tbody></table>
</div>


<h2><a name="ExpectedResult%28overall%29"></a>Expected Result (overall)</h2>

<p>Correct single-stream behavior and mapping.</p>

<h2><a name="PostConditions"></a>Post-Conditions</h2>

<p>None.</p>

<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "displayTimeAxisDuration": 10,
  "nfftSelection": 1024,
  "displayInfo": { "height": 1000 },
  "channels": { "min": 7, "max": 7 },
  "frequencyRange": { "min": 0, "max": 500 },
  "start_time": null,
  "end_time": null,
  "view_type": 1
}</pre>
</div></div>

<h2><a name="Authentication"></a>Authentication</h2>

<p>N/A</p>

<h2><a name="Assertions"></a>Assertions</h2>

<ul>
	<li>Status Code: 200</li>
	<li>stream_amount = 1</li>
	<li>channel_to_stream_index contains single entry</li>
	<li>Mapping is correct for the requested channel</li>
</ul>


<h2><a name="Environment"></a>Environment</h2>

<p>Any (Dev/Staging)</p>

<h2><a name="AutomationStatus"></a>Automation Status</h2>

<p>Automated with Pytest</p>

<p><b>Test Function:</b> <tt>test_configure_singlechannel_mapping</tt>  <br/>
<b>Test File:</b> <tt>tests/integration/api/test_singlechannel_view_mapping.py</tt></p>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35098"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">08/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35098"><td bgcolor="#ffffff">
            <p>check in the BE if its the same channel process </p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13555]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13555">API – Invalid frequency range (negative)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42311-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42311-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Checks that malformed frequency ranges (negative values, <tt>min &gt; max</tt>, unsupported units) are rejected with a <tt>400</tt> and an actionable error. Confirms the system does not continue into orchestration on bad input.</p>

<ul>
	<li>Summary: Focus Server – Configure – Invalid frequency range rejected</li>
	<li>Objective: Ensure illegal frequency range is rejected with clear validation error.</li>
	<li>Priority: Medium</li>
	<li>Components/Labels: focus-server, api, validation</li>
	<li>Requirements: FOCUS-API-VALIDATION</li>
	<li>Pre-Conditions:
	<ul>
		<li>Server reachable.</li>
	</ul>
	</li>
	<li>Test Data:
	<ul>
		<li>frequencyRange 
{min: 500, max: 0}
<p> plus otherwise valid payload.</p></li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /configure | Data: invalid frequency range | Expected: 400 with validation details</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Clear client error; no orchestration starts.</li>
	</ul>
	</li>
	<li>Post-Conditions:
	<ul>
		<li>None.</li>
	</ul>
	</li>
</ul>


<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "displayTimeAxisDuration": 10,
  "nfftSelection": 1024,
  "displayInfo": { "height": 1000 },
  "channels": { "min": 1, "max": 3 },
  "frequencyRange": { "min": 500, "max": 0 },
  "start_time": null,
  "end_time": null,
  "view_type": 0
}</pre>
</div></div>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 400</li>
	<li>Error message clearly indicates invalid frequency range</li>
	<li>Response contains validation error details</li>
</ul>


<p><b>Environment:</b><br/>
Any (Dev/Staging/Prod)</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_configure_invalid_frequency_range</tt></p>

<p><b>Linked Issues:</b><br/>
FOCUS-API-VALIDATION</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13554]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13554">API – Invalid channels (negative)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42310-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42310-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Confirms the server blocks illegal channel windows (e.g., <tt>channels.min &gt; channels.max</tt> or out-of-bounds). Verifies a <tt>400</tt> with clear error details and no partial creation of jobs or streams.</p>

<ul>
	<li>Summary: Focus Server – Configure – channels.min &gt; channels.max rejected</li>
	<li>Objective: Ensure channel window is validated.</li>
	<li>Priority: Medium</li>
	<li>Components/Labels: focus-server, api, validation</li>
	<li>Requirements: FOCUS-API-VALIDATION</li>
	<li>Test Type: Manual</li>
	<li>Environments: Any</li>
	<li>Pre-Conditions: None</li>
	<li>Test Data:</li>
</ul>


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">{ <span class="code-quote">"channels"</span>: { <span class="code-quote">"min"</span>: 300, <span class="code-quote">"max"</span>: 100 } }</pre>
</div></div>

<ul>
	<li>Steps:
	<ol>
		<li>Action: POST /configure | Data: payload with channels 300..100 | Expected: 400; message “Invalid channel range”</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>Client error; no orchestration.</li>
	</ul>
	</li>
	<li>Post-Conditions: None</li>
	<li>Attachments: Request and error JSON</li>
</ul>


<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "displayTimeAxisDuration": 10,
  "nfftSelection": 1024,
  "displayInfo": { "height": 1000 },
  "channels": { "min": 300, "max": 100 },
  "frequencyRange": { "min": 0, "max": 500 },
  "start_time": null,
  "end_time": null,
  "view_type": 0
}</pre>
</div></div>

<p><b>Authentication:</b><br/>
N/A</p>

<p><b>Assertions:</b></p>

<ul>
	<li>Status Code: 400</li>
	<li>Error message clearly indicates invalid channel range</li>
	<li>Response contains validation error details</li>
</ul>


<p><b>Environment:</b><br/>
Any (Dev/Staging/Prod)</p>

<p><b>Automation Status:</b><br/>
Automated with Pytest<br/>
Test Function: <tt>test_configure_invalid_channels_range</tt></p>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35230"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">12/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35230"><td bgcolor="#ffffff">
            <p>🎉 Looks good!</p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13552]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13552">API – Invalid time range (negative)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42308-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42308-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Test Summary:</b><br/>
Ensures invalid time ranges (e.g., <tt>start_time &gt;= end_time</tt>) are rejected. Expects a precise <tt>400 Bad Request</tt> with a helpful validation message and <b>no</b> resource allocation (no gRPC server, no job created).</p>

<ul>
	<li>Summary: Focus Server – Configure – Invalid time range is rejected without side effects</li>
	<li>Objective: Ensure time validation blocks zero-length or inverted windows.</li>
	<li>Priority: Medium</li>
	<li>Components/Labels: focus-server, api, validation, history</li>
	<li>Requirements: FOCUS-API-VALIDATION</li>
	<li>Test Type: Manual</li>
	<li>Environments: Any</li>
	<li>Pre-Conditions: None</li>
	<li>Test Data:
	<ul>
		<li>Payload A: start_time == end_time</li>
		<li>Payload B: start_time &gt; end_time</li>
	</ul>
	</li>
	<li>Steps:
	<ol>
		<li>Action: POST /configure | Data: Payload A | Expected: 400; error message “Invalid time range” (or documented wording); no job_id</li>
		<li>Action: POST /configure | Data: Payload B | Expected: 400; same constraints</li>
		<li>Action: GET /metadata/
{any}
<p> | Data: N/A | Expected: 404 for non-created IDs</p></li>
		<li>Check if the error is relevant to the scenario</li>
	</ol>
	</li>
	<li>Expected Result (overall):
	<ul>
		<li>No job creation; clear 4xx errors; logs show validation failure not server errors.</li>
	</ul>
	</li>
	<li>Post-Conditions: None</li>
</ul>


<p><b>Test Data:</b></p>

<p>json</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
  "displayTimeAxisDuration": 10,
  "nfftSelection": 1024,
  "displayInfo": { "height": 1000 },
  "channels": { "min": 1, "max": 3 },
  "frequencyRange": { "min": 0, "max": 500 },
  "start_time": 1700000000,
  "end_time": 1700000000,
  "view_type": 0
}</pre>
</div></div>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35229"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">12/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35229"><td bgcolor="#ffffff">
            <p>🎉 Looks good!</p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13548]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13548">API – Historical configure (happy path)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42298-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42298-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Summary:</b> API – POST /config/</p>
{task_id} – Historical Mode Configuration (Happy Path)<br/>
<br/>
<b>Objective:</b> Validate historical configuration using /config/{task_id}
<p> endpoint with time range successfully creates a task for historical playback.</p>

<p><b>Priority:</b> Critical</p>

<p><b>Components/Labels:</b> focus-server, api, history, config, playback</p>

<p><b>Requirements:</b> FOCUS-API-CONFIG, FOCUS-API-HISTORY</p>

<p><b>Pre-Conditions:</b></p>

<ul>
	<li>PC-010: MongoDB reachable with historical recordings</li>
	<li>PC-011: Time range with available recordings</li>
	<li>PC-012: Valid task_id format available</li>
</ul>


<p><b>Test Data:</b></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json">Endpoint: POST /config/{task_id}
task_id format: <span class="code-quote">"historic_playback_YYYYMMDD_HHMMSS_XXX"</span>

Payload:
{
  <span class="code-quote">"displayTimeAxisDuration"</span>: 10,
  <span class="code-quote">"nfftSelection"</span>: 1024,
  <span class="code-quote">"displayInfo"</span>: { <span class="code-quote">"height"</span>: 1000 },
  <span class="code-quote">"channels"</span>: { <span class="code-quote">"min"</span>: 1, <span class="code-quote">"max"</span>: 3 },
  <span class="code-quote">"frequencyRange"</span>: { <span class="code-quote">"min"</span>: 0, <span class="code-quote">"max"</span>: 500 },
  <span class="code-quote">"start_time"</span>: 1700000000,
  <span class="code-quote">"end_time"</span>: 1700000600,
  <span class="code-quote">"view_type"</span>: 0
}</pre>
</div></div>

<p><b>Steps:</b></p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>#</th>
<th class='confluenceTh'>Action</th>
<th class='confluenceTh'>Data</th>
<th class='confluenceTh'>Expected Result</th>
</tr>
<tr>
<td class='confluenceTd'>1</td>
<td class='confluenceTd'>Query MongoDB for recordings</td>
<td class='confluenceTd'>Time range: 1700000000-1700000600</td>
<td class='confluenceTd'>Recordings exist</td>
</tr>
<tr>
<td class='confluenceTd'>2</td>
<td class='confluenceTd'>Generate unique task_id</td>
<td class='confluenceTd'>Format: historic_
{timestamp}
<p>_</p>
{random}</td>
<td class='confluenceTd'>Valid task_id</td>
</tr>
<tr>
<td class='confluenceTd'>3</td>
<td class='confluenceTd'>Validate task_id format</td>
<td class='confluenceTd'>Check pattern</td>
<td class='confluenceTd'>Format valid</td>
</tr>
<tr>
<td class='confluenceTd'>4</td>
<td class='confluenceTd'>Create ConfigTaskRequest</td>
<td class='confluenceTd'>Historical payload</td>
<td class='confluenceTd'>Request created</td>
</tr>
<tr>
<td class='confluenceTd'>5</td>
<td class='confluenceTd'>POST /config/
{task_id}|task_id + payload|HTTP 200 OK|<br/>
|6|Validate response status|response.status|"Config received successfully"|<br/>
|7|Verify task created|System state|Task exists|<br/>
<br/>
<b>Expected Result (overall):</b><br/>
<br/>
* Historical configuration accepted<br/>
* Task created for time range<br/>
* System ready for historical playback<br/>
* Recordings available for range<br/>
<br/>
<b>Post-Conditions:</b><br/>
<br/>
* Task cleanup if needed<br/>
* No MongoDB modifications<br/>
<br/>
<b>Assertions:</b><br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-python"><span class="code-keyword">assert</span> response.status_code == 200
<span class="code-keyword">assert</span> <span class="code-object">isinstance</span>(response, ConfigTaskResponse)
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
<span class="code-keyword">assert</span> mongodb_recordings_exist(start_time, end_time)
<span class="code-keyword">assert</span> validate_task_id_format(task_id) == <span class="code-keyword"><span class="code-object">True</span></span></pre>
</div></div><br/>
<br/>
<b>Environment:</b> Staging/Production (requires data)<br/>
<br/>
<b>Automation Status:</b> IMPLEMENTED<br/>
<b>Test Function:</b> <tt>test_configure_historic_task_success</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_historic_playback_flow.py</tt><br/>
<br/>
<b>Notes:</b><br/>
<br/>
* API uses /config/{task_id}
<p> not /configure</p>
<ul>
	<li>Update Xray to reflect current endpoint</li>
</ul>
</td>
</tr>
</tbody></table>
</div>

            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35228"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">12/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35228"><td bgcolor="#ffffff">
            <p>🎉 Looks good!</p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13547]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13547">API – POST /config/{task_id} – Live Mode Configuration (Happy Path)</a>
            <span class="subText">
               Created: 29/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-42295-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-42295-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-42295-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Objective:</b> Validate that a valid live configuration using the /config/</p>
{task_id} endpoint successfully creates a task and returns proper confirmation.<br/>
<br/>
<b>Priority:</b> Critical<br/>
<br/>
<b>Components/Labels:</b> focus-server, api, live, config, task-management<br/>
<br/>
<b>Requirements:</b> FOCUS-API-CONFIG<br/>
<br/>
<b>Pre-Conditions:</b><br/>
<br/>
* PC-001: API base URL reachable (<a href="https://10.10.100.100/focus-server/)" class="external-link" rel="nofollow noreferrer">https://10.10.100.100/focus-server/)</a><br/>
* PC-002: System operational and ready<br/>
* PC-003: Valid task_id format available<br/>
<br/>
<b>Test Data:</b><br/>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-json"></pre>
</div></div>Endpoint: POST /config/{task_id}
<p>task_id format: "live_monitoring_YYYYMMDD_HHMMSS_XXX"</p>

<p>Payload:<br/>
{<br/>
  "displayTimeAxisDuration": 10,<br/>
  "nfftSelection": 1024,<br/>
  "displayInfo": </p>
{ "height": 1000 }
<p>,<br/>
  "channels": </p>
{ "min": 1, "max": 3 }
<p>,<br/>
  "frequencyRange": </p>
{ "min": 0, "max": 500 }
<p>,<br/>
  "start_time": null,<br/>
  "end_time": null,<br/>
  "view_type": 0<br/>
}</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
*Steps:*

||#||Action||Data||Expected Result||
|1|Generate unique task_id|Format: live_{timestamp}_{random}|Valid task_id created|
|2|Validate task_id format|Check regex pattern|Format valid|
|3|Create ConfigTaskRequest|Live payload|Request object created|
|4|POST /config/{task_id}|task_id + payload|HTTP 200 OK|
|5|Validate response status|response.status|<span class="code-quote">"Config received successfully"</span>|
|6|Validate task_id in response|response.task_id|Matches input or <span class="code-keyword">null</span>|
|7|Check server logs|Application logs|No errors logged|

*Expected Result (overall):*

* Configuration accepted successfully
* Task created with valid ID
* <span class="code-object">System</span> ready <span class="code-keyword">for</span> live monitoring
* No errors in processing

*Post-Conditions:*

* Task remains in system
* Resources allocated <span class="code-keyword">for</span> task
* Cleanup via DELETE <span class="code-keyword">if</span> needed

*Assertions:*

{code:python}<span class="code-keyword">assert</span> response.status_code == 200
<span class="code-keyword">assert</span> isinstance(response, ConfigTaskResponse)
<span class="code-keyword">assert</span> response.status == <span class="code-quote">"Config received successfully"</span>
<span class="code-keyword">assert</span> response.task_id == task_id or response.task_id is None
<span class="code-keyword">assert</span> validate_task_id_format(task_id) == True</pre>
</div></div>

<p><b>Environment:</b> Dev/Staging/Production</p>

<p><b>Automation Status:</b> IMPLEMENTED<br/>
<b>Test Function:</b> <tt>test_configure_live_task_success</tt><br/>
<b>Test File:</b> <tt>tests/integration/api/test_live_monitoring_flow.py</tt></p>

<p><b>Notes:</b> </p>

<ul>
	<li>API changed from <tt>/configure</tt> to {{/config/
{task_id}
<p>}}</p></li>
</ul>

            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-35227"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_commented_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                                        <font size="-2">
            [
                <font color="#336699">12/Oct/25</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-35227"><td bgcolor="#ffffff">
            <p>🎉 Looks good!</p>
        </td></tr>
            </table>
<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13299]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13299">APi - 4xx errors do not log stack traces</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41333-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41333-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41333-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @logging<br/>
Feature: 4xx errors do not log stack traces<br/>
  As an operator<br/>
  I want validation errors not to spam error logs<br/>
  So that logs remain actionable</p>

<p>  @medium @stability<br/>
  Scenario: 422 responses do not include stack traces in server logs<br/>
    Given I trigger a 422 from /configure by omitting required fields<br/>
    When I fetch recent server logs<br/>
    Then no Python Traceback should be present for this request</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13298]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13298">API - OpenAPI contract alignment</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41332-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41332-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41332-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @openapi<br/>
Feature: OpenAPI contract alignment<br/>
  As a QA and SDK generator user<br/>
  I want /openapi.json to reflect the real conditional requirements<br/>
  So that generated clients and tests are correct</p>

<p>  @medium @contract<br/>
  Scenario: /openapi.json documents conditional requirements for view_type="0"<br/>
    When I GET "/openapi.json"<br/>
    Then ConfigureRequest should mark displayTimeAxisDuration and frequencyRange as required for view_type="0"<br/>
    And descriptions should not state "not applicable" if the server requires them</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13297]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13297">API - Error body uniformity</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41331-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41331-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41331-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @errors<br/>
Feature: Error body uniformity<br/>
  As a client<br/>
  I want error responses to share a uniform structure<br/>
  So that clients can parse them consistently</p>

<p>  @medium @404<br/>
  Scenario: /metadata/</p>
{bad_id}
<p> returns consistent 404 error body<br/>
    When I GET "/metadata/DOES_NOT_EXIST_123"<br/>
    Then the response status code should be 404<br/>
    And the JSON body should match the agreed error shape (e.g., {"error":{"code":"NOT_FOUND","message":"...","hint":"..."}})</p>

<p>  @medium @422<br/>
  Scenario: /configure validation errors use uniform JSON shape<br/>
    Given an invalid /configure body (missing required fields)<br/>
    When I POST it to "/configure"<br/>
    Then the response status code should be 422<br/>
    And the JSON body should match the agreed error shape for validation errors</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13296]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13296">API - Waterfall behavior with optional fields omitted</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41330-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41330-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41330-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @waterfall<br/>
Feature: Waterfall behavior with optional fields omitted<br/>
  As a QA<br/>
  I want Waterfall (view_type="2") to work without irrelevant fields<br/>
  So that optional fields do not crash the server</p>

<p>  Background:<br/>
    Given the API base URL is "http://localhost:8500"</p>

<p>  @medium @waterfall<br/>
  Scenario: Waterfall without displayTimeAxisDuration / frequencyRange<br/>
    Given a JSON body:<br/>
      """<br/>
      {<br/>
        "displayInfo": </p>
{"height": 600}
<p>,<br/>
        "channels": </p>
{"min": &lt;min&gt;, "max": &lt;max&gt;}
<p>,<br/>
        "view_type": "2"<br/>
      }<br/>
      """<br/>
    When I POST it to "/configure"<br/>
    Then the response should be either 200 or a clear 422 per contract<br/>
    And server logs should NOT contain a stack trace</p>

<p>  @medium @waterfall<br/>
  Scenario: Overlap/NFFT logic does not assume missing fields<br/>
    Given a JSON body without nfftSelection and displayTimeAxisDuration for view_type="2"<br/>
    When I POST it to "/configure"<br/>
    Then the server should not return 500<br/>
    And the behavior should follow documented defaults or validation</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13295]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13295">API - Time validation uses provided epoch without hidden offsets</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41329-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41329-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41329-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @time<br/>
Feature: Time validation uses provided epoch without hidden offsets<br/>
  As a user of historical playback<br/>
  I want my provided start_time/end_time used as-is<br/>
  So that valid ranges are not rejected</p>

<p>  Background:<br/>
    Given I have a known recording window where data exists</p>

<p>  @high @time<br/>
  Scenario: No hidden +3h offset during recording validation<br/>
    Given a valid /configure request body with start_time and end_time matching an existing window<br/>
    When I POST it to "/configure"<br/>
    Then the response should not be a 400 "No recording found" due to hidden offsets<br/>
    And server logs should not show an added time offset applied to validation</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13294]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13294">API - Stream endpoint reachability</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41328-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41328-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41328-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @streaming @reachability<br/>
Feature: Stream endpoint reachability<br/>
  As a client<br/>
  I want the returned stream_url:stream_port to be reachable<br/>
  So that the UI does not appear frozen</p>

<p>  Background:<br/>
    Given I have a 200 response from /configure and saved stream_url and stream_port</p>

<p>  @high @network<br/>
  Scenario: Node endpoint is reachable within SLA<br/>
    When I attempt a TCP connection to </p>
{stream_url}
<p>:</p>
{stream_port}
<p> every 10 seconds for up to 60 seconds<br/>
    Then the TCP connection should succeed within 60 seconds<br/>
    And if it does not, the /configure response should not have marked the endpoint as ready</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13293]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13293">API - metadata readiness and race handling</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41327-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41327-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41327-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @metadata @race<br/>
Feature: /metadata readiness and race handling<br/>
  As a client<br/>
  I want /metadata/</p>
{job_id} to not 404 immediately after /configure<br/>
  So that I can implement predictable polling<br/>
<br/>
  Background:<br/>
    Given I have posted a valid /configure request and saved job_id as ctx.job_id<br/>
<br/>
  @high @readiness<br/>
  Scenario: Immediate GET /metadata/{job_id}
<p> should not 404<br/>
    When I GET "/metadata/</p>
{ctx.job_id}"<br/>
    Then the response status code should be either 200 or a documented pending/status code (e.g., 202)<br/>
    And if not 200, the response body should contain a machine-readable status field (e.g., "status":"pending")<br/>
<br/>
  @high @readiness<br/>
  Scenario: Poll /metadata/{job_id} until ready within a reasonable window<br/>
    When I poll "/metadata/{ctx.job_id}
<p>" every 2 seconds for up to 60 seconds<br/>
    Then I should eventually receive a 200 with valid metadata<br/>
    And the metadata should include fields required by the client to connect</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13292]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13292">API - Response invariants and consistency</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41326-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41326-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41326-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @response @invariants<br/>
Feature: Response invariants and consistency<br/>
  As a QA<br/>
  I want post-response invariants to hold<br/>
  So that clients can rely on stable structure and counts</p>

<p>  Background:<br/>
    Given I have successfully created a job via /configure as in the happy path<br/>
    And I have saved the JSON response as ctx.configure</p>

<p>  @medium @invariants<br/>
  Scenario: Frequencies count, lines_dt positivity, mapping sizes<br/>
    Then ctx.configure.frequencies_amount should equal len(ctx.configure.frequencies_list)<br/>
    And ctx.configure.lines_dt should be greater than 0<br/>
    And ctx.configure.channel_amount should equal the number of keys in ctx.configure.channel_to_stream_index<br/>
    And ctx.configure.stream_amount should equal the number of unique values in ctx.configure.channel_to_stream_index</p>
            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />
<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PZ-13291]&nbsp;<a href="https://prismaphotonics.atlassian.net/browse/PZ-13291">API - configure validation for MULTICHANNEL (view_type=&quot;0&quot;)</a>
            <span class="subText">
               Created: 11/Sep/25                   &nbsp;Updated: 22/Oct/25

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">TO DO</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://prismaphotonics.atlassian.net/secure/BrowseProject.jspa?id=10000">Prisma</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Test
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="712020:f3895741-cf6d-444c-92af-d001de870705"
                id="word_reporter_712020:f3895741-cf6d-444c-92af-d001de870705"
                href="https://prismaphotonics.atlassian.net/secure/ViewProfile.jspa?accountId=712020%3Af3895741-cf6d-444c-92af-d001de870705">
                    Roy Avrahami
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                    Unassigned
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-41325-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            api_test_panda                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

        
    


    
                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Team:</b></td>
                <td id="customfield_10001-41325-value" class="value" bgcolor="#ffffff" width="80%"><div class="shorten" id="customfield_10001-field">
    <span></span>
</div>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10020-41325-value" class="value" bgcolor="#ffffff" width="80%"></td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>@backend @api @configure<br/>
Feature: /configure validation for MULTICHANNEL (view_type="0")<br/>
  As a QA on the Focus Server backend<br/>
  I want /configure to validate inputs properly<br/>
  So that clients receive 4xx for bad input and never 500</p>

<p>  Background:<br/>
    Given the API base URL is "http://localhost:8500"<br/>
    And the server is reachable at "/channels"<br/>
    And I fetch live metadata from "/live_metadata"<br/>
    And I compute a valid channel range using the API response (min &gt;= 100, max = min + 10)<br/>
    And I compute nyquist = floor(prr/2) from live metadata</p>

<p>  @high @contract @422<br/>
  Scenario: Missing fields must return 422 when view_type="0"<br/>
    Given a JSON body:<br/>
      """<br/>
      {<br/>
        "displayInfo": </p>
{"height": 600}
<p>,<br/>
        "channels": </p>
{"min": &lt;min&gt;, "max": &lt;max&gt;}
<p>,<br/>
        "view_type": "0",<br/>
        "nfftSelection": 1<br/>
      }<br/>
      """<br/>
    When I POST it to "/configure"<br/>
    Then the response status code should be 422<br/>
    And the response body should describe the missing fields<br/>
    And server logs should NOT contain a stack trace</p>

<p>  @high @contract @422<br/>
  Scenario: frequencyRange = null should return 422<br/>
    Given a JSON body:<br/>
      """<br/>
      {<br/>
        "displayInfo": </p>
{"height": 600}
<p>,<br/>
        "channels": </p>
{"min": &lt;min&gt;, "max": &lt;max&gt;}
<p>,<br/>
        "view_type": "0",<br/>
        "nfftSelection": 1,<br/>
        "displayTimeAxisDuration": 10,<br/>
        "frequencyRange": null<br/>
      }<br/>
      """<br/>
    When I POST it to "/configure"<br/>
    Then the response status code should be 422<br/>
    And server logs should NOT contain a stack trace</p>

<p>  @medium @contract @types @happy_path<br/>
  Scenario: Valid request returns 200 and correct JSON types<br/>
    Given a JSON body:<br/>
      """<br/>
      {<br/>
        "displayInfo": </p>
{"height": 600}
<p>,<br/>
        "channels": </p>
{"min": &lt;min&gt;, "max": &lt;max&gt;}
<p>,<br/>
        "view_type": "0",<br/>
        "nfftSelection": 1,<br/>
        "displayTimeAxisDuration": 10,<br/>
        "frequencyRange": </p>
{"min": 5, "max": &lt;nyquist&gt;}
<p>,<br/>
        "start_time": &lt;start_epoch&gt;,<br/>
        "end_time": &lt;end_epoch&gt;<br/>
      }<br/>
      """<br/>
    When I POST it to "/configure"<br/>
    Then the response status code should be 200<br/>
    And the field "stream_port" should be an integer<br/>
    And the field "frequencies_list" should be an array (it may be empty)<br/>
    And the field "view_type" should be serialized consistently (no Python enum repr)<br/>
    And the response JSON should match the OpenAPI schema types</p>

<p>  Examples:</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> start_epoch                  </td>
<td class='confluenceTd'> end_epoch                  </td>
</tr>
<tr>
<td class='confluenceTd'> &lt;known_start_epoch&gt; </td>
<td class='confluenceTd'> &lt;known_end_epoch&gt; </td>
</tr>
</tbody></table>
</div>

            <br/>
        </td>
    </tr>
    </table>

<hr class='fullcontent'><br /><br style='page-break-before:always;'/><br />Generated at Tue Oct 28 10:22:05 UTC 2025 by Roy Avrahami using Jira 1001.0.0-SNAPSHOT#100290-rev:4265418e27b0f010a4fc1a24ba0a03702ab5d190.

</body>
</html>