# ניתוח פיננסי מעמיק - הוראות הרצה

## מה הסקריפט עושה

הסקריפט `scripts/analyze_credit_card_expenses.py` מבצע ניתוח מעמיק של כל קבצי כרטיסי האשראי ומזהה:

### 1. 🚨 אנומליות
- הוצאות חריגות (גבוהות מהממוצע)
- הוצאות בלתי רגילות שדורשות תשומת לב

### 2. ⚠️ הוצאות שניתן לוותר עליהן
- בילויים (מסעדות, קולנוע, וכו')
- ביגוד ואופנה
- מנויים (נטפליקס, ספוטיפיי, וכו')
- קפה ושתייה בחוץ

### 3. 🔄 חיובים כפולים/חוזרים
- מנויים חוזרים
- חיובים כפולים מאותו ספק
- הוצאות קבועות שניתן לבטל

### 4. 💳 ניתוח כרטיסי אשראי
- מספר כרטיסים פעילים
- הוצאות לפי כרטיס
- המלצות לניהול כרטיסים

### 5. 📊 ניתוחים נוספים
- פילוח הוצאות לפי קטגוריות
- מגמות חודשיות
- הוצאות חוזרות משמעותיות
- 20 ההוצאות הגדולות ביותר

---

## איך להריץ

### אפשרות 1: PowerShell Script (מומלץ)
```powershell
.\run_analysis.ps1
```

### אפשרות 2: Python ישירות
```bash
python scripts\analyze_credit_card_expenses.py --data-dir "כרטיסי אשראי רועי" --income 37000 --mortgage 10000 --debt -83000 --output comprehensive_financial_analysis.txt
```

### אפשרות 3: Batch File
```bash
run_financial_analysis.bat
```

---

## דרישות

### חבילות Python נדרשות:
```bash
pip install pandas openpyxl xlrd
```

אם אין לך Python מותקן:
1. הורד מ: https://www.python.org/downloads/
2. התקן עם "Add Python to PATH" מסומן
3. הרץ: `pip install pandas openpyxl xlrd`

---

## פלט

הסקריפט יוצר קובץ `comprehensive_financial_analysis.txt` עם:

1. **מצב נוכחי** - ניתוח מלא של ההוצאות וההכנסות
2. **מגמות חודשיות** - מגמות ההוצאות לאורך זמן
3. **פילוח לפי קטגוריות** - איפה הכסף הולך
4. **אנומליות** - הוצאות חריגות שדורשות תשומת לב
5. **הוצאות מיותרות** - מה ניתן לחתוך
6. **חיובים חוזרים** - מנויים וחיובים קבועים
7. **ניתוח כרטיסי אשראי** - המלצות לניהול כרטיסים
8. **תוכנית פעולה** - המלצות ספציפיות וצעדים מעשיים

---

## פתרון בעיות

### Python לא נמצא
- ודא ש-Python מותקן: `python --version`
- אם לא מותקן, התקן מ: https://www.python.org/downloads/

### שגיאת חבילות חסרות
```bash
pip install pandas openpyxl xlrd
```

### שגיאת קריאת קבצים
- ודא שהתיקייה "כרטיסי אשראי רועי" קיימת
- ודא שיש קבצי Excel בתיקייה

### שגיאת encoding
- הסקריפט מטפל ב-UTF-8 אוטומטית
- אם יש בעיות, ודא שהקבצים תקינים

---

## דוגמה לפלט

```
================================================================================
תוכנית פעולה פיננסית - אנליזה מעמיקה
================================================================================

📊 מצב נוכחי - ניתוח מלא:
  • חוב בבנק: -83,000 ₪
  • הכנסה חודשית נטו (משכורות): 37,000 ₪
  • משכנתא חודשית: 10,000 ₪
  • הוצאות ממוצעות חודשיות (מכרטיסי אשראי): 30,833 ₪
  • סה"כ הוצאות חודשיות: 40,833 ₪
  • עודף/גירעון חודשי: -3,833 ₪

🚨 אנומליות - הוצאות חריגות (גבוהות מהממוצע):
  1. 5,000 ₪ - רכישה גדולה...
  2. 3,500 ₪ - הוצאה חריגה...

⚠️ הוצאות שניתן לוותר עליהן (בילויים, ביגוד, מנויים):
  סה"כ: 45,000 ₪ | ממוצע חודשי: 7,500 ₪
  הוצאות הגדולות ביותר:
    1. 1,200 ₪ - מסעדה יוקרתית...
    2. 800 ₪ - ביגוד...

💡 המלצות ספציפיות:
🎯 הפחתת הוצאות מיותרות:
  • ניתן לחסוך 7,500 ₪/חודש על ידי הפחתת בילויים וביגוד
  • המלצה: צמצם בילויים ב-50% - זה יחסוך לך לפחות 3,750 ₪/חודש
```

---

## צעדים הבאים

לאחר הרצת הסקריפט:

1. **קרא את הדוח** - `comprehensive_financial_analysis.txt`
2. **זהה הוצאות מיותרות** - סקור את הרשימה
3. **צור תקציב** - בהתבסס על הממצאים
4. **התחל לחסוך** - בצע את ההמלצות

---

**בהצלחה! 💪**

