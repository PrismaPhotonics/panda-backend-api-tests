apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: sentinel-role
  namespace: sentinel
  labels:
    app: automation-run-sentinel
rules:
  # Read-only access to pods, jobs, and events in watched namespaces
  - apiGroups: [""]
    resources: ["pods", "pods/log", "events"]
    verbs: ["get", "list", "watch"]
  
  - apiGroups: ["batch"]
    resources: ["jobs"]
    verbs: ["get", "list", "watch"]
  
  - apiGroups: ["apps"]
    resources: ["deployments", "replicasets"]
    verbs: ["get", "list", "watch"]
  
  # Allow reading ConfigMaps and Secrets in sentinel namespace
  - apiGroups: [""]
    resources: ["configmaps", "secrets"]
    verbs: ["get", "list"]
    resourceNames: ["sentinel-config", "sentinel-secrets"]

---
# ClusterRole for cross-namespace access
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: sentinel-cluster-role
  labels:
    app: automation-run-sentinel
rules:
  # Read-only access to pods, jobs, and events in all namespaces
  - apiGroups: [""]
    resources: ["pods", "pods/log", "events"]
    verbs: ["get", "list", "watch"]
  
  - apiGroups: ["batch"]
    resources: ["jobs"]
    verbs: ["get", "list", "watch"]
  
  - apiGroups: ["apps"]
    resources: ["deployments", "replicasets"]
    verbs: ["get", "list", "watch"]

